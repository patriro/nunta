/*
 * GoJS v2.0.4 JavaScript Library for HTML Diagrams
 * Northwoods Software, https://www.nwoods.com/
 * GoJS and Northwoods Software are registered trademarks of Northwoods Software Corporation.
 * Copyright (C) 1998-2019 by Northwoods Software Corporation.  All Rights Reserved.
 * THIS SOFTWARE IS LICENSED.  THE LICENSE AGREEMENT IS AT: https://gojs.net/2.0.4/license.html.
 */
(function() { var t;function ba(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}function ca(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):{next:ba(a)}}function da(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}var fa="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b},ha;
if("function"==typeof Object.setPrototypeOf)ha=Object.setPrototypeOf;else{var ia;a:{var ja={a:!0},ka={};try{ka.__proto__=ja;ia=ka.a;break a}catch(a){}ia=!1}ha=ia?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var la=ha;
function ma(a,b){a.prototype=fa(b.prototype);a.prototype.constructor=a;if(la)la(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.uA=b.prototype}var na="undefined"!=typeof window&&window===self?self:"undefined"!=typeof global&&null!=global?global:self,oa="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
function pa(a){if(a){for(var b=na,c=["Array","prototype","fill"],d=0;d<c.length-1;d++){var e=c[d];e in b||(b[e]={});b=b[e]}c=c[c.length-1];d=b[c];a=a(d);a!=d&&null!=a&&oa(b,c,{configurable:!0,writable:!0,value:a})}}pa(function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}});var qa="object"===typeof self&&self.self===self&&self||"object"===typeof global&&global.global===global&&global||"object"===typeof window&&window.window===window&&window||{};void 0===qa.requestAnimationFrame&&(qa.requestAnimationFrame=qa.setImmediate);function ra(){}function sa(a,b){var c=-1;return function(){var d=this,e=arguments;-1!==c&&qa.clearTimeout(c);c=wa(function(){c=-1;a.apply(d,e)},b)}}function wa(a,b){return qa.setTimeout(a,b)}function xa(a){return qa.document.createElement(a)}
function v(a){throw Error(a);}function ya(a,b){a="The object is frozen, so its properties cannot be set: "+a.toString();void 0!==b&&(a+="  to value: "+b);v(a)}function w(a,b,c,d){a instanceof b||(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,b,c))}function z(a,b,c,d){typeof a!==b&&(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,b,c))}function B(a,b,c){"number"===typeof a&&isFinite(a)||(b=Aa(b),void 0!==c&&(b+="."+c),v(b+" must be a real number type, and not NaN or Infinity: "+a))}
function Ba(a,b,c,d){b=Aa(b);c=Aa(c);void 0!==d&&(c+="."+d);"string"===typeof a?v(c+" value is not an instance of "+b+': "'+a+'"'):v(c+" value is not an instance of "+b+": "+a)}function Ca(a,b,c,d){c=Aa(c);void 0!==d&&(c+="."+d);v(c+" is not in the range "+b+": "+a)}function Da(a){v(("string"===typeof a.className?a.className:"")+" constructor cannot take any arguments.")}
function Ea(a){v("Collection was modified during iteration: "+a.toString()+"\n  Perhaps you should iterate over a copy of the collection,\n  or you could collect items to be removed from the collection after the iteration.")}function Fa(a,b){v("No property to set for this enum value: "+b+" on "+a.toString())}function Ga(a){qa.console&&qa.console.log(a)}
function Ha(){qa.console&&qa.console.log("Warning: List/Map/Set constructors no longer take an argument that enforces type.Instead they take an optional collection of Values to add to the collection. See 2.0 changelog for details.")}function Ia(a){return"object"===typeof a&&null!==a}function Ja(a){return Array.isArray(a)||qa.NodeList&&a instanceof qa.NodeList||qa.HTMLCollection&&a instanceof qa.HTMLCollection}function La(a,b,c){Ja(a)||Ba(a,"Array or NodeList or HTMLCollection",b,c)}
function Ma(a){return Array.prototype.slice.call(a)}function Na(a,b,c){Array.isArray(a)?b>=a.length?a.push(c):a.splice(b,0,c):v("Cannot insert an object into an HTMLCollection or NodeList: "+c+" at "+b)}function Oa(a,b){Array.isArray(a)?b>=a.length?a.pop():a.splice(b,1):v("Cannot remove an object from an HTMLCollection or NodeList at "+b)}function Qa(){var a=Ra.pop();return void 0===a?[]:a}function Ta(a){a.length=0;Ra.push(a)}
function Aa(a){return null===a?"*":"string"===typeof a?a:"function"===typeof a&&"string"===typeof a.className?a.className:""}function Va(a){if("function"===typeof a){if(a.className)return a.className;if(a.name)return a.name;var b=a.toString();b=b.substring(9,b.indexOf("(")).trim();if(""!==b)return a._className=b}else if(Ia(a)&&a.constructor)return Va(a.constructor);return typeof a}
function Wa(a){var b=a;Ia(a)&&(a.text?b=a.text:a.name?b=a.name:void 0!==a.key?b=a.key:void 0!==a.id?b=a.id:a.constructor===Object&&(a.Text?b=a.Text:a.Name?b=a.Name:void 0!==a.Key?b=a.Key:void 0!==a.Id?b=a.Id:void 0!==a.ID&&(b=a.ID)));return void 0===b?"undefined":null===b?"null":b.toString()}function Ya(a,b){if(a.hasOwnProperty(b))return!0;for(a=Object.getPrototypeOf(a);a&&a!==Function;){if(a.hasOwnProperty(b))return!0;var c=a.iA;if(c&&c[b])return!0;a=Object.getPrototypeOf(a)}return!1}
function Za(a,b,c){Object.defineProperty($a.prototype,a,{get:b,set:c})}function ab(){var a=bb;if(0===a.length)for(var b=qa.document.getElementsByTagName("canvas"),c=b.length,d=0;d<c;d++){var e=b[d];e.parentElement&&e.parentElement.G&&a.push(e.parentElement.G)}return a}
function eb(a){for(var b=[],c=0;256>c;c++)b["0123456789abcdef".charAt(c>>4)+"0123456789abcdef".charAt(c&15)]=String.fromCharCode(c);a.length%2&&(a="0"+a);c=[];for(var d=0,e=0;e<a.length;e+=2)c[d++]=b[a.substr(e,2)];a=c.join("");a=""===a?"0":a;b=[];for(c=0;256>c;c++)b[c]=c;for(c=d=0;256>c;c++)d=(d+b[c]+119)%256,e=b[c],b[c]=b[d],b[d]=e;d=c=0;for(var f="",g=0;g<a.length;g++)c=(c+1)%256,d=(d+b[c])%256,e=b[c],b[c]=b[d],b[d]=e,f+=String.fromCharCode(a.charCodeAt(g)^b[(b[c]+b[d])%256]);return f}
var fb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("MSIE 9.0"),gb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("MSIE 10.0"),ib=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("Trident/7"),jb=void 0!==qa.navigator&&0<qa.navigator.userAgent.indexOf("Edge/"),kb=void 0!==qa.navigator&&void 0!==qa.navigator.platform&&0<=qa.navigator.platform.toUpperCase().indexOf("MAC"),lb=void 0!==qa.navigator&&void 0!==qa.navigator.platform&&null!==qa.navigator.platform.match(/(iPhone|iPod|iPad)/i),
Ra=[];Object.freeze([]);var bb=[];ra.className="Util";ra.Dx="32ab5ff3b26f42dc0ed90f224c2913b5";ra.adym="gojs.net";ra.vfo="28e646fdb7";ra.className="Util";function D(a,b,c){qb(this);this.l=a;this.Wa=b;this.w=c}D.prototype.toString=function(){return"EnumValue."+this.Wa};function sb(a,b){return void 0===b||null===b||""===b?null:a[b]}function tb(a,b,c,d){a.classType!==b&&(c=Aa(c),void 0!==d&&(c+="."+d),Ba(a,"function"==="a constant of class "+typeof b.className?b.className:"",c))}
na.Object.defineProperties(D.prototype,{classType:{configurable:!0,get:function(){return this.l}},name:{configurable:!0,get:function(){return this.Wa}},value:{configurable:!0,get:function(){return this.w}}});D.className="EnumValue";function ub(){this.rw=[]}ub.prototype.toString=function(){return this.rw.join("")};ub.prototype.add=function(a){""!==a&&this.rw.push(a)};ub.className="StringBuilder";function xb(){}xb.className="PropertyCollection";
var E={Di:!1,Yu:!1,Ny:!1,lA:!1,pA:!1,tx:!1,animationExperiments:!1,kA:null,trace:function(a){qa.console&&qa.console.log(a)},ty:function(a){var b={},c;for(c in a){b.x=c;if("licenseKey"!==b.x){var d=a[b.x];if(void 0!==d.prototype){b.qm=Object.getOwnPropertyNames(d.prototype);for(var e={dk:0};e.dk<b.qm.length;e={dk:e.dk},e.dk++){var f=Object.getOwnPropertyDescriptor(d.prototype,b.qm[e.dk]);void 0!==f.get&&void 0===f.set&&Object.defineProperty(d.prototype,b.qm[e.dk],{set:function(a,b){return function(){throw Error("Property "+
a.qm[b.dk]+" of "+a.x+" is read-only.");}}(b,e)})}}}b={qm:b.qm,x:b.x}}}};function Bb(){}Bb.prototype.reset=function(){};Bb.prototype.next=function(){return!1};Bb.prototype.fd=function(){return!1};Bb.prototype.first=function(){return null};Bb.prototype.any=function(){return!1};Bb.prototype.all=function(){return!0};Bb.prototype.each=function(){return this};Bb.prototype.map=function(){return this};Bb.prototype.filter=function(){return this};Bb.prototype.zd=function(){};Bb.prototype.toString=function(){return"EmptyIterator"};
na.Object.defineProperties(Bb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return 0}}});Bb.prototype.first=Bb.prototype.first;Bb.prototype.hasNext=Bb.prototype.fd;Bb.prototype.next=Bb.prototype.next;Bb.prototype.reset=Bb.prototype.reset;var Cb=null;Bb.className="EmptyIterator";Cb=new Bb;function Db(a){this.key=-1;this.value=a}Db.prototype.reset=function(){this.key=-1};
Db.prototype.next=function(){return-1===this.key?(this.key=0,!0):!1};Db.prototype.fd=function(){return this.next()};Db.prototype.first=function(){this.key=0;return this.value};Db.prototype.any=function(a){this.key=-1;return a(this.value)};Db.prototype.all=function(a){this.key=-1;return a(this.value)};Db.prototype.each=function(a){this.key=-1;a(this.value);return this};Db.prototype.map=function(a){return new Db(a(this.value))};
Db.prototype.filter=function(a){return a(this.value)?new Db(this.value):Cb};Db.prototype.zd=function(){this.value=null};Db.prototype.toString=function(){return"SingletonIterator("+this.value+")"};na.Object.defineProperties(Db.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return 1}}});Db.prototype.first=Db.prototype.first;Db.prototype.hasNext=Db.prototype.fd;Db.prototype.next=Db.prototype.next;
Db.prototype.reset=Db.prototype.reset;Db.className="SingletonIterator";function Gb(a){this.qb=a;this.Ze=null;a.Ka=null;this.na=a.s;this.Ua=-1}Gb.prototype.reset=function(){var a=this.qb;a.Ka=null;this.na=a.s;this.Ua=-1};Gb.prototype.next=function(){var a=this.qb;if(a.s!==this.na){if(0>this.key)return!1;Ea(a)}a=a.j;var b=a.length,c=++this.Ua,d=this.Ze;if(null!==d)for(;c<b;){var e=a[c];if(d(e))return this.key=this.Ua=c,this.value=e,!0;c++}else{if(c<b)return this.key=c,this.value=a[c],!0;this.zd()}return!1};
Gb.prototype.fd=function(){return this.next()};Gb.prototype.first=function(){var a=this.qb;this.na=a.s;this.Ua=0;a=a.j;var b=a.length,c=this.Ze;if(null!==c){for(var d=0;d<b;){var e=a[d];if(c(e))return this.key=this.Ua=d,this.value=e;d++}return null}return 0<b?(a=a[0],this.key=0,this.value=a):null};Gb.prototype.any=function(a){var b=this.qb;b.Ka=null;var c=b.s;this.Ua=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h)){if(a(h))return!0;b.s!==c&&Ea(b)}}return!1};
Gb.prototype.all=function(a){var b=this.qb;b.Ka=null;var c=b.s;this.Ua=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h)){if(!a(h))return!1;b.s!==c&&Ea(b)}}return!0};Gb.prototype.each=function(a){var b=this.qb;b.Ka=null;var c=b.s;this.Ua=-1;for(var d=b.j,e=d.length,f=this.Ze,g=0;g<e;g++){var h=d[g];if(null===f||f(h))a(h),b.s!==c&&Ea(b)}return this};
Gb.prototype.map=function(a){var b=this.qb;b.Ka=null;var c=b.s;this.Ua=-1;for(var d=[],e=b.j,f=e.length,g=this.Ze,h=0;h<f;h++){var k=e[h];if(null===g||g(k))d.push(a(k)),b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};Gb.prototype.filter=function(a){var b=this.qb;b.Ka=null;var c=b.s;this.Ua=-1;for(var d=[],e=b.j,f=e.length,g=this.Ze,h=0;h<f;h++){var k=e[h];if(null===g||g(k))a(k)&&d.push(k),b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};
Gb.prototype.zd=function(){this.key=-1;this.value=null;this.na=-1;this.Ze=null;this.qb.Ka=this};Gb.prototype.toString=function(){return"ListIterator@"+this.Ua+"/"+this.qb.count};
na.Object.defineProperties(Gb.prototype,{iterator:{configurable:!0,get:function(){return this}},predicate:{configurable:!0,get:function(){return this.Ze},set:function(a){this.Ze=a}},count:{configurable:!0,get:function(){var a=this.Ze;if(null!==a){for(var b=0,c=this.qb.j,d=c.length,e=0;e<d;e++)a(c[e])&&b++;return b}return this.qb.j.length}}});Gb.prototype.first=Gb.prototype.first;Gb.prototype.hasNext=Gb.prototype.fd;Gb.prototype.next=Gb.prototype.next;
Gb.prototype.reset=Gb.prototype.reset;Gb.className="ListIterator";function Hb(a){this.qb=a;a.Tg=null;this.na=a.s;this.Ua=a.j.length}Hb.prototype.reset=function(){var a=this.qb;a.Tg=null;this.na=a.s;this.Ua=a.j.length};Hb.prototype.next=function(){var a=this.qb;if(a.s!==this.na){if(0>this.key)return!1;Ea(a)}var b=--this.Ua;if(0<=b)return this.key=b,this.value=a.j[b],!0;this.zd();return!1};Hb.prototype.fd=function(){return this.next()};
Hb.prototype.first=function(){var a=this.qb;this.na=a.s;var b=a.j;this.Ua=a=b.length-1;return 0<=a?(b=b[a],this.key=a,this.value=b):null};Hb.prototype.any=function(a){var b=this.qb;b.Tg=null;var c=b.s,d=b.j,e=d.length;this.Ua=e;for(--e;0<=e;e--){if(a(d[e]))return!0;b.s!==c&&Ea(b)}return!1};Hb.prototype.all=function(a){var b=this.qb;b.Tg=null;var c=b.s,d=b.j,e=d.length;this.Ua=e;for(--e;0<=e;e--){if(!a(d[e]))return!1;b.s!==c&&Ea(b)}return!0};
Hb.prototype.each=function(a){var b=this.qb;b.Tg=null;var c=b.s,d=b.j,e=d.length;this.Ua=e;for(--e;0<=e;e--)a(d[e]),b.s!==c&&Ea(b);return this};Hb.prototype.map=function(a){var b=this.qb;b.Tg=null;var c=b.s,d=[],e=b.j,f=e.length;this.Ua=f;for(--f;0<=f;f--)d.push(a(e[f])),b.s!==c&&Ea(b);a=new G;a.j=d;a.lb();return a.iterator};
Hb.prototype.filter=function(a){var b=this.qb;b.Tg=null;var c=b.s,d=[],e=b.j,f=e.length;this.Ua=f;for(--f;0<=f;f--){var g=e[f];a(g)&&d.push(g);b.s!==c&&Ea(b)}a=new G;a.j=d;a.lb();return a.iterator};Hb.prototype.zd=function(){this.key=-1;this.value=null;this.na=-1;this.qb.Tg=this};Hb.prototype.toString=function(){return"ListIteratorBackwards("+this.Ua+"/"+this.qb.count+")"};
na.Object.defineProperties(Hb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.qb.j.length}}});Hb.prototype.first=Hb.prototype.first;Hb.prototype.hasNext=Hb.prototype.fd;Hb.prototype.next=Hb.prototype.next;Hb.prototype.reset=Hb.prototype.reset;Hb.className="ListIteratorBackwards";
function G(a){qb(this);this.u=!1;this.j=[];this.s=0;this.Tg=this.Ka=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=G.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"List()#"+Jb(this)};t.add=function(a){if(null===a)return this;this.u&&ya(this,a);this.j.push(a);this.lb();return this};t.push=function(a){this.add(a)};
t.addAll=function(a){if(null===a)return this;this.u&&ya(this);var b=this.j;if(Ja(a))for(var c=a.length,d=0;d<c;d++)b.push(a[d]);else for(a=a.iterator;a.next();)b.push(a.value);this.lb();return this};t.clear=function(){this.u&&ya(this);this.j.length=0;this.lb()};t.contains=function(a){return null===a?!1:-1!==this.j.indexOf(a)};t.has=function(a){return this.contains(a)};t.indexOf=function(a){return null===a?-1:this.j.indexOf(a)};
t.O=function(a){E&&B(a,G,"elt:i");var b=this.j;(0>a||a>=b.length)&&Ca(a,"0 <= i < length",G,"elt:i");return b[a]};t.get=function(a){return this.O(a)};t.jd=function(a,b){E&&B(a,G,"setElt:i");var c=this.j;(0>a||a>=c.length)&&Ca(a,"0 <= i < length",G,"setElt:i");this.u&&ya(this,a);c[a]=b};t.set=function(a,b){this.jd(a,b)};t.first=function(){var a=this.j;return 0===a.length?null:a[0]};t.Ub=function(){var a=this.j,b=a.length;return 0<b?a[b-1]:null};
t.pop=function(){this.u&&ya(this);var a=this.j;return 0<a.length?a.pop():null};G.prototype.any=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++){if(a(b[e]))return!0;this.s!==c&&Ea(this)}return!1};G.prototype.all=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++){if(!a(b[e]))return!1;this.s!==c&&Ea(this)}return!0};G.prototype.each=function(a){for(var b=this.j,c=this.s,d=b.length,e=0;e<d;e++)a(b[e]),this.s!==c&&Ea(this);return this};
G.prototype.map=function(a){for(var b=new G,c=[],d=this.j,e=this.s,f=d.length,g=0;g<f;g++)c.push(a(d[g])),this.s!==e&&Ea(this);b.j=c;b.lb();return b};G.prototype.filter=function(a){for(var b=new G,c=[],d=this.j,e=this.s,f=d.length,g=0;g<f;g++){var h=d[g];a(h)&&c.push(h);this.s!==e&&Ea(this)}b.j=c;b.lb();return b};t=G.prototype;t.Lb=function(a,b){E&&B(a,G,"insertAt:i");0>a&&Ca(a,">= 0",G,"insertAt:i");this.u&&ya(this,a);var c=this.j;a>=c.length?c.push(b):c.splice(a,0,b);this.lb()};
t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=this.j;a=b.indexOf(a);if(-1===a)return!1;a===b.length-1?b.pop():b.splice(a,1);this.lb();return!0};t.delete=function(a){return this.remove(a)};t.nb=function(a){E&&B(a,G,"removeAt:i");var b=this.j;(0>a||a>=b.length)&&Ca(a,"0 <= i < length",G,"removeAt:i");this.u&&ya(this,a);a===b.length-1?b.pop():b.splice(a,1);this.lb()};
t.removeRange=function(a,b){E&&(B(a,G,"removeRange:from"),B(b,G,"removeRange:to"));var c=this.j,d=c.length;if(0>a)a=0;else if(a>=d)return this;if(0>b)return this;b>=d&&(b=d-1);if(a>b)return this;this.u&&ya(this);for(var e=a,f=b+1;f<d;)c[e++]=c[f++];c.length=d-(b-a+1);this.lb();return this};G.prototype.copy=function(){var a=new G,b=this.j;0<b.length&&(a.j=Array.prototype.slice.call(b));return a};t=G.prototype;t.Oa=function(){for(var a=this.j,b=this.count,c=Array(b),d=0;d<b;d++)c[d]=a[d];return c};
t.Uv=function(){for(var a=new I,b=this.j,c=this.count,d=0;d<c;d++)a.add(b[d]);return a};t.sort=function(a){E&&z(a,"function",G,"sort:sortfunc");this.u&&ya(this);this.j.sort(a);this.lb();return this};
t.Xi=function(a,b,c){var d=this.j,e=d.length;void 0===b&&(b=0);void 0===c&&(c=e);E&&(z(a,"function",G,"sortRange:sortfunc"),B(b,G,"sortRange:from"),B(c,G,"sortRange:to"));this.u&&ya(this);var f=c-b;if(1>=f)return this;(0>b||b>=e-1)&&Ca(b,"0 <= from < length",G,"sortRange:from");if(2===f)return c=d[b],e=d[b+1],0<a(c,e)&&(d[b]=e,d[b+1]=c,this.lb()),this;if(0===b)if(c>=e)d.sort(a);else for(b=d.slice(0,c),b.sort(a),a=0;a<c;a++)d[a]=b[a];else if(c>=e)for(c=d.slice(b),c.sort(a),a=b;a<e;a++)d[a]=c[a-b];
else for(e=d.slice(b,c),e.sort(a),a=b;a<c;a++)d[a]=e[a-b];this.lb();return this};t.reverse=function(){this.u&&ya(this);this.j.reverse();this.lb();return this};
na.Object.defineProperties(G.prototype,{_dataArray:{configurable:!0,get:function(){return this.j}},count:{configurable:!0,get:function(){return this.j.length}},size:{configurable:!0,get:function(){return this.j.length}},length:{configurable:!0,get:function(){return this.j.length}},iterator:{configurable:!0,get:function(){if(0>=this.j.length)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Gb(this)}},iteratorBackwards:{configurable:!0,
enumerable:!0,get:function(){if(0>=this.j.length)return Cb;var a=this.Tg;return null!==a?(a.reset(),a):new Hb(this)}}});G.prototype.reverse=G.prototype.reverse;G.prototype.sortRange=G.prototype.Xi;G.prototype.sort=G.prototype.sort;G.prototype.toSet=G.prototype.Uv;G.prototype.toArray=G.prototype.Oa;G.prototype.removeRange=G.prototype.removeRange;G.prototype.removeAt=G.prototype.nb;G.prototype["delete"]=G.prototype.delete;G.prototype.remove=G.prototype.remove;G.prototype.insertAt=G.prototype.Lb;
G.prototype.pop=G.prototype.pop;G.prototype.last=G.prototype.Ub;G.prototype.first=G.prototype.first;G.prototype.set=G.prototype.set;G.prototype.setElt=G.prototype.jd;G.prototype.get=G.prototype.get;G.prototype.elt=G.prototype.O;G.prototype.indexOf=G.prototype.indexOf;G.prototype.has=G.prototype.has;G.prototype.contains=G.prototype.contains;G.prototype.clear=G.prototype.clear;G.prototype.addAll=G.prototype.addAll;G.prototype.push=G.prototype.push;G.prototype.add=G.prototype.add;G.prototype.thaw=G.prototype.ja;
G.prototype.freeze=G.prototype.freeze;G.className="List";function Kb(a){this.hg=a;a.Ka=null;this.na=a.s;this.pa=null}Kb.prototype.reset=function(){var a=this.hg;a.Ka=null;this.na=a.s;this.pa=null};Kb.prototype.next=function(){var a=this.hg;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=b.value,this.key=b.key,!0;this.zd();return!1};Kb.prototype.fd=function(){return this.next()};
Kb.prototype.first=function(){var a=this.hg;this.na=a.s;a=a.ga;if(null!==a){this.pa=a;var b=a.value;this.key=a.key;return this.value=b}return null};Kb.prototype.any=function(a){var b=this.hg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.value))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Kb.prototype.all=function(a){var b=this.hg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.value))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};
Kb.prototype.each=function(a){var b=this.hg;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.value),b.s!==c&&Ea(b),d=d.qa;return this};Kb.prototype.map=function(a){var b=this.hg;b.Ka=null;for(var c=new G,d=b.s,e=b.ga;null!==e;)c.add(a(e.value)),b.s!==d&&Ea(b),e=e.qa;return c.iterator};Kb.prototype.filter=function(a){var b=this.hg;b.Ka=null;for(var c=new G,d=b.s,e=b.ga;null!==e;){var f=e.value;a(f)&&c.add(f);b.s!==d&&Ea(b);e=e.qa}return c.iterator};
Kb.prototype.zd=function(){this.value=this.key=null;this.na=-1;this.hg.Ka=this};Kb.prototype.toString=function(){return null!==this.pa?"SetIterator@"+this.pa.value:"SetIterator"};na.Object.defineProperties(Kb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.hg.Fb}}});Kb.prototype.first=Kb.prototype.first;Kb.prototype.hasNext=Kb.prototype.fd;Kb.prototype.next=Kb.prototype.next;Kb.prototype.reset=Kb.prototype.reset;
Kb.className="SetIterator";function I(a){qb(this);this.u=!1;this.Gb={};this.Fb=0;this.Ka=null;this.s=0;this.Te=this.ga=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=I.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"Set()#"+Jb(this)};
t.add=function(a){if(null===a)return this;this.u&&ya(this,a);var b=a;Ia(a)&&(b=Nb(a));void 0===this.Gb[b]&&(this.Fb++,a=new Ob(a,a),this.Gb[b]=a,b=this.Te,null===b?this.ga=a:(a.zl=b,b.qa=a),this.Te=a,this.lb());return this};t.addAll=function(a){if(null===a)return this;this.u&&ya(this);if(Ja(a))for(var b=a.length,c=0;c<b;c++)this.add(a[c]);else for(a=a.iterator;a.next();)this.add(a.value);return this};
t.contains=function(a){if(null===a)return!1;var b=a;return Ia(a)&&(b=Jb(a),void 0===b)?!1:void 0!==this.Gb[b]};t.has=function(a){return this.contains(a)};t.zy=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(!this.contains(a.value))return!1;return!0};t.Ay=function(a){if(null===a)return!0;for(a=a.iterator;a.next();)if(this.contains(a.value))return!0;return!1};t.first=function(){var a=this.ga;return null===a?null:a.value};
I.prototype.any=function(a){for(var b=this.s,c=this.ga;null!==c;){if(a(c.value))return!0;this.s!==b&&Ea(this);c=c.qa}return!1};I.prototype.all=function(a){for(var b=this.s,c=this.ga;null!==c;){if(!a(c.value))return!1;this.s!==b&&Ea(this);c=c.qa}return!0};I.prototype.each=function(a){for(var b=this.s,c=this.ga;null!==c;)a(c.value),this.s!==b&&Ea(this),c=c.qa;return this};I.prototype.map=function(a){for(var b=new I,c=this.s,d=this.ga;null!==d;)b.add(a(d.value)),this.s!==c&&Ea(this),d=d.qa;return b};
I.prototype.filter=function(a){for(var b=new I,c=this.s,d=this.ga;null!==d;){var e=d.value;a(e)&&b.add(e);this.s!==c&&Ea(this);d=d.qa}return b};t=I.prototype;t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return!1;a=this.Gb[b];if(void 0===a)return!1;var c=a.qa,d=a.zl;null!==c&&(c.zl=d);null!==d&&(d.qa=c);this.ga===a&&(this.ga=c);this.Te===a&&(this.Te=d);delete this.Gb[b];this.Fb--;this.lb();return!0};t.delete=function(a){return this.remove(a)};
t.qq=function(a){if(null===a)return this;this.u&&ya(this);if(Ja(a))for(var b=a.length,c=0;c<b;c++)this.remove(a[c]);else for(a=a.iterator;a.next();)this.remove(a.value);return this};t.Wz=function(a){if(null===a||0===this.count)return this;this.u&&ya(this);var b=new I;b.addAll(a);a=[];for(var c=this.iterator;c.next();){var d=c.value;b.contains(d)||a.push(d)}this.qq(a);return this};t.clear=function(){this.u&&ya(this);this.Gb={};this.Fb=0;null!==this.Ka&&this.Ka.reset();this.Te=this.ga=null;this.lb()};
I.prototype.copy=function(){var a=new I,b=this.Gb,c;for(c in b)a.add(b[c].value);return a};I.prototype.Oa=function(){var a=Array(this.Fb),b=this.Gb,c=0,d;for(d in b)a[c]=b[d].value,c++;return a};I.prototype.Tv=function(){var a=new G,b=this.Gb,c;for(c in b)a.add(b[c].value);return a};function qb(a){a.__gohashid=Pb++}function Nb(a){var b=a.__gohashid;void 0===b&&(b=Pb++,a.__gohashid=b);return b}function Jb(a){return a.__gohashid}
na.Object.defineProperties(I.prototype,{count:{configurable:!0,get:function(){return this.Fb}},size:{configurable:!0,get:function(){return this.Fb}},iterator:{configurable:!0,get:function(){if(0>=this.Fb)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Kb(this)}}});I.prototype.toList=I.prototype.Tv;I.prototype.toArray=I.prototype.Oa;I.prototype.clear=I.prototype.clear;I.prototype.retainAll=I.prototype.Wz;I.prototype.removeAll=I.prototype.qq;
I.prototype["delete"]=I.prototype.delete;I.prototype.remove=I.prototype.remove;I.prototype.first=I.prototype.first;I.prototype.containsAny=I.prototype.Ay;I.prototype.containsAll=I.prototype.zy;I.prototype.has=I.prototype.has;I.prototype.contains=I.prototype.contains;I.prototype.addAll=I.prototype.addAll;I.prototype.add=I.prototype.add;I.prototype.thaw=I.prototype.ja;I.prototype.freeze=I.prototype.freeze;var Pb=1;I.className="Set";I.uniqueHash=qb;I.hashIdUnique=Nb;I.hashId=Jb;
function Qb(a){this.la=a;this.na=a.s;this.pa=null}Qb.prototype.reset=function(){this.na=this.la.s;this.pa=null};Qb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=this.key=a=b.key,!0;this.zd();return!1};Qb.prototype.fd=function(){return this.next()};Qb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;return null!==a?(this.pa=a,this.value=this.key=a=a.key):null};
Qb.prototype.any=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.key))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Qb.prototype.all=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.key))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Qb.prototype.each=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.key),b.s!==c&&Ea(b),d=d.qa;return this};
Qb.prototype.map=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e.key)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Qb.prototype.filter=function(a){var b=this.la,c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;){var f=e.key;a(f)&&d.add(f);b.s!==c&&Ea(b);e=e.qa}return d.iterator};Qb.prototype.zd=function(){this.value=this.key=null;this.na=-1};Qb.prototype.toString=function(){return null!==this.pa?"MapKeySetIterator@"+this.pa.value:"MapKeySetIterator"};
na.Object.defineProperties(Qb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Fb}}});Qb.prototype.first=Qb.prototype.first;Qb.prototype.hasNext=Qb.prototype.fd;Qb.prototype.next=Qb.prototype.next;Qb.prototype.reset=Qb.prototype.reset;Qb.className="MapKeySetIterator";function Rb(a){I.call(this);qb(this);this.u=!0;this.la=a}ma(Rb,I);t=Rb.prototype;t.freeze=function(){return this};t.ja=function(){return this};
t.toString=function(){return"MapKeySet("+this.la.toString()+")"};t.add=function(){v("This Set is read-only: "+this.toString());return this};t.contains=function(a){return this.la.contains(a)};t.has=function(a){return this.contains(a)};t.remove=function(){v("This Set is read-only: "+this.toString());return!1};t.delete=function(a){return this.remove(a)};t.clear=function(){v("This Set is read-only: "+this.toString())};t.first=function(){var a=this.la.ga;return null!==a?a.key:null};
Rb.prototype.any=function(a){for(var b=this.la.ga;null!==b;){if(a(b.key))return!0;b=b.qa}return!1};Rb.prototype.all=function(a){for(var b=this.la.ga;null!==b;){if(!a(b.key))return!1;b=b.qa}return!0};Rb.prototype.each=function(a){for(var b=this.la.ga;null!==b;)a(b.key),b=b.qa;return this};Rb.prototype.map=function(a){for(var b=new I,c=this.la.ga;null!==c;)b.add(a(c.key)),c=c.qa;return b};Rb.prototype.filter=function(a){for(var b=new I,c=this.la.ga;null!==c;){var d=c.key;a(d)&&b.add(d);c=c.qa}return b};
Rb.prototype.copy=function(){return new Rb(this.la)};Rb.prototype.Uv=function(){var a=new I,b=this.la.Gb,c;for(c in b)a.add(b[c].key);return a};Rb.prototype.Oa=function(){var a=this.la.Gb,b=Array(this.la.Fb),c=0,d;for(d in a)b[c]=a[d].key,c++;return b};Rb.prototype.Tv=function(){var a=new G,b=this.la.Gb,c;for(c in b)a.add(b[c].key);return a};
na.Object.defineProperties(Rb.prototype,{count:{configurable:!0,get:function(){return this.la.Fb}},size:{configurable:!0,get:function(){return this.la.Fb}},iterator:{configurable:!0,get:function(){return 0>=this.la.Fb?Cb:new Qb(this.la)}}});Rb.prototype.toList=Rb.prototype.Tv;Rb.prototype.toArray=Rb.prototype.Oa;Rb.prototype.toSet=Rb.prototype.Uv;Rb.prototype.first=Rb.prototype.first;Rb.prototype.clear=Rb.prototype.clear;Rb.prototype["delete"]=Rb.prototype.delete;
Rb.prototype.remove=Rb.prototype.remove;Rb.prototype.has=Rb.prototype.has;Rb.prototype.contains=Rb.prototype.contains;Rb.prototype.add=Rb.prototype.add;Rb.prototype.thaw=Rb.prototype.ja;Rb.prototype.freeze=Rb.prototype.freeze;Rb.className="MapKeySet";function Sb(a){this.la=a;a.Se=null;this.na=a.s;this.pa=null}Sb.prototype.reset=function(){var a=this.la;a.Se=null;this.na=a.s;this.pa=null};
Sb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.value=b.value,this.key=b.key,!0;this.zd();return!1};Sb.prototype.fd=function(){return this.next()};Sb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;if(null!==a){this.pa=a;var b=a.value;this.key=a.key;return this.value=b}return null};
Sb.prototype.any=function(a){var b=this.la;b.Se=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d.value))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Sb.prototype.all=function(a){var b=this.la;b.Se=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d.value))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Sb.prototype.each=function(a){var b=this.la;b.Se=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d.value),b.s!==c&&Ea(b),d=d.qa;return this};
Sb.prototype.map=function(a){var b=this.la;b.Se=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e.value)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Sb.prototype.filter=function(a){var b=this.la;b.Se=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;){var f=e.value;a(f)&&d.add(f);b.s!==c&&Ea(b);e=e.qa}return d.iterator};Sb.prototype.zd=function(){this.value=this.key=null;this.na=-1;this.la.Se=this};
Sb.prototype.toString=function(){return null!==this.pa?"MapValueSetIterator@"+this.pa.value:"MapValueSetIterator"};na.Object.defineProperties(Sb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Fb}}});Sb.prototype.first=Sb.prototype.first;Sb.prototype.hasNext=Sb.prototype.fd;Sb.prototype.next=Sb.prototype.next;Sb.prototype.reset=Sb.prototype.reset;Sb.className="MapValueSetIterator";
function Ob(a,b){this.key=a;this.value=b;this.zl=this.qa=null}Ob.prototype.toString=function(){return"{"+this.key+":"+this.value+"}"};Ob.className="KeyValuePair";function Tb(a){this.la=a;a.Ka=null;this.na=a.s;this.pa=null}Tb.prototype.reset=function(){var a=this.la;a.Ka=null;this.na=a.s;this.pa=null};
Tb.prototype.next=function(){var a=this.la;if(a.s!==this.na){if(null===this.key)return!1;Ea(a)}var b=this.pa;b=null===b?a.ga:b.qa;if(null!==b)return this.pa=b,this.key=b.key,this.value=b.value,!0;this.zd();return!1};Tb.prototype.fd=function(){return this.next()};Tb.prototype.first=function(){var a=this.la;this.na=a.s;a=a.ga;return null!==a?(this.pa=a,this.key=a.key,this.value=a.value,a):null};
Tb.prototype.any=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(a(d))return!0;b.s!==c&&Ea(b);d=d.qa}return!1};Tb.prototype.all=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;){if(!a(d))return!1;b.s!==c&&Ea(b);d=d.qa}return!0};Tb.prototype.each=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=b.ga;null!==d;)a(d),b.s!==c&&Ea(b),d=d.qa;return this};
Tb.prototype.map=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)d.add(a(e)),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Tb.prototype.filter=function(a){var b=this.la;b.Ka=null;var c=b.s;this.pa=null;for(var d=new G,e=b.ga;null!==e;)a(e)&&d.add(e),b.s!==c&&Ea(b),e=e.qa;return d.iterator};Tb.prototype.zd=function(){this.value=this.key=null;this.na=-1;this.la.Ka=this};Tb.prototype.toString=function(){return null!==this.pa?"MapIterator@"+this.pa:"MapIterator"};
na.Object.defineProperties(Tb.prototype,{iterator:{configurable:!0,get:function(){return this}},count:{configurable:!0,get:function(){return this.la.Fb}}});Tb.prototype.first=Tb.prototype.first;Tb.prototype.hasNext=Tb.prototype.fd;Tb.prototype.next=Tb.prototype.next;Tb.prototype.reset=Tb.prototype.reset;Tb.className="MapIterator";
function Ub(a){qb(this);this.u=!1;this.Gb={};this.Fb=0;this.Se=this.Ka=null;this.s=0;this.Te=this.ga=null;void 0!==a&&("function"===typeof a||"string"===typeof a?Ha():this.addAll(a))}t=Ub.prototype;t.lb=function(){var a=this.s;a++;999999999<a&&(a=0);this.s=a};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.toString=function(){return"Map()#"+Jb(this)};
t.add=function(a,b){this.u&&ya(this,a);var c=a;Ia(a)&&(c=Nb(a));var d=this.Gb[c];void 0===d?(this.Fb++,a=new Ob(a,b),this.Gb[c]=a,c=this.Te,null===c?this.ga=a:(a.zl=c,c.qa=a),this.Te=a,this.lb()):d.value=b;return this};t.set=function(a,b){return this.add(a,b)};t.addAll=function(a){if(null===a)return this;if(Ja(a))for(var b=a.length,c=0;c<b;c++){var d=a[c];this.add(d.key,d.value)}else for(a=a.iterator;a.next();)b=a.value,this.add(b.key,b.value);return this};t.first=function(){return this.ga};
Ub.prototype.any=function(a){for(var b=this.s,c=this.ga;null!==c;){if(a(c))return!0;this.s!==b&&Ea(this);c=c.qa}return!1};Ub.prototype.all=function(a){for(var b=this.s,c=this.ga;null!==c;){if(!a(c))return!1;this.s!==b&&Ea(this);c=c.qa}return!0};Ub.prototype.each=function(a){for(var b=this.s,c=this.ga;null!==c;)a(c),this.s!==b&&Ea(this),c=c.qa;return this};Ub.prototype.map=function(a){for(var b=new Ub,c=this.s,d=this.ga;null!==d;)b.add(d.key,a(d)),this.s!==c&&Ea(this),d=d.qa;return b};
Ub.prototype.filter=function(a){for(var b=new Ub,c=this.s,d=this.ga;null!==d;)a(d)&&b.add(d.key,d.value),this.s!==c&&Ea(this),d=d.qa;return b};t=Ub.prototype;t.contains=function(a){var b=a;return Ia(a)&&(b=Jb(a),void 0===b)?!1:void 0!==this.Gb[b]};t.has=function(a){return this.contains(a)};t.K=function(a){var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return null;a=this.Gb[b];return void 0===a?null:a.value};t.get=function(a){return this.K(a)};
t.remove=function(a){if(null===a)return!1;this.u&&ya(this,a);var b=a;if(Ia(a)&&(b=Jb(a),void 0===b))return!1;a=this.Gb[b];if(void 0===a)return!1;var c=a.qa,d=a.zl;null!==c&&(c.zl=d);null!==d&&(d.qa=c);this.ga===a&&(this.ga=c);this.Te===a&&(this.Te=d);delete this.Gb[b];this.Fb--;this.lb();return!0};t.delete=function(a){return this.remove(a)};t.clear=function(){this.u&&ya(this);this.Gb={};this.Fb=0;null!==this.Ka&&this.Ka.reset();null!==this.Se&&this.Se.reset();this.Te=this.ga=null;this.lb()};
Ub.prototype.copy=function(){var a=new Ub,b=this.Gb,c;for(c in b){var d=b[c];a.add(d.key,d.value)}return a};Ub.prototype.Oa=function(){var a=this.Gb,b=Array(this.Fb),c=0,d;for(d in a){var e=a[d];b[c]=new Ob(e.key,e.value);c++}return b};Ub.prototype.Zd=function(){return new Rb(this)};
na.Object.defineProperties(Ub.prototype,{count:{configurable:!0,get:function(){return this.Fb}},size:{configurable:!0,get:function(){return this.Fb}},iterator:{configurable:!0,get:function(){if(0>=this.count)return Cb;var a=this.Ka;return null!==a?(a.reset(),a):new Tb(this)}},iteratorKeys:{configurable:!0,get:function(){return 0>=this.count?Cb:new Qb(this)}},iteratorValues:{configurable:!0,get:function(){if(0>=this.count)return Cb;
var a=this.Se;return null!==a?(a.reset(),a):new Sb(this)}}});Ub.prototype.toKeySet=Ub.prototype.Zd;Ub.prototype.toArray=Ub.prototype.Oa;Ub.prototype.clear=Ub.prototype.clear;Ub.prototype["delete"]=Ub.prototype.delete;Ub.prototype.remove=Ub.prototype.remove;Ub.prototype.get=Ub.prototype.get;Ub.prototype.getValue=Ub.prototype.K;Ub.prototype.has=Ub.prototype.has;Ub.prototype.contains=Ub.prototype.contains;Ub.prototype.first=Ub.prototype.first;Ub.prototype.addAll=Ub.prototype.addAll;
Ub.prototype.set=Ub.prototype.set;Ub.prototype.add=Ub.prototype.add;Ub.prototype.thaw=Ub.prototype.ja;Ub.prototype.freeze=Ub.prototype.freeze;Ub.className="Map";function J(a,b){void 0===a?this.F=this.D=0:"number"===typeof a&&"number"===typeof b?(this.D=a,this.F=b):v("Invalid arguments to Point constructor: "+a+", "+b);this.u=!1}J.prototype.assign=function(a){this.D=a.D;this.F=a.F;return this};J.prototype.h=function(a,b){this.D=a;this.F=b;return this};
J.prototype.wg=function(a,b){E&&(z(a,"number",J,"setTo:x"),z(b,"number",J,"setTo:y"),this.ha());this.D=a;this.F=b;return this};J.prototype.set=function(a){E&&(w(a,J,J,"set:p"),this.ha());this.D=a.D;this.F=a.F;return this};J.prototype.copy=function(){var a=new J;a.D=this.D;a.F=this.F;return a};t=J.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};
t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Point is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};function Vb(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new J(c,e)}return new J}
function Xb(a){E&&w(a,J);return a.x.toString()+" "+a.y.toString()}t.toString=function(){return"Point("+this.x+","+this.y+")"};t.A=function(a){return a instanceof J?this.D===a.x&&this.F===a.y:!1};t.Fi=function(a,b){return this.D===a&&this.F===b};t.Sa=function(a){return K.B(this.D,a.x)&&K.B(this.F,a.y)};t.add=function(a){E&&(w(a,J,J,"add:p"),this.ha());this.D+=a.x;this.F+=a.y;return this};t.Yd=function(a){E&&(w(a,J,J,"subtract:p"),this.ha());this.D-=a.x;this.F-=a.y;return this};
t.offset=function(a,b){E&&(B(a,J,"offset:dx"),B(b,J,"offset:dy"),this.ha());this.D+=a;this.F+=b;return this};J.prototype.rotate=function(a){E&&(B(a,J,"rotate:angle"),this.ha());if(0===a)return this;var b=this.D,c=this.F;if(0===b&&0===c)return this;360<=a?a-=360:0>a&&(a+=360);if(90===a){a=0;var d=1}else 180===a?(a=-1,d=0):270===a?(a=0,d=-1):(d=a*Math.PI/180,a=Math.cos(d),d=Math.sin(d));this.D=a*b-d*c;this.F=d*b+a*c;return this};t=J.prototype;
t.scale=function(a,b){E&&(B(a,J,"scale:sx"),B(b,J,"scale:sy"),this.ha());this.D*=a;this.F*=b;return this};t.De=function(a){E&&w(a,J,J,"distanceSquaredPoint:p");var b=a.x-this.D;a=a.y-this.F;return b*b+a*a};t.ed=function(a,b){E&&(B(a,J,"distanceSquared:px"),B(b,J,"distanceSquared:py"));a-=this.D;b-=this.F;return a*a+b*b};t.normalize=function(){E&&this.ha();var a=this.D,b=this.F,c=Math.sqrt(a*a+b*b);0<c&&(this.D=a/c,this.F=b/c);return this};
t.Xa=function(a){E&&w(a,J,J,"directionPoint:p");return Yb(a.x-this.D,a.y-this.F)};t.direction=function(a,b){E&&(B(a,J,"direction:px"),B(b,J,"direction:py"));return Yb(a-this.D,b-this.F)};function Yb(a,b){if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;var c=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?c=0>b?c+180:180-c:0>b&&(c=360-c);return c}
t.Qz=function(a,b,c,d){E&&(B(a,J,"projectOntoLineSegment:px"),B(b,J,"projectOntoLineSegment:py"),B(c,J,"projectOntoLineSegment:qx"),B(d,J,"projectOntoLineSegment:qy"));K.Ti(a,b,c,d,this.D,this.F,this);return this};t.Rz=function(a,b){E&&(w(a,J,J,"projectOntoLineSegmentPoint:p"),w(b,J,J,"projectOntoLineSegmentPoint:q"));K.Ti(a.x,a.y,b.x,b.y,this.D,this.F,this);return this};
t.aA=function(a,b,c,d){E&&(B(a,J,"snapToGrid:originx"),B(b,J,"snapToGrid:originy"),B(c,J,"snapToGrid:cellwidth"),B(d,J,"snapToGrid:cellheight"));K.Xp(this.D,this.F,a,b,c,d,this);return this};t.bA=function(a,b){E&&(w(a,J,J,"snapToGridPoint:p"),w(b,Zb,J,"snapToGridPoint:q"));K.Xp(this.D,this.F,a.x,a.y,b.width,b.height,this);return this};t.Vi=function(a,b){E&&(w(a,L,J,"setRectSpot:r"),w(b,M,J,"setRectSpot:spot"),this.ha());this.D=a.x+b.x*a.width+b.offsetX;this.F=a.y+b.y*a.height+b.offsetY;return this};
t.rk=function(a,b,c,d,e){E&&(B(a,J,"setSpot:x"),B(b,J,"setSpot:y"),B(c,J,"setSpot:w"),B(d,J,"setSpot:h"),(0>c||0>d)&&v("Point.setSpot:Width and height cannot be negative"),w(e,M,J,"setSpot:spot"),this.ha());this.D=a+e.x*c+e.offsetX;this.F=b+e.y*d+e.offsetY;return this};t.transform=function(a){E&&w(a,$b,J,"transform:t");a.va(this);return this};function ac(a,b){E&&w(b,$b,J,"transformInverted:t");b.Vd(a);return a}
function cc(a,b,c,d,e,f){E&&(B(a,J,"distanceLineSegmentSquared:px"),B(b,J,"distanceLineSegmentSquared:py"),B(c,J,"distanceLineSegmentSquared:ax"),B(d,J,"distanceLineSegmentSquared:ay"),B(e,J,"distanceLineSegmentSquared:bx"),B(f,J,"distanceLineSegmentSquared:by"));var g=e-c,h=f-d,k=g*g+h*h;c-=a;d-=b;var l=-c*g-d*h;if(0>=l||l>=k)return g=e-a,h=f-b,Math.min(c*c+d*d,g*g+h*h);a=g*d-h*c;return a*a/k}
function dc(a,b,c,d){E&&(B(a,J,"distanceSquared:px"),B(b,J,"distanceSquared:py"),B(c,J,"distanceSquared:qx"),B(d,J,"distanceSquared:qy"));a=c-a;b=d-b;return a*a+b*b}function ec(a,b,c,d){E&&(B(a,J,"direction:px"),B(b,J,"direction:py"),B(c,J,"direction:qx"),B(d,J,"direction:qy"));a=c-a;b=d-b;if(0===a)return 0<b?90:0>b?270:0;if(0===b)return 0<a?0:180;if(isNaN(a)||isNaN(b))return 0;d=180*Math.atan(Math.abs(b/a))/Math.PI;0>a?d=0>b?d+180:180-d:0>b&&(d=360-d);return d}
t.o=function(){return isFinite(this.x)&&isFinite(this.y)};J.alloc=function(){var a=fc.pop();return void 0===a?new J:a};J.allocAt=function(a,b){var c=fc.pop();if(void 0===c)return new J(a,b);c.x=a;c.y=b;return c};J.free=function(a){fc.push(a)};
na.Object.defineProperties(J.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",J,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",J,"y"),this.ha(a));this.F=a}}});J.prototype.isReal=J.prototype.o;J.prototype.setSpot=J.prototype.rk;J.prototype.setRectSpot=J.prototype.Vi;J.prototype.snapToGridPoint=J.prototype.bA;J.prototype.snapToGrid=J.prototype.aA;
J.prototype.projectOntoLineSegmentPoint=J.prototype.Rz;J.prototype.projectOntoLineSegment=J.prototype.Qz;J.prototype.direction=J.prototype.direction;J.prototype.directionPoint=J.prototype.Xa;J.prototype.normalize=J.prototype.normalize;J.prototype.distanceSquared=J.prototype.ed;J.prototype.distanceSquaredPoint=J.prototype.De;J.prototype.scale=J.prototype.scale;J.prototype.rotate=J.prototype.rotate;J.prototype.offset=J.prototype.offset;J.prototype.subtract=J.prototype.Yd;J.prototype.add=J.prototype.add;
J.prototype.equalsApprox=J.prototype.Sa;J.prototype.equalTo=J.prototype.Fi;J.prototype.equals=J.prototype.A;J.prototype.set=J.prototype.set;J.prototype.setTo=J.prototype.wg;var gc=null,hc=null,ic=null,pc=null,qc=null,fc=[];J.className="Point";J.parse=Vb;J.stringify=Xb;J.distanceLineSegmentSquared=cc;J.distanceSquared=dc;J.direction=ec;J.Origin=gc=(new J(0,0)).ia();J.InfiniteTopLeft=hc=(new J(-Infinity,-Infinity)).ia();J.InfiniteBottomRight=ic=(new J(Infinity,Infinity)).ia();
J.SixPoint=pc=(new J(6,6)).ia();J.NoPoint=qc=(new J(NaN,NaN)).ia();J.parse=Vb;J.stringify=Xb;J.distanceLineSegmentSquared=cc;J.distanceSquared=dc;J.direction=ec;function Zb(a,b){void 0===a?this.Z=this.aa=0:"number"===typeof a&&(0<=a||isNaN(a))&&"number"===typeof b&&(0<=b||isNaN(b))?(this.aa=a,this.Z=b):v("Invalid arguments to Size constructor: "+a+", "+b);this.u=!1}var rc,sc,tc,uc,vc,wc,xc;Zb.prototype.assign=function(a){this.aa=a.aa;this.Z=a.Z;return this};
Zb.prototype.h=function(a,b){this.aa=a;this.Z=b;return this};Zb.prototype.wg=function(a,b){E&&(z(a,"number",Zb,"setTo:w"),z(b,"number",Zb,"setTo:h"),0>a&&Ca(a,">= 0",Zb,"setTo:w"),0>b&&Ca(b,">= 0",Zb,"setTo:h"),this.ha());this.aa=a;this.Z=b;return this};Zb.prototype.set=function(a){E&&(w(a,Zb,Zb,"set:s"),this.ha());this.aa=a.aa;this.Z=a.Z;return this};Zb.prototype.copy=function(){var a=new Zb;a.aa=this.aa;a.Z=this.Z;return a};t=Zb.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};
t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Size is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function zc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));return new Zb(c,e)}return new Zb}function Ac(a){E&&w(a,Zb);return a.width.toString()+" "+a.height.toString()}t.toString=function(){return"Size("+this.width+","+this.height+")"};t.A=function(a){return a instanceof Zb?this.aa===a.width&&this.Z===a.height:!1};t.Fi=function(a,b){return this.aa===a&&this.Z===b};
t.Sa=function(a){return K.B(this.aa,a.width)&&K.B(this.Z,a.height)};t.o=function(){return isFinite(this.width)&&isFinite(this.height)};Zb.alloc=function(){var a=Bc.pop();return void 0===a?new Zb:a};Zb.free=function(a){Bc.push(a)};
na.Object.defineProperties(Zb.prototype,{width:{configurable:!0,get:function(){return this.aa},set:function(a){E&&(z(a,"number",Zb,"width"),this.ha(a));0>a&&Ca(a,">= 0",Zb,"width");this.aa=a}},height:{configurable:!0,get:function(){return this.Z},set:function(a){E&&(z(a,"number",Zb,"height"),this.ha(a));0>a&&Ca(a,">= 0",Zb,"height");this.Z=a}}});Zb.prototype.isReal=Zb.prototype.o;Zb.prototype.equalsApprox=Zb.prototype.Sa;Zb.prototype.equalTo=Zb.prototype.Fi;
Zb.prototype.equals=Zb.prototype.A;Zb.prototype.set=Zb.prototype.set;Zb.prototype.setTo=Zb.prototype.wg;var Bc=[];Zb.className="Size";Zb.parse=zc;Zb.stringify=Ac;Zb.ZeroSize=rc=(new Zb(0,0)).ia();Zb.OneSize=sc=(new Zb(1,1)).ia();Zb.SixSize=tc=(new Zb(6,6)).ia();Zb.EightSize=uc=(new Zb(8,8)).ia();Zb.TenSize=vc=(new Zb(10,10)).ia();Zb.InfiniteSize=wc=(new Zb(Infinity,Infinity)).ia();Zb.NoSize=xc=(new Zb(NaN,NaN)).ia();Zb.parse=zc;Zb.stringify=Ac;
function L(a,b,c,d){void 0===a?this.Z=this.aa=this.F=this.D=0:a instanceof J?b instanceof J?(this.D=Math.min(a.D,b.D),this.F=Math.min(a.F,b.F),this.aa=Math.abs(a.D-b.D),this.Z=Math.abs(a.F-b.F)):b instanceof Zb?(this.D=a.D,this.F=a.F,this.aa=b.aa,this.Z=b.Z):v("Incorrect arguments supplied to Rect constructor"):"number"===typeof a&&"number"===typeof b&&"number"===typeof c&&(0<=c||isNaN(c))&&"number"===typeof d&&(0<=d||isNaN(d))?(this.D=a,this.F=b,this.aa=c,this.Z=d):v("Invalid arguments to Rect constructor: "+
a+", "+b+", "+c+", "+d);this.u=!1}t=L.prototype;t.assign=function(a){this.D=a.D;this.F=a.F;this.aa=a.aa;this.Z=a.Z;return this};t.h=function(a,b,c,d){this.D=a;this.F=b;this.aa=c;this.Z=d;return this};function Cc(a,b,c){a.aa=b;a.Z=c}t.wg=function(a,b,c,d){E&&(z(a,"number",L,"setTo:x"),z(b,"number",L,"setTo:y"),z(c,"number",L,"setTo:w"),z(d,"number",L,"setTo:h"),0>c&&Ca(c,">= 0",L,"setTo:w"),0>d&&Ca(d,">= 0",L,"setTo:h"),this.ha());this.D=a;this.F=b;this.aa=c;this.Z=d;return this};
t.set=function(a){E&&(w(a,L,L,"set:r"),this.ha());this.D=a.D;this.F=a.F;this.aa=a.aa;this.Z=a.Z;return this};t.ld=function(a){E&&(w(a,J,L,"setPoint:p"),this.ha());this.D=a.D;this.F=a.F;return this};t.Zz=function(a){E&&(w(a,Zb,L,"setSize:s"),this.ha());this.aa=a.aa;this.Z=a.Z;return this};L.prototype.copy=function(){var a=new L;a.D=this.D;a.F=this.F;a.aa=this.aa;a.Z=this.Z;return a};t=L.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};
t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};t.ha=function(a){if(this.u){var b="The Rect is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function Dc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));for(var g=0;""===a[b];)b++;(d=a[b++])&&(g=parseFloat(d));return new L(c,e,f,g)}return new L}function Ec(a){E&&w(a,L);return a.x.toString()+" "+a.y.toString()+" "+a.width.toString()+" "+a.height.toString()}
t.toString=function(){return"Rect("+this.x+","+this.y+","+this.width+","+this.height+")"};t.A=function(a){return a instanceof L?this.D===a.x&&this.F===a.y&&this.aa===a.width&&this.Z===a.height:!1};t.Fi=function(a,b,c,d){return this.D===a&&this.F===b&&this.aa===c&&this.Z===d};t.Sa=function(a){return K.B(this.D,a.x)&&K.B(this.F,a.y)&&K.B(this.aa,a.width)&&K.B(this.Z,a.height)};function Fc(a,b){return K.da(a.D,b.x)&&K.da(a.F,b.y)&&K.da(a.aa,b.width)&&K.da(a.Z,b.height)}
t.fa=function(a){E&&w(a,J,L,"containsPoint:p");return this.D<=a.x&&this.D+this.aa>=a.x&&this.F<=a.y&&this.F+this.Z>=a.y};t.qf=function(a){E&&w(a,L,L,"containsRect:r");return this.D<=a.x&&a.x+a.width<=this.D+this.aa&&this.F<=a.y&&a.y+a.height<=this.F+this.Z};
t.contains=function(a,b,c,d){E?(B(a,L,"contains:x"),B(b,L,"contains:y"),void 0===c?c=0:B(c,L,"contains:w"),void 0===d?d=0:B(d,L,"contains:h"),(0>c||0>d)&&v("Rect.contains:Width and height cannot be negative")):(void 0===c&&(c=0),void 0===d&&(d=0));return this.D<=a&&a+c<=this.D+this.aa&&this.F<=b&&b+d<=this.F+this.Z};t.reset=function(){E&&this.ha();this.Z=this.aa=this.F=this.D=0};t.offset=function(a,b){E&&(B(a,L,"offset:dx"),B(b,L,"offset:dy"),this.ha());this.D+=a;this.F+=b;return this};
t.Wc=function(a,b){E&&(B(a,L,"inflate:w"),B(b,L,"inflate:h"));return Gc(this,b,a,b,a)};t.Op=function(a){E&&w(a,Jc,L,"addMargin:m");return Gc(this,a.top,a.right,a.bottom,a.left)};t.Sv=function(a){E&&w(a,Jc,L,"subtractMargin:m");return Gc(this,-a.top,-a.right,-a.bottom,-a.left)};t.uz=function(a,b,c,d){E&&(B(a,L,"grow:t"),B(b,L,"grow:r"),B(c,L,"grow:b"),B(d,L,"grow:l"));return Gc(this,a,b,c,d)};
function Gc(a,b,c,d,e){E&&a.ha();var f=a.aa;c+e<=-f?(a.D+=f/2,a.aa=0):(a.D-=e,a.aa+=c+e);c=a.Z;b+d<=-c?(a.F+=c/2,a.Z=0):(a.F-=b,a.Z+=b+d);return a}t.yz=function(a){E&&w(a,L,L,"intersectRect:r");return Kc(this,a.x,a.y,a.width,a.height)};t.lv=function(a,b,c,d){E&&(B(a,L,"intersect:x"),B(b,L,"intersect:y"),B(c,L,"intersect:w"),B(d,L,"intersect:h"),(0>c||0>d)&&v("Rect.intersect:Width and height cannot be negative"));return Kc(this,a,b,c,d)};
function Kc(a,b,c,d,e){E&&a.ha();var f=Math.max(a.D,b),g=Math.max(a.F,c);b=Math.min(a.D+a.aa,b+d);c=Math.min(a.F+a.Z,c+e);a.D=f;a.F=g;a.aa=Math.max(0,b-f);a.Z=Math.max(0,c-g);return a}t.Kc=function(a){E&&w(a,L,L,"intersectsRect:r");return this.mv(a.x,a.y,a.width,a.height)};
t.mv=function(a,b,c,d){E&&(B(a,L,"intersects:x"),B(b,L,"intersects:y"),B(a,L,"intersects:w"),B(b,L,"intersects:h"),(0>c||0>d)&&v("Rect.intersects:Width and height cannot be negative"));var e=this.aa,f=this.D;if(Infinity!==e&&Infinity!==c&&(e+=f,c+=a,isNaN(c)||isNaN(e)||f>c||a>e))return!1;a=this.Z;c=this.F;return Infinity!==a&&Infinity!==d&&(a+=c,d+=b,isNaN(d)||isNaN(a)||c>d||b>a)?!1:!0};
function Lc(a,b,c){var d=a.aa,e=a.D,f=b.x-c;if(e>b.width+c+c+f||f>d+e)return!1;d=a.Z;a=a.F;e=b.y-c;return a>b.height+c+c+e||e>d+a?!1:!0}t.Ke=function(a){E&&w(a,J,L,"unionPoint:p");return Pc(this,a.x,a.y,0,0)};t.Xc=function(a){E&&w(a,L,L,"unionRect:r");return Pc(this,a.D,a.F,a.aa,a.Z)};
t.Zv=function(a,b,c,d){E?(B(a,L,"union:x"),B(b,L,"union:y"),void 0===c?c=0:B(c,L,"union:w"),void 0===d?d=0:B(d,L,"union:h"),(0>c||0>d)&&v("Rect.union:Width and height cannot be negative"),this.ha()):(void 0===c&&(c=0),void 0===d&&(d=0));return Pc(this,a,b,c,d)};function Pc(a,b,c,d,e){var f=Math.min(a.D,b),g=Math.min(a.F,c);b=Math.max(a.D+a.aa,b+d);c=Math.max(a.F+a.Z,c+e);a.D=f;a.F=g;a.aa=b-f;a.Z=c-g;return a}
t.rk=function(a,b,c){E&&(B(a,L,"setSpot:x"),B(b,L,"setSpot:y"),w(c,M,L,"setSpot:spot"),this.ha());this.D=a-c.offsetX-c.x*this.aa;this.F=b-c.offsetY-c.y*this.Z;return this};
function Qc(a,b,c,d,e,f,g,h){E?(B(a,L,"contains:rx"),B(b,L,"contains:ry"),B(c,L,"contains:rw"),B(d,L,"contains:rh"),B(e,L,"contains:x"),B(f,L,"contains:y"),void 0===g?g=0:B(g,L,"contains:w"),void 0===h?h=0:B(h,L,"contains:h"),(0>c||0>d||0>g||0>h)&&v("Rect.contains:Width and height cannot be negative")):(void 0===g&&(g=0),void 0===h&&(h=0));return a<=e&&e+g<=a+c&&b<=f&&f+h<=b+d}
function Rc(a,b,c,d,e,f,g,h){E&&(B(a,L,"intersects:rx"),B(b,L,"intersects:ry"),B(c,L,"intersects:rw"),B(d,L,"intersects:rh"),B(e,L,"intersects:x"),B(f,L,"intersects:y"),B(g,L,"intersects:w"),B(h,L,"intersects:h"),(0>c||0>d||0>g||0>h)&&v("Rect.intersects:Width and height cannot be negative"));return a>g+e||e>c+a?!1:b>h+f||f>d+b?!1:!0}t.o=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)};t.Az=function(){return 0===this.width&&0===this.height};
L.alloc=function(){var a=Sc.pop();return void 0===a?new L:a};L.allocAt=function(a,b,c,d){var e=Sc.pop();return void 0===e?new L(a,b,c,d):e.h(a,b,c,d)};L.free=function(a){Sc.push(a)};
na.Object.defineProperties(L.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",L,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",L,"y"),this.ha(a));this.F=a}},width:{configurable:!0,get:function(){return this.aa},set:function(a){E&&(z(a,"number",L,"width"),this.ha(a));0>a&&Ca(a,">= 0",L,"width");this.aa=a}},height:{configurable:!0,get:function(){return this.Z},
set:function(a){E&&(z(a,"number",L,"height"),this.ha(a));0>a&&Ca(a,">= 0",L,"height");this.Z=a}},left:{configurable:!0,get:function(){return this.D},set:function(a){E&&(z(a,"number",L,"left"),this.ha(a));this.D=a}},top:{configurable:!0,get:function(){return this.F},set:function(a){E&&(z(a,"number",L,"top"),this.ha(a));this.F=a}},right:{configurable:!0,get:function(){return this.D+this.aa},set:function(a){E&&(B(a,L,"right"),this.ha(a));this.D+=a-(this.D+this.aa)}},
bottom:{configurable:!0,get:function(){return this.F+this.Z},set:function(a){E&&(B(a,L,"top"),this.ha(a));this.F+=a-(this.F+this.Z)}},position:{configurable:!0,get:function(){return new J(this.D,this.F)},set:function(a){E&&(w(a,J,L,"position"),this.ha(a));this.D=a.x;this.F=a.y}},size:{configurable:!0,get:function(){return new Zb(this.aa,this.Z)},set:function(a){E&&(w(a,Zb,L,"size"),this.ha(a));this.aa=a.width;this.Z=a.height}},center:{configurable:!0,
get:function(){return new J(this.D+this.aa/2,this.F+this.Z/2)},set:function(a){E&&(w(a,J,L,"center"),this.ha(a));this.D=a.x-this.aa/2;this.F=a.y-this.Z/2}},centerX:{configurable:!0,get:function(){return this.D+this.aa/2},set:function(a){E&&(B(a,L,"centerX"),this.ha(a));this.D=a-this.aa/2}},centerY:{configurable:!0,get:function(){return this.F+this.Z/2},set:function(a){E&&(B(a,L,"centerY"),this.ha(a));this.F=a-this.Z/2}}});L.prototype.isEmpty=L.prototype.Az;
L.prototype.isReal=L.prototype.o;L.prototype.setSpot=L.prototype.rk;L.prototype.union=L.prototype.Zv;L.prototype.unionRect=L.prototype.Xc;L.prototype.unionPoint=L.prototype.Ke;L.prototype.intersects=L.prototype.mv;L.prototype.intersectsRect=L.prototype.Kc;L.prototype.intersect=L.prototype.lv;L.prototype.intersectRect=L.prototype.yz;L.prototype.grow=L.prototype.uz;L.prototype.subtractMargin=L.prototype.Sv;L.prototype.addMargin=L.prototype.Op;L.prototype.inflate=L.prototype.Wc;L.prototype.offset=L.prototype.offset;
L.prototype.contains=L.prototype.contains;L.prototype.containsRect=L.prototype.qf;L.prototype.containsPoint=L.prototype.fa;L.prototype.equalsApprox=L.prototype.Sa;L.prototype.equalTo=L.prototype.Fi;L.prototype.equals=L.prototype.A;L.prototype.setSize=L.prototype.Zz;L.prototype.setPoint=L.prototype.ld;L.prototype.set=L.prototype.set;L.prototype.setTo=L.prototype.wg;var Tc=null,Uc=null,Sc=[];L.className="Rect";L.parse=Dc;L.stringify=Ec;L.contains=Qc;L.intersects=Rc;L.ZeroRect=Tc=(new L(0,0,0,0)).ia();
L.NoRect=Uc=(new L(NaN,NaN,NaN,NaN)).ia();L.parse=Dc;L.stringify=Ec;L.contains=Qc;L.intersects=Rc;function Jc(a,b,c,d){void 0===a?this.ne=this.ce=this.ve=this.ye=0:void 0===b?this.left=this.bottom=this.right=this.top=a:void 0===c?(this.top=a,this.right=b,this.bottom=a,this.left=b):void 0!==d?(this.top=a,this.right=b,this.bottom=c,this.left=d):v("Invalid arguments to Margin constructor: "+a+", "+b+", "+c+", "+d);this.u=!1}
Jc.prototype.assign=function(a){this.ye=a.ye;this.ve=a.ve;this.ce=a.ce;this.ne=a.ne;return this};Jc.prototype.wg=function(a,b,c,d){E&&(z(a,"number",Jc,"setTo:t"),z(b,"number",Jc,"setTo:r"),z(c,"number",Jc,"setTo:b"),z(d,"number",Jc,"setTo:l"),this.ha());this.ye=a;this.ve=b;this.ce=c;this.ne=d;return this};Jc.prototype.set=function(a){E&&(w(a,Jc,Jc,"assign:m"),this.ha());this.ye=a.ye;this.ve=a.ve;this.ce=a.ce;this.ne=a.ne;return this};
Jc.prototype.copy=function(){var a=new Jc;a.ye=this.ye;a.ve=this.ve;a.ce=this.ce;a.ne=this.ne;return a};t=Jc.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};
t.ha=function(a){if(this.u){var b="The Margin is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};
function Vc(a){if("string"===typeof a){a=a.split(" ");for(var b=0,c=NaN;""===a[b];)b++;var d=a[b++];d&&(c=parseFloat(d));if(isNaN(c))return new Jc;for(var e=NaN;""===a[b];)b++;(d=a[b++])&&(e=parseFloat(d));if(isNaN(e))return new Jc(c);for(var f=NaN;""===a[b];)b++;(d=a[b++])&&(f=parseFloat(d));if(isNaN(f))return new Jc(c,e);for(var g=NaN;""===a[b];)b++;(d=a[b++])&&(g=parseFloat(d));return isNaN(g)?new Jc(c,e):new Jc(c,e,f,g)}return new Jc}
function Xc(a){E&&w(a,Jc);return a.top.toString()+" "+a.right.toString()+" "+a.bottom.toString()+" "+a.left.toString()}t.toString=function(){return"Margin("+this.top+","+this.right+","+this.bottom+","+this.left+")"};t.A=function(a){return a instanceof Jc?this.ye===a.top&&this.ve===a.right&&this.ce===a.bottom&&this.ne===a.left:!1};t.Fi=function(a,b,c,d){return this.ye===a&&this.ve===b&&this.ce===c&&this.ne===d};
t.Sa=function(a){return K.B(this.ye,a.top)&&K.B(this.ve,a.right)&&K.B(this.ce,a.bottom)&&K.B(this.ne,a.left)};t.o=function(){return isFinite(this.top)&&isFinite(this.right)&&isFinite(this.bottom)&&isFinite(this.left)};Jc.alloc=function(){var a=Yc.pop();return void 0===a?new Jc:a};Jc.free=function(a){Yc.push(a)};
na.Object.defineProperties(Jc.prototype,{top:{configurable:!0,get:function(){return this.ye},set:function(a){E&&(B(a,Jc,"top"),this.ha(a));this.ye=a}},right:{configurable:!0,get:function(){return this.ve},set:function(a){E&&(B(a,Jc,"right"),this.ha(a));this.ve=a}},bottom:{configurable:!0,get:function(){return this.ce},set:function(a){E&&(B(a,Jc,"bottom"),this.ha(a));this.ce=a}},left:{configurable:!0,get:function(){return this.ne},set:function(a){E&&
(B(a,Jc,"left"),this.ha(a));this.ne=a}}});Jc.prototype.isReal=Jc.prototype.o;Jc.prototype.equalsApprox=Jc.prototype.Sa;Jc.prototype.equalTo=Jc.prototype.Fi;Jc.prototype.equals=Jc.prototype.A;Jc.prototype.set=Jc.prototype.set;Jc.prototype.setTo=Jc.prototype.wg;var Zc=null,cd=null,Yc=[];Jc.className="Margin";Jc.parse=Vc;Jc.stringify=Xc;Jc.ZeroMargin=Zc=(new Jc(0,0,0,0)).ia();Jc.TwoMargin=cd=(new Jc(2,2,2,2)).ia();Jc.parse=Vc;Jc.stringify=Xc;
function $b(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0}$b.prototype.set=function(a){this.m11=a.m11;this.m12=a.m12;this.m21=a.m21;this.m22=a.m22;this.dx=a.dx;this.dy=a.dy;return this};$b.prototype.copy=function(){var a=new $b;a.m11=this.m11;a.m12=this.m12;a.m21=this.m21;a.m22=this.m22;a.dx=this.dx;a.dy=this.dy;return a};t=$b.prototype;t.toString=function(){return"Transform("+this.m11+","+this.m12+","+this.m21+","+this.m22+","+this.dx+","+this.dy+")"};
t.A=function(a){return a instanceof $b?this.m11===a.m11&&this.m12===a.m12&&this.m21===a.m21&&this.m22===a.m22&&this.dx===a.dx&&this.dy===a.dy:!1};t.ht=function(){return 0===this.dx&&0===this.dy&&1===this.m11&&0===this.m12&&0===this.m21&&1===this.m22};t.reset=function(){this.m11=1;this.m21=this.m12=0;this.m22=1;this.dy=this.dx=0;return this};
t.multiply=function(a){var b=this.m12*a.m11+this.m22*a.m12,c=this.m11*a.m21+this.m21*a.m22,d=this.m12*a.m21+this.m22*a.m22,e=this.m11*a.dx+this.m21*a.dy+this.dx,f=this.m12*a.dx+this.m22*a.dy+this.dy;this.m11=this.m11*a.m11+this.m21*a.m12;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
t.rv=function(a){var b=1/(a.m11*a.m22-a.m12*a.m21),c=a.m22*b,d=-a.m12*b,e=-a.m21*b,f=a.m11*b,g=b*(a.m21*a.dy-a.m22*a.dx);a=b*(a.m12*a.dx-a.m11*a.dy);b=this.m11*c+this.m21*d;c=this.m12*c+this.m22*d;d=this.m11*e+this.m21*f;e=this.m12*e+this.m22*f;this.dx=this.m11*g+this.m21*a+this.dx;this.dy=this.m12*g+this.m22*a+this.dy;this.m11=b;this.m12=c;this.m21=d;this.m22=e;return this};
t.ft=function(){var a=1/(this.m11*this.m22-this.m12*this.m21),b=-this.m12*a,c=-this.m21*a,d=this.m11*a,e=a*(this.m21*this.dy-this.m22*this.dx),f=a*(this.m12*this.dx-this.m11*this.dy);this.m11=this.m22*a;this.m12=b;this.m21=c;this.m22=d;this.dx=e;this.dy=f;return this};
$b.prototype.rotate=function(a,b,c){E&&(B(a,$b,"rotate:angle"),B(b,$b,"rotate:rx"),B(c,$b,"rotate:ry"));360<=a?a-=360:0>a&&(a+=360);if(0===a)return this;this.translate(b,c);if(90===a){a=0;var d=1}else 180===a?(a=-1,d=0):270===a?(a=0,d=-1):(d=a*Math.PI/180,a=Math.cos(d),d=Math.sin(d));var e=this.m12*a+this.m22*d,f=this.m11*-d+this.m21*a,g=this.m12*-d+this.m22*a;this.m11=this.m11*a+this.m21*d;this.m12=e;this.m21=f;this.m22=g;this.translate(-b,-c);return this};t=$b.prototype;
t.translate=function(a,b){E&&(B(a,$b,"translate:x"),B(b,$b,"translate:y"));this.dx+=this.m11*a+this.m21*b;this.dy+=this.m12*a+this.m22*b;return this};t.scale=function(a,b){void 0===b&&(b=a);E&&(B(a,$b,"translate:sx"),B(b,$b,"translate:sy"));this.m11*=a;this.m12*=a;this.m21*=b;this.m22*=b;return this};t.va=function(a){var b=a.D,c=a.F;a.D=b*this.m11+c*this.m21+this.dx;a.F=b*this.m12+c*this.m22+this.dy;return a};
t.Vd=function(a){var b=1/(this.m11*this.m22-this.m12*this.m21),c=-this.m12*b,d=this.m11*b,e=b*(this.m12*this.dx-this.m11*this.dy),f=a.D,g=a.F;a.D=f*this.m22*b+g*-this.m21*b+b*(this.m21*this.dy-this.m22*this.dx);a.F=f*c+g*d+e;return a};
t.Yv=function(a){var b=a.D,c=a.F,d=b+a.aa,e=c+a.Z,f=this.m11,g=this.m12,h=this.m21,k=this.m22,l=this.dx,m=this.dy,n=b*f+c*h+l,p=b*g+c*k+m,q=d*f+c*h+l,r=d*g+c*k+m;c=b*f+e*h+l;b=b*g+e*k+m;f=d*f+e*h+l;d=d*g+e*k+m;e=Math.min(n,q);n=Math.max(n,q);q=Math.min(p,r);p=Math.max(p,r);e=Math.min(e,c);n=Math.max(n,c);q=Math.min(q,b);p=Math.max(p,b);e=Math.min(e,f);n=Math.max(n,f);q=Math.min(q,d);p=Math.max(p,d);a.D=e;a.F=q;a.aa=n-e;a.Z=p-q;return a};
$b.alloc=function(){var a=dd.pop();return void 0===a?new $b:a};$b.free=function(a){dd.push(a)};$b.prototype.transformRect=$b.prototype.Yv;$b.prototype.invertedTransformPoint=$b.prototype.Vd;$b.prototype.transformPoint=$b.prototype.va;$b.prototype.scale=$b.prototype.scale;$b.prototype.translate=$b.prototype.translate;$b.prototype.rotate=$b.prototype.rotate;$b.prototype.invert=$b.prototype.ft;$b.prototype.multiplyInverted=$b.prototype.rv;$b.prototype.multiply=$b.prototype.multiply;
$b.prototype.reset=$b.prototype.reset;$b.prototype.isIdentity=$b.prototype.ht;$b.prototype.equals=$b.prototype.A;$b.prototype.set=$b.prototype.set;var dd=[];$b.className="Transform";$b.xF="54a702f3e53909c447824c6706603faf4c";function M(a,b,c,d){void 0===a?this.Od=this.Nd=this.F=this.D=0:(void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=0),this.x=a,this.y=b,this.offsetX=c,this.offsetY=d);this.u=!1}
var ed,fd,gd,hd,pd,qd,rd,sd,td,ud,vd,wd,Ad,Bd,Cd,Dd,Ed,Fd,Gd,Hd,Id,Md,Nd,Od,Pd,Qd,Rd,Sd,Td,Ud,Vd,Wd,Xd,de,ee,fe;M.prototype.assign=function(a){this.D=a.D;this.F=a.F;this.Nd=a.Nd;this.Od=a.Od;return this};M.prototype.wg=function(a,b,c,d){E&&(ge(a,"setTo:x"),ge(b,"setTo:y"),he(c,"setTo:offx"),he(d,"setTo:offy"),this.ha());this.D=a;this.F=b;this.Nd=c;this.Od=d;return this};M.prototype.set=function(a){E&&(w(a,M,M,"set:s"),this.ha());this.D=a.D;this.F=a.F;this.Nd=a.Nd;this.Od=a.Od;return this};
M.prototype.copy=function(){var a=new M;a.D=this.D;a.F=this.F;a.Nd=this.Nd;a.Od=this.Od;return a};t=M.prototype;t.ia=function(){this.u=!0;Object.freeze(this);return this};t.J=function(){return Object.isFrozen(this)?this:this.copy().freeze()};t.freeze=function(){this.u=!0;return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;return this};
t.ha=function(a){if(this.u){var b="The Spot is frozen, so its properties cannot be set: "+this.toString();void 0!==a&&(b+="  to value: "+a);v(b)}};function ie(a,b){a.D=NaN;a.F=NaN;a.Nd=b;return a}function ge(a,b){(isNaN(a)||1<a||0>a)&&Ca(a,"0 <= "+b+" <= 1",M,b)}function he(a,b){(isNaN(a)||Infinity===a||-Infinity===a)&&Ca(a,"real number, not NaN or Infinity",M,b)}
function je(a){if("string"===typeof a){a=a.trim();if("None"===a)return ed;if("TopLeft"===a)return fd;if("Top"===a||"TopCenter"===a||"MiddleTop"===a)return gd;if("TopRight"===a)return hd;if("Left"===a||"LeftCenter"===a||"MiddleLeft"===a)return pd;if("Center"===a)return qd;if("Right"===a||"RightCenter"===a||"MiddleRight"===a)return rd;if("BottomLeft"===a)return sd;if("Bottom"===a||"BottomCenter"===a||"MiddleBottom"===a)return td;if("BottomRight"===a)return ud;if("TopSide"===a)return vd;if("LeftSide"===
a)return wd;if("RightSide"===a)return Ad;if("BottomSide"===a)return Bd;if("TopBottomSides"===a)return Cd;if("LeftRightSides"===a)return Dd;if("TopLeftSides"===a)return Ed;if("TopRightSides"===a)return Fd;if("BottomLeftSides"===a)return Gd;if("BottomRightSides"===a)return Hd;if("NotTopSide"===a)return Id;if("NotLeftSide"===a)return Md;if("NotRightSide"===a)return Nd;if("NotBottomSide"===a)return Od;if("AllSides"===a)return Pd;if("Default"===a)return Qd;a=a.split(" ");for(var b=0,c=0;""===a[b];)b++;
var d=a[b++];void 0!==d&&0<d.length&&(c=parseFloat(d));for(var e=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(e=parseFloat(d));for(var f=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(f=parseFloat(d));for(var g=0;""===a[b];)b++;d=a[b++];void 0!==d&&0<d.length&&(g=parseFloat(d));return new M(c,e,f,g)}return new M}function ke(a){E&&w(a,M);return a.Za()?a.x.toString()+" "+a.y.toString()+" "+a.offsetX.toString()+" "+a.offsetY.toString():a.toString()}
t.toString=function(){return this.Za()?0===this.Nd&&0===this.Od?"Spot("+this.x+","+this.y+")":"Spot("+this.x+","+this.y+","+this.offsetX+","+this.offsetY+")":this.A(ed)?"None":this.A(fd)?"TopLeft":this.A(gd)?"Top":this.A(hd)?"TopRight":this.A(pd)?"Left":this.A(qd)?"Center":this.A(rd)?"Right":this.A(sd)?"BottomLeft":this.A(td)?"Bottom":this.A(ud)?"BottomRight":this.A(vd)?"TopSide":this.A(wd)?"LeftSide":this.A(Ad)?"RightSide":this.A(Bd)?"BottomSide":this.A(Cd)?"TopBottomSides":this.A(Dd)?"LeftRightSides":
this.A(Ed)?"TopLeftSides":this.A(Fd)?"TopRightSides":this.A(Gd)?"BottomLeftSides":this.A(Hd)?"BottomRightSides":this.A(Id)?"NotTopSide":this.A(Md)?"NotLeftSide":this.A(Nd)?"NotRightSide":this.A(Od)?"NotBottomSide":this.A(Pd)?"AllSides":this.A(Qd)?"Default":"None"};t.A=function(a){return a instanceof M?(this.D===a.x||isNaN(this.D)&&isNaN(a.x))&&(this.F===a.y||isNaN(this.F)&&isNaN(a.y))&&this.Nd===a.offsetX&&this.Od===a.offsetY:!1};
t.vv=function(){return new M(.5-(this.D-.5),.5-(this.F-.5),-this.Nd,-this.Od)};t.tf=function(a){if(!this.uf())return!1;if(!a.uf())if(a.A(Rd))a=wd;else if(a.A(Sd))a=Ad;else if(a.A(Td))a=vd;else if(a.A(Ud))a=Bd;else return!1;a=a.offsetY;return(this.Od&a)===a};t.Za=function(){return!isNaN(this.x)&&!isNaN(this.y)};t.Nb=function(){return isNaN(this.x)||isNaN(this.y)};t.uf=function(){return isNaN(this.x)&&isNaN(this.y)&&1===this.offsetX&&0!==this.offsetY};
t.fq=function(){return isNaN(this.x)&&isNaN(this.y)&&0===this.offsetX&&0===this.offsetY};t.Cb=function(){return isNaN(this.x)&&isNaN(this.y)&&-1===this.offsetX&&0===this.offsetY};M.alloc=function(){var a=le.pop();return void 0===a?new M:a};M.free=function(a){le.push(a)};
na.Object.defineProperties(M.prototype,{x:{configurable:!0,get:function(){return this.D},set:function(a){E&&(ge(a,"x"),this.ha(a));this.D=a}},y:{configurable:!0,get:function(){return this.F},set:function(a){E&&(ge(a,"y"),this.ha(a));this.F=a}},offsetX:{configurable:!0,get:function(){return this.Nd},set:function(a){E&&(he(a,"offsetX"),this.ha(a));this.Nd=a}},offsetY:{configurable:!0,get:function(){return this.Od},set:function(a){E&&(he(a,"offsetY"),
this.ha(a));this.Od=a}}});M.prototype.isDefault=M.prototype.Cb;M.prototype.isNone=M.prototype.fq;M.prototype.isSide=M.prototype.uf;M.prototype.isNoSpot=M.prototype.Nb;M.prototype.isSpot=M.prototype.Za;M.prototype.includesSide=M.prototype.tf;M.prototype.opposite=M.prototype.vv;M.prototype.equals=M.prototype.A;M.prototype.set=M.prototype.set;M.prototype.setTo=M.prototype.wg;var le=[];M.className="Spot";M.parse=je;M.stringify=ke;M.None=ed=ie(new M(0,0,0,0),0).ia();M.Default=Qd=ie(new M(0,0,-1,0),-1).ia();
M.TopLeft=fd=(new M(0,0,0,0)).ia();M.TopCenter=gd=(new M(.5,0,0,0)).ia();M.TopRight=hd=(new M(1,0,0,0)).ia();M.LeftCenter=pd=(new M(0,.5,0,0)).ia();M.Center=qd=(new M(.5,.5,0,0)).ia();M.RightCenter=rd=(new M(1,.5,0,0)).ia();M.BottomLeft=sd=(new M(0,1,0,0)).ia();M.BottomCenter=td=(new M(.5,1,0,0)).ia();M.BottomRight=ud=(new M(1,1,0,0)).ia();M.MiddleTop=Vd=gd;M.MiddleLeft=Wd=pd;M.MiddleRight=Xd=rd;M.MiddleBottom=de=td;M.Top=Td=gd;M.Left=Rd=pd;M.Right=Sd=rd;M.Bottom=Ud=td;
M.TopSide=vd=ie(new M(0,0,1,1),1).ia();M.LeftSide=wd=ie(new M(0,0,1,2),1).ia();M.RightSide=Ad=ie(new M(0,0,1,4),1).ia();M.BottomSide=Bd=ie(new M(0,0,1,8),1).ia();M.TopBottomSides=Cd=ie(new M(0,0,1,9),1).ia();M.LeftRightSides=Dd=ie(new M(0,0,1,6),1).ia();M.TopLeftSides=Ed=ie(new M(0,0,1,3),1).ia();M.TopRightSides=Fd=ie(new M(0,0,1,5),1).ia();M.BottomLeftSides=Gd=ie(new M(0,0,1,10),1).ia();M.BottomRightSides=Hd=ie(new M(0,0,1,12),1).ia();M.NotTopSide=Id=ie(new M(0,0,1,14),1).ia();
M.NotLeftSide=Md=ie(new M(0,0,1,13),1).ia();M.NotRightSide=Nd=ie(new M(0,0,1,11),1).ia();M.NotBottomSide=Od=ie(new M(0,0,1,7),1).ia();M.AllSides=Pd=ie(new M(0,0,1,15),1).ia();ee=(new M(.156,.156)).ia();fe=(new M(.844,.844)).ia();M.parse=je;M.stringify=ke;
var K={gA:"7da71ca0ad381e90",Ag:(Math.sqrt(2)-1)/3*4,jw:null,sqrt:function(a){if(0>=a)return 0;var b=K.jw;if(null===b){b=[];for(var c=0;2E3>=c;c++)b[c]=Math.sqrt(c);K.jw=b}return 1>a?(c=1/a,2E3>=c?1/b[c|0]:Math.sqrt(a)):2E3>=a?b[a|0]:Math.sqrt(a)},B:function(a,b){a-=b;return.5>a&&-.5<a},da:function(a,b){a-=b;return 5E-8>a&&-5E-8<a},Vb:function(a,b,c,d,e,f,g){0>=e&&(e=1E-6);if(a<c){var h=a;var k=c}else h=c,k=a;if(b<d){var l=b;var m=d}else l=d,m=b;if(a===c)return l<=g&&g<=m&&a-e<=f&&f<=a+e;if(b===d)return h<=
f&&f<=k&&b-e<=g&&g<=b+e;k+=e;h-=e;if(h<=f&&f<=k&&(m+=e,l-=e,l<=g&&g<=m))if(k-h>m-l)if(a-c>e||c-a>e){if(f=(d-b)/(c-a)*(f-a)+b,f-e<=g&&g<=f+e)return!0}else return!0;else if(b-d>e||d-b>e){if(g=(c-a)/(d-b)*(g-b)+a,g-e<=f&&f<=g+e)return!0}else return!0;return!1},Ls:function(a,b,c,d,e,f,g,h,k,l,m,n){if(K.Vb(a,b,g,h,n,c,d)&&K.Vb(a,b,g,h,n,e,f))return K.Vb(a,b,g,h,n,l,m);var p=(a+c)/2,q=(b+d)/2,r=(c+e)/2,u=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(p+r)/2;c=(q+u)/2;r=(r+e)/2;u=(u+f)/2;var y=(d+r)/2,x=(c+u)/2;return K.Ls(a,
b,p,q,d,c,y,x,k,l,m,n)||K.Ls(y,x,r,u,e,f,g,h,k,l,m,n)},vy:function(a,b,c,d,e,f,g,h,k){var l=(c+e)/2,m=(d+f)/2;k.h((((a+c)/2+l)/2+(l+(e+g)/2)/2)/2,(((b+d)/2+m)/2+(m+(f+h)/2)/2)/2);return k},uy:function(a,b,c,d,e,f,g,h){var k=(c+e)/2,l=(d+f)/2;return ec(((a+c)/2+k)/2,((b+d)/2+l)/2,(k+(e+g)/2)/2,(l+(f+h)/2)/2)},Wl:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,g,h,k,c,d)&&K.Vb(a,b,g,h,k,e,f))Pc(l,a,b,0,0),Pc(l,g,h,0,0);else{var m=(a+c)/2,n=(b+d)/2,p=(c+e)/2,q=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(m+p)/2;c=(n+q)/
2;p=(p+e)/2;q=(q+f)/2;var r=(d+p)/2,u=(c+q)/2;K.Wl(a,b,m,n,d,c,r,u,k,l);K.Wl(r,u,p,q,e,f,g,h,k,l)}return l},Be:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,g,h,k,c,d)&&K.Vb(a,b,g,h,k,e,f))0===l.length&&(l.push(a),l.push(b)),l.push(g),l.push(h);else{var m=(a+c)/2,n=(b+d)/2,p=(c+e)/2,q=(d+f)/2;e=(e+g)/2;f=(f+h)/2;d=(m+p)/2;c=(n+q)/2;p=(p+e)/2;q=(q+f)/2;var r=(d+p)/2,u=(c+q)/2;K.Be(a,b,m,n,d,c,r,u,k,l);K.Be(r,u,p,q,e,f,g,h,k,l)}return l},jA:function(a,b,c,d,e,f,g,h,k,l,m,n,p,q){var r=1-k;a=a*r+c*k;b=b*
r+d*k;c=c*r+e*k;d=d*r+f*k;e=e*r+g*k;f=f*r+h*k;h=a*r+c*k;g=b*r+d*k;c=c*r+e*k;d=d*r+f*k;var u=h*r+c*k;k=g*r+d*k;l.h(a,b);m.h(h,g);n.h(u,k);p.h(c,d);q.h(e,f)},yv:function(a,b,c,d,e,f,g,h,k,l){if(K.Vb(a,b,e,f,l,c,d))return K.Vb(a,b,e,f,l,h,k);var m=(a+c)/2,n=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var p=(m+c)/2,q=(n+d)/2;return K.yv(a,b,m,n,p,q,g,h,k,l)||K.yv(p,q,c,d,e,f,g,h,k,l)},sA:function(a,b,c,d,e,f,g){g.h(((a+c)/2+(c+e)/2)/2,((b+d)/2+(d+f)/2)/2);return g},xv:function(a,b,c,d,e,f,g,h){if(K.Vb(a,b,e,f,g,c,d))Pc(h,
a,b,0,0),Pc(h,e,f,0,0);else{var k=(a+c)/2,l=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var m=(k+c)/2,n=(l+d)/2;K.xv(a,b,k,l,m,n,g,h);K.xv(m,n,c,d,e,f,g,h)}return h},oq:function(a,b,c,d,e,f,g,h){if(K.Vb(a,b,e,f,g,c,d))0===h.length&&(h.push(a),h.push(b)),h.push(e),h.push(f);else{var k=(a+c)/2,l=(b+d)/2;c=(c+e)/2;d=(d+f)/2;var m=(k+c)/2,n=(l+d)/2;K.oq(a,b,k,l,m,n,g,h);K.oq(m,n,c,d,e,f,g,h)}return h},Pp:function(a,b,c,d,e,f,g,h,k,l,m,n,p,q){if(K.Vb(a,b,g,h,p,c,d)&&K.Vb(a,b,g,h,p,e,f)){var r=(a-g)*(l-n)-(b-h)*(k-m);
if(0===r)return!1;p=((a*h-b*g)*(k-m)-(a-g)*(k*n-l*m))/r;r=((a*h-b*g)*(l-n)-(b-h)*(k*n-l*m))/r;if((k>m?k-m:m-k)<(l>n?l-n:n-l)){if(b<h?g=b:(g=h,h=b),r<g||r>h)return!1}else if(a<g?h=a:(h=g,g=a),p<h||p>g)return!1;q.h(p,r);return!0}r=(a+c)/2;var u=(b+d)/2;c=(c+e)/2;d=(d+f)/2;e=(e+g)/2;f=(f+h)/2;var y=(r+c)/2,x=(u+d)/2;c=(c+e)/2;d=(d+f)/2;var A=(y+c)/2,C=(x+d)/2,F=(m-k)*(m-k)+(n-l)*(n-l),H=!1;K.Pp(a,b,r,u,y,x,A,C,k,l,m,n,p,q)&&(a=(q.x-k)*(q.x-k)+(q.y-l)*(q.y-l),a<F&&(F=a,H=!0));a=q.x;b=q.y;K.Pp(A,C,c,d,
e,f,g,h,k,l,m,n,p,q)&&((q.x-k)*(q.x-k)+(q.y-l)*(q.y-l)<F?H=!0:q.h(a,b));return H},Qp:function(a,b,c,d,e,f,g,h,k,l,m,n,p){var q=0;if(K.Vb(a,b,g,h,p,c,d)&&K.Vb(a,b,g,h,p,e,f)){p=(a-g)*(l-n)-(b-h)*(k-m);if(0===p)return q;var r=((a*h-b*g)*(k-m)-(a-g)*(k*n-l*m))/p,u=((a*h-b*g)*(l-n)-(b-h)*(k*n-l*m))/p;if(r>=m)return q;if((k>m?k-m:m-k)<(l>n?l-n:n-l)){if(b<h?(a=b,b=h):a=h,u<a||u>b)return q}else if(a<g?(b=a,a=g):b=g,r<b||r>a)return q;0<p?q++:0>p&&q--}else{r=(a+c)/2;u=(b+d)/2;var y=(c+e)/2,x=(d+f)/2;e=(e+
g)/2;f=(f+h)/2;d=(r+y)/2;c=(u+x)/2;y=(y+e)/2;x=(x+f)/2;var A=(d+y)/2,C=(c+x)/2;q+=K.Qp(a,b,r,u,d,c,A,C,k,l,m,n,p);q+=K.Qp(A,C,y,x,e,f,g,h,k,l,m,n,p)}return q},Ti:function(a,b,c,d,e,f,g){if(K.da(a,c)){b<d?(c=b,b=d):c=d;if(f<c)return g.h(a,c),!1;if(f>b)return g.h(a,b),!1;g.h(a,f);return!0}if(K.da(b,d)){a<c?(d=a,a=c):d=c;if(e<d)return g.h(d,b),!1;if(e>a)return g.h(a,b),!1;g.h(e,b);return!0}e=((a-e)*(a-c)+(b-f)*(b-d))/((c-a)*(c-a)+(d-b)*(d-b));if(-5E-6>e)return g.h(a,b),!1;if(1.000005<e)return g.h(c,
d),!1;g.h(a+e*(c-a),b+e*(d-b));return!0},He:function(a,b,c,d,e,f,g,h,k){if(K.B(a,c)&&K.B(b,d))return k.h(a,b),!1;if(K.da(e,g))return K.da(a,c)?(K.Ti(a,b,c,d,e,f,k),!1):K.Ti(a,b,c,d,e,(d-b)/(c-a)*(e-a)+b,k);h=(h-f)/(g-e);if(K.da(a,c)){c=h*(a-e)+f;b<d?(e=b,b=d):e=d;if(c<e)return k.h(a,e),!1;if(c>b)return k.h(a,b),!1;k.h(a,c);return!0}g=(d-b)/(c-a);if(K.da(h,g))return K.Ti(a,b,c,d,e,f,k),!1;e=(g*a-h*e+f-b)/(g-h);if(K.da(g,0)){a<c?(d=a,a=c):d=c;if(e<d)return k.h(d,b),!1;if(e>a)return k.h(a,b),!1;k.h(e,
b);return!0}return K.Ti(a,b,c,d,e,g*(e-a)+b,k)},oA:function(a,b,c,d,e){return K.He(c.x,c.y,d.x,d.y,a.x,a.y,b.x,b.y,e)},nA:function(a,b,c,d,e,f,g,h,k,l){function m(c,d){var e=(c-a)*(c-a)+(d-b)*(d-b);e<n&&(n=e,k.h(c,d))}var n=Infinity;m(k.x,k.y);var p=0,q=0,r=0,u=0;e<g?(p=e,q=g):(p=g,q=e);f<h?(r=e,u=g):(r=g,u=e);p=(q-p)/2+l;l=(u-r)/2+l;e=(e+g)/2;f=(f+h)/2;if(0===p||0===l)return k;if(.5>(c>a?c-a:a-c)){p=1-(c-e)*(c-e)/(p*p);if(0>p)return k;p=Math.sqrt(p);d=-l*p+f;m(c,l*p+f);m(c,d)}else{c=(d-b)/(c-a);
d=1/(p*p)+c*c/(l*l);h=2*c*(b-c*a)/(l*l)-2*c*f/(l*l)-2*e/(p*p);p=h*h-4*d*(2*c*a*f/(l*l)-2*b*f/(l*l)+f*f/(l*l)+e*e/(p*p)-1+(b-c*a)*(b-c*a)/(l*l));if(0>p)return k;p=Math.sqrt(p);l=(-h+p)/(2*d);m(l,c*l-c*a+b);p=(-h-p)/(2*d);m(p,c*p-c*a+b)}return k},Vc:function(a,b,c,d,e,f,g,h,k){var l=1E21,m=a,n=b;if(K.He(a,b,a,d,e,f,g,h,k)){var p=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f);p<l&&(l=p,m=k.x,n=k.y)}K.He(c,b,c,d,e,f,g,h,k)&&(p=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f),p<l&&(l=p,m=k.x,n=k.y));K.He(a,b,c,b,e,f,g,h,k)&&(b=(k.x-
e)*(k.x-e)+(k.y-f)*(k.y-f),b<l&&(l=b,m=k.x,n=k.y));K.He(a,d,c,d,e,f,g,h,k)&&(a=(k.x-e)*(k.x-e)+(k.y-f)*(k.y-f),a<l&&(l=a,m=k.x,n=k.y));k.h(m,n);return 1E21>l},mA:function(a,b,c,d,e,f,g,h,k){c=a-c;g=e-g;0===c||0===g?0===c?(b=(f-h)/g,h=a,e=b*h+(f-b*e)):(f=(b-d)/c,h=e,e=f*h+(b-f*a)):(d=(b-d)/c,h=(f-h)/g,a=b-d*a,h=(f-h*e-a)/(d-h),e=d*h+a);k.h(h,e);return k},dt:function(a,b,c){var d=b.x,e=b.y,f=c.x,g=c.y,h=a.left,k=a.right,l=a.top,m=a.bottom;return d===f?(e<g?(f=e,e=g):f=g,h<=d&&d<=k&&f<=m&&e>=l):e===
g?(d<f?(g=d,d=f):g=f,l<=e&&e<=m&&g<=k&&d>=h):a.fa(b)||a.fa(c)||K.ct(h,l,k,l,d,e,f,g)||K.ct(k,l,k,m,d,e,f,g)||K.ct(k,m,h,m,d,e,f,g)||K.ct(h,m,h,l,d,e,f,g)?!0:!1},ct:function(a,b,c,d,e,f,g,h){return 0>=K.Os(a,b,c,d,e,f)*K.Os(a,b,c,d,g,h)&&0>=K.Os(e,f,g,h,a,b)*K.Os(e,f,g,h,c,d)},Os:function(a,b,c,d,e,f){c-=a;d-=b;a=e-a;b=f-b;f=a*d-b*c;0===f&&(f=a*c+b*d,0<f&&(f=(a-c)*c+(b-d)*d,0>f&&(f=0)));return 0>f?-1:0<f?1:0},lq:function(a){0>a&&(a+=360);360<=a&&(a-=360);return a},hx:function(a,b,c,d,e,f){var g=Math.PI;
f||(d*=g/180,e*=g/180);var h=d>e?-1:1;f=[];var k=g/2,l=d;d=Math.min(2*g,Math.abs(e-d));if(1E-5>d)return k=l+h*Math.min(d,k),h=a+c*Math.cos(l),l=b+c*Math.sin(l),a+=c*Math.cos(k),b+=c*Math.sin(k),c=(h+a)/2,k=(l+b)/2,f.push([h,l,c,k,c,k,a,b]),f;for(;1E-5<d;)e=l+h*Math.min(d,k),f.push(K.Cy(c,l,e,a,b)),d-=Math.abs(e-l),l=e;return f},Cy:function(a,b,c,d,e){var f=(c-b)/2,g=a*Math.cos(f),h=a*Math.sin(f),k=-h,l=g*g+k*k,m=l+g*g+k*h;l=4/3*(Math.sqrt(2*l*m)-m)/(g*h-k*g);h=g-l*k;g=k+l*g;k=-g;l=f+b;f=Math.cos(l);
l=Math.sin(l);return[d+a*Math.cos(b),e+a*Math.sin(b),d+h*f-g*l,e+h*l+g*f,d+h*f-k*l,e+h*l+k*f,d+a*Math.cos(c),e+a*Math.sin(c)]},Xp:function(a,b,c,d,e,f,g){c=Math.floor((a-c)/e)*e+c;d=Math.floor((b-d)/f)*f+d;var h=c;c+e-a<e/2&&(h=c+e);a=d;d+f-b<f/2&&(a=d+f);g.h(h,a);return g},px:function(a,b){var c=Math.max(a,b);a=Math.min(a,b);var d;do b=c%a,c=d=a,a=b;while(0<b);return d},Hy:function(a,b,c,d){var e=0>c,f=0>d;if(a<b){var g=1;var h=0}else g=0,h=1;var k=0===g?a:b;var l=0===g?c:d;if(0===g?e:f)l=-l;g=h;
c=0===g?c:d;if(0===g?e:f)c=-c;return K.Iy(k,0===g?a:b,l,c,0,0)},Iy:function(a,b,c,d,e,f){if(0<d)if(0<c){e=a*a;f=b*b;a*=c;var g=b*d,h=-f+g,k=-f+Math.sqrt(a*a+g*g);b=h;for(var l=0;9999999999>l;++l){b=.5*(h+k);if(b===h||b===k)break;var m=a/(b+e),n=g/(b+f);m=m*m+n*n-1;if(0<m)h=b;else if(0>m)k=b;else break}c=e*c/(b+e)-c;d=f*d/(b+f)-d;c=Math.sqrt(c*c+d*d)}else c=Math.abs(d-b);else d=a*a-b*b,f=a*c,f<d?(d=f/d,f=b*Math.sqrt(Math.abs(1-d*d)),c=a*d-c,c=Math.sqrt(c*c+f*f)):c=Math.abs(c-a);return c},ae:new xb,
Fm:new xb};K.za=K.gA;function me(a){E&&1<arguments.length&&v("Geometry constructor can take at most one optional argument, the Geometry type.");qb(this);this.u=!1;void 0===a?a=ne:E&&tb(a,me,me,"constructor:type");this.wa=a;this.Dc=this.oc=this.dd=this.cd=0;this.ij=new G;this.mr=this.ij.s;this.Vq=(new L).freeze();this.ta=!0;this.Rm=this.zk=null;this.Sm=NaN;this.ef=fd;this.ff=ud;this.fl=this.hl=NaN;this.Gf=oe}
me.prototype.copy=function(){var a=new me;a.wa=this.wa;a.cd=this.cd;a.dd=this.dd;a.oc=this.oc;a.Dc=this.Dc;for(var b=this.ij.j,c=b.length,d=a.ij,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.mr=this.mr;a.Vq.assign(this.Vq);a.ta=this.ta;a.zk=this.zk;a.Rm=this.Rm;a.Sm=this.Sm;a.ef=this.ef.J();a.ff=this.ff.J();a.hl=this.hl;a.fl=this.fl;a.Gf=this.Gf;return a};t=me.prototype;t.ia=function(){this.freeze();Object.freeze(this);return this};
t.freeze=function(){this.u=!0;var a=this.figures;a.freeze();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].freeze();return this};t.ja=function(){Object.isFrozen(this)&&v("cannot thaw constant: "+this);this.u=!1;var a=this.figures;a.ja();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].ja();return this};
t.Sa=function(a){if(!(a instanceof me))return!1;if(this.type!==a.type)return this.type===te&&a.type===ne?ue(this,a):a.type===te&&this.type===ne?ue(a,this):!1;if(this.type===ne){var b=this.figures.j;a=a.figures.j;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Sa(a[d]))return!1;return!0}return K.B(this.startX,a.startX)&&K.B(this.startY,a.startY)&&K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)};
function ue(a,b){return a.type!==te||b.type!==ne?!1:1===b.figures.count&&(b=b.figures.O(0),1===b.segments.count&&K.B(a.startX,b.startX)&&K.B(a.startY,b.startY)&&(b=b.segments.O(0),b.type===ve&&K.B(a.endX,b.endX)&&K.B(a.endY,b.endY)))?!0:!1}function we(a){return a.toString()}t.hb=function(a){a.classType===me?this.type=a:Fa(this,a)};
t.toString=function(a){void 0===a&&(a=-1);switch(this.type){case te:return 0>a?"M"+this.startX.toString()+" "+this.startY.toString()+"L"+this.endX.toString()+" "+this.endY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a)+"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);case xe:var b=new L(this.startX,this.startY,0,0);b.Zv(this.endX,this.endY,0,0);return 0>a?"M"+b.x.toString()+" "+b.y.toString()+"H"+b.right.toString()+"V"+b.bottom.toString()+"H"+b.left.toString()+"z":"M"+b.x.toFixed(a)+
" "+b.y.toFixed(a)+"H"+b.right.toFixed(a)+"V"+b.bottom.toFixed(a)+"H"+b.left.toFixed(a)+"z";case ye:b=new L(this.startX,this.startY,0,0);b.Zv(this.endX,this.endY,0,0);if(0>a)return a=b.left.toString()+" "+(b.y+b.height/2).toString(),"M"+a+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+(b.right.toString()+" "+(b.y+b.height/2).toString())+"A"+(b.width/2).toString()+" "+(b.height/2).toString()+" 0 0 1 "+a;var c=b.left.toFixed(a)+" "+(b.y+b.height/2).toFixed(a);return"M"+c+"A"+(b.width/
2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+(b.right.toFixed(a)+" "+(b.y+b.height/2).toFixed(a))+"A"+(b.width/2).toFixed(a)+" "+(b.height/2).toFixed(a)+" 0 0 1 "+c;case ne:b="";c=this.figures.j;for(var d=c.length,e=0;e<d;e++){var f=c[e];0<e&&(b+=" x ");f.isFilled&&(b+="F ");b+=f.toString(a)}return b;default:return this.type.toString()}};
function ze(a,b){function c(){return u>=F-1?!0:null!==k[u+1].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/)}function d(){u++;return k[u]}function e(){var a=new J(parseFloat(d()),parseFloat(d()));y===y.toLowerCase()&&(a.x=C.x+a.x,a.y=C.y+a.y);return a}function f(){return C=e()}function g(){return A=e()}function h(){var a=x.toLowerCase();return"c"!==a&&"s"!==a&&"q"!==a&&"t"!==a?C:new J(2*C.x-A.x,2*C.y-A.y)}void 0===b&&(b=!1);"string"!==typeof a&&Ba(a,"string",me,"parse:str");a=a.replace(/,/gm," ");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,
"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2");a=a.replace(/([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])([^\s])/gm,"$1 $2");a=a.replace(/([^\s])([UuBbMmZzLlHhVvCcSsQqTtAaFfXx])/gm,"$1 $2");a=a.replace(/([0-9])([+\-])/gm,"$1 $2");a=a.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");a=a.replace(/[\s\r\t\n]+/gm," ");a=a.replace(/^\s+|\s+$/g,"");var k=a.split(" ");for(a=0;a<k.length;a++){var l=k[a];if(null!==l.match(/(\.[0-9]*)(\.)/gm)){for(var m=
Qa(),n="",p=!1,q=0;q<l.length;q++){var r=l[q];"."!==r||p?"."===r?(m.push(n),n="."):n+=r:(p=!0,n+=r)}m.push(n);k.splice(a,1);for(l=0;l<m.length;l++)k.splice(a+l,0,m[l]);a+=m.length-1;Ta(m)}}var u=-1,y="",x="";m=new J(0,0);var A=new J(0,0),C=new J(0,0),F=k.length;a=Ae(null);n=l=!1;p=!0;for(q=null;!(u>=F-1);)if(x=y,y=d(),""!==y)switch(y.toUpperCase()){case "X":p=!0;n=l=!1;break;case "M":q=f();null===a.gc||!0===p?(Be(a,q.x,q.y,l,!n),p=!1):a.moveTo(q.x,q.y);for(m=C;!c();)q=f(),a.lineTo(q.x,q.y);break;
case "L":for(;!c();)q=f(),a.lineTo(q.x,q.y);break;case "H":for(;!c();)C=new J((y===y.toLowerCase()?C.x:0)+parseFloat(d()),C.y),a.lineTo(C.x,C.y);break;case "V":for(;!c();)C=new J(C.x,(y===y.toLowerCase()?C.y:0)+parseFloat(d())),a.lineTo(C.x,C.y);break;case "C":for(;!c();){q=e();r=g();var H=f();Ce(a,q.x,q.y,r.x,r.y,H.x,H.y)}break;case "S":for(;!c();)q=h(),r=g(),H=f(),Ce(a,q.x,q.y,r.x,r.y,H.x,H.y);break;case "Q":for(;!c();)q=g(),r=f(),He(a,q.x,q.y,r.x,r.y);break;case "T":for(;!c();)A=q=h(),r=f(),He(a,
q.x,q.y,r.x,r.y);break;case "B":for(;!c();){q=parseFloat(d());r=parseFloat(d());H=parseFloat(d());var O=parseFloat(d()),S=parseFloat(d()),T=S,ea=!1;c()||(T=parseFloat(d()),c()||(ea=0!==parseFloat(d())));y===y.toLowerCase()&&(H+=C.x,O+=C.y);a.arcTo(q,r,H,O,S,T,ea)}break;case "A":for(;!c();)q=Math.abs(parseFloat(d())),r=Math.abs(parseFloat(d())),H=parseFloat(d()),O=!!parseFloat(d()),S=!!parseFloat(d()),T=f(),Ie(a,q,r,H,O,S,T.x,T.y);break;case "Z":Je(a);C=m;break;case "F":q="";for(r=1;k[u+r];)if(null!==
k[u+r].match(/[Uu]/))r++;else if(null===k[u+r].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/))r++;else{q=k[u+r];break}q.match(/[Mm]/)?l=!0:0<a.gc.segments.length&&(a.gc.isFilled=!0);break;case "U":q="";for(r=1;k[u+r];)if(null!==k[u+r].match(/[Ff]/))r++;else if(null===k[u+r].match(/[UuBbMmZzLlHhVvCcSsQqTtAaFfXx]/))r++;else{q=k[u+r];break}q.match(/[Mm]/)?n=!0:a.vq(!1)}m=a.Ys;Ke=a;if(b)for(b=m.figures.iterator;b.next();)b.value.isFilled=!0;return m}
function Le(a,b){for(var c=a.length,d=J.alloc(),e=0;e<c;e++){var f=a[e];d.x=f[0];d.y=f[1];b.va(d);f[0]=d.x;f[1]=d.y;d.x=f[2];d.y=f[3];b.va(d);f[2]=d.x;f[3]=d.y;d.x=f[4];d.y=f[5];b.va(d);f[4]=d.x;f[5]=d.y;d.x=f[6];d.y=f[7];b.va(d);f[6]=d.x;f[7]=d.y}J.free(d)}t.pv=function(){if(this.ta||this.mr!==this.figures.s)return!0;for(var a=this.figures.j,b=a.length,c=0;c<b;c++)if(a[c].pv())return!0;return!1};
me.prototype.computeBounds=function(){this.ta=!1;this.Rm=this.zk=null;this.Sm=NaN;this.mr=this.figures.s;for(var a=this.figures.j,b=a.length,c=0;c<b;c++){var d=a[c];d.ta=!1;var e=d.segments;d.us=e.s;d=e.j;e=d.length;for(var f=0;f<e;f++){var g=d[f];g.ta=!1;g.Le=null}}a=this.Vq;a.ja();isNaN(this.hl)||isNaN(this.fl)?a.h(0,0,0,0):a.h(0,0,this.hl,this.fl);Me(this,a,!1);Pc(a,0,0,0,0);a.freeze()};me.prototype.gx=function(){var a=new L;Me(this,a,!0);return a};
function Me(a,b,c){switch(a.type){case te:case xe:case ye:c?b.h(a.cd,a.dd,0,0):Pc(b,a.cd,a.dd,0,0);Pc(b,a.oc,a.Dc,0,0);break;case ne:var d=a.figures;a=d.j;d=d.length;for(var e=0;e<d;e++){var f=a[e];c&&0===e?b.h(f.startX,f.startY,0,0):Pc(b,f.startX,f.startY,0,0);for(var g=f.segments.j,h=g.length,k=f.startX,l=f.startY,m=0;m<h;m++){var n=g[m];switch(n.type){case ve:case Ne:k=n.endX;l=n.endY;Pc(b,k,l,0,0);break;case Oe:K.Wl(k,l,n.point1X,n.point1Y,n.point2X,n.point2Y,n.endX,n.endY,.5,b);k=n.endX;l=n.endY;
break;case Pe:K.xv(k,l,n.point1X,n.point1Y,n.endX,n.endY,.5,b);k=n.endX;l=n.endY;break;case Qe:case Re:var p=n.type===Qe?Se(n,f):Te(n,f,k,l),q=p.length;if(0===q){k=n.centerX;l=n.centerY;Pc(b,k,l,0,0);break}n=null;for(var r=0;r<q;r++)n=p[r],K.Wl(n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7],.5,b);null!==n&&(k=n[6],l=n[7]);break;default:v("Unknown Segment type: "+n.type)}}}break;default:v("Unknown Geometry type: "+a.type)}}
me.prototype.normalize=function(){this.u&&ya(this);var a=this.gx();this.offset(-a.x,-a.y);return new J(-a.x,-a.y)};me.prototype.offset=function(a,b){this.u&&ya(this);E&&(B(a,me,"offset"),B(b,me,"offset"));this.transform(1,0,0,1,a,b);return this};me.prototype.scale=function(a,b){this.u&&ya(this);E&&(B(a,me,"scale:x"),B(b,me,"scale:y"),0===a&&Ca(a,"scale must be non-zero",me,"scale:x"),0===b&&Ca(b,"scale must be non-zero",me,"scale:y"));this.transform(a,0,0,b,0,0);return this};
me.prototype.rotate=function(a,b,c){this.u&&ya(this);void 0===b&&(b=0);void 0===c&&(c=0);E&&(B(a,me,"rotate:angle"),B(b,me,"rotate:x"),B(c,me,"rotate:y"));var d=$b.alloc();d.reset();d.rotate(a,b,c);this.transform(d.m11,d.m12,d.m21,d.m22,d.dx,d.dy);$b.free(d);return this};t=me.prototype;
t.transform=function(a,b,c,d,e,f){switch(this.type){case te:case xe:case ye:var g=this.cd;var h=this.dd;this.cd=g*a+h*c+e;this.dd=g*b+h*d+f;g=this.oc;h=this.Dc;this.oc=g*a+h*c+e;this.Dc=g*b+h*d+f;break;case ne:for(var k=this.figures.j,l=k.length,m=0;m<l;m++){var n=k[m];g=n.startX;h=n.startY;n.startX=g*a+h*c+e;n.startY=g*b+h*d+f;n=n.segments.j;for(var p=n.length,q=0;q<p;q++){var r=n[q];switch(r.type){case ve:case Ne:g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Oe:g=r.point1X;h=r.point1Y;
r.point1X=g*a+h*c+e;r.point1Y=g*b+h*d+f;g=r.point2X;h=r.point2Y;r.point2X=g*a+h*c+e;r.point2Y=g*b+h*d+f;g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Pe:g=r.point1X;h=r.point1Y;r.point1X=g*a+h*c+e;r.point1Y=g*b+h*d+f;g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;break;case Qe:g=r.centerX;h=r.centerY;r.centerX=g*a+h*c+e;r.centerY=g*b+h*d+f;0!==b&&(g=180*Math.atan2(b,a)/Math.PI,0>g&&(g+=360),r.startAngle+=g);0>a&&(r.startAngle=180-r.startAngle,r.sweepAngle=-r.sweepAngle);0>d&&
(r.startAngle=-r.startAngle,r.sweepAngle=-r.sweepAngle);r.radiusX*=Math.sqrt(a*a+c*c);void 0!==r.radiusY&&(r.radiusY*=Math.sqrt(b*b+d*d));break;case Re:g=r.endX;h=r.endY;r.endX=g*a+h*c+e;r.endY=g*b+h*d+f;0!==b&&(g=180*Math.atan2(b,a)/Math.PI,0>g&&(g+=360),r.xAxisRotation+=g);0>a&&(r.xAxisRotation=180-r.xAxisRotation,r.isClockwiseArc=!r.isClockwiseArc);0>d&&(r.xAxisRotation=-r.xAxisRotation,r.isClockwiseArc=!r.isClockwiseArc);r.radiusX*=Math.sqrt(a*a+c*c);r.radiusY*=Math.sqrt(b*b+d*d);break;default:v("Unknown Segment type: "+
r.type)}}}}this.ta=!0;return this};
t.fa=function(a,b,c,d){var e=a.x;a=a.y;for(var f=this.bounds.x-20,g=0,h,k,l,m,n,p=this.figures.j,q=p.length,r=0;r<q;r++){var u=p[r];if(u.isFilled){if(c&&u.fa(e,a,b))return!0;var y=u.segments;h=u.startX;k=u.startY;for(var x=h,A=k,C=y.j,F=0;F<=y.length;F++){var H=void 0;if(F!==y.length){H=C[F];var O=H.type;m=H.endX;n=H.endY}else O=ve,m=x,n=A;switch(O){case Ne:x=Ue(e,a,f,a,h,k,x,A);if(isNaN(x))return!0;g+=x;x=m;A=n;break;case ve:h=Ue(e,a,f,a,h,k,m,n);if(isNaN(h))return!0;g+=h;break;case Oe:l=K.Qp(h,
k,H.point1X,H.point1Y,H.point2X,H.point2Y,m,n,f,a,e,a,.5);g+=l;break;case Pe:l=K.Qp(h,k,(h+2*H.point1X)/3,(k+2*H.point1Y)/3,(2*H.point1X+m)/3,(2*H.point1Y+n)/3,m,n,f,a,e,a,.5);g+=l;break;case Qe:case Re:O=H.type===Qe?Se(H,u):Te(H,u,h,k);var S=O.length;if(0===S){h=Ue(e,a,f,a,h,k,H.centerX,H.centerY);if(isNaN(h))return!0;g+=h;break}H=null;for(var T=0;T<S;T++){H=O[T];if(0===T){l=Ue(e,a,f,a,h,k,H[0],H[1]);if(isNaN(l))return!0;g+=l}l=K.Qp(H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],f,a,e,a,.5);g+=l}null!==
H&&(m=H[6],n=H[7]);break;default:v("Unknown Segment type: "+H.type)}h=m;k=n}if(0!==g)return!0;g=0}else if(u.fa(e,a,d?b:b+2))return!0}return 0!==g};function Ue(a,b,c,d,e,f,g,h){if(K.Vb(e,f,g,h,.05,a,b))return NaN;var k=(a-c)*(f-h);if(0===k)return 0;var l=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/k;b=(a*d-b*c)*(f-h)/k;if(l>=a)return 0;if((e>g?e-g:g-e)<(f>h?f-h:h-f))if(f<h){if(b<f||b>h)return 0}else{if(b<h||b>f)return 0}else if(e<g){if(l<e||l>g)return 0}else if(l<g||l>e)return 0;return 0<k?1:-1}
function Ve(a,b,c,d){a=a.figures.j;for(var e=a.length,f=0;f<e;f++)if(a[f].fa(b,c,d))return!0;return!1}
t.hv=function(a,b){0>a?a=0:1<a&&(a=1);void 0===b&&(b=new J);if(this.type===te)return b.h(this.startX+a*(this.endX-this.startX),this.startY+a*(this.endY-this.startY)),b;for(var c=this.flattenedSegments,d=this.flattenedLengths,e=c.length,f=this.flattenedTotalLength*a,g=0,h=0;h<e;h++){var k=d[h],l=k.length;for(a=0;a<l;a++){var m=k[a];if(g+m>=f)return d=(f-g)/m,c=c[h],e=c[2*a],h=c[2*a+1],b.h(e+(c[2*a+2]-e)*d,h+(c[2*a+3]-h)*d),b;g+=m}}b.h(NaN,NaN);return b};
t.qx=function(a){if(this.type===te){var b=this.startX,c=this.startY,d=this.endX,e=this.endY;if(b!==d||c!==e){var f=a.x;a=a.y;if(b===d){if(c<e){var g=c;d=e}else g=e,d=c;return a<=g?g===c?0:1:a>=d?d===c?0:1:Math.abs(a-c)/(d-g)}return c===e?(b<d?g=b:(g=d,d=b),f<=g?g===b?0:1:f>=d?d===b?0:1:Math.abs(f-b)/(d-g)):((f-b)*(f-b)+(a-c)*(a-c))/((d-b)*(d-b)+(e-c)*(e-c))}}else if(this.type===xe){g=this.startX;var h=this.startY,k=this.endX;e=this.endY;if(g!==k||h!==e){b=k-g;c=e-h;f=2*b+2*c;d=a.x;a=a.y;d=Math.min(Math.max(d,
g),k);a=Math.min(Math.max(a,h),e);g=Math.abs(d-g);k=Math.abs(d-k);h=Math.abs(a-h);e=Math.abs(a-e);var l=Math.min(g,k,h,e);if(l===h)return d/f;if(l===k)return(b+a)/f;if(l===e)return(2*b+c-d)/f;if(l===g)return(2*b+2*c-a)/f}}else{b=this.flattenedSegments;c=this.flattenedLengths;f=this.flattenedTotalLength;d=J.alloc();e=Infinity;h=g=0;k=b.length;for(var m=l=0,n=0;n<k;n++)for(var p=b[n],q=c[n],r=p.length,u=0;u<r;u+=2){var y=p[u],x=p[u+1];if(0!==u){K.Ti(l,m,y,x,a.x,a.y,d);var A=(d.x-a.x)*(d.x-a.x)+(d.y-
a.y)*(d.y-a.y);A<e&&(e=A,g=h,g+=Math.sqrt((d.x-l)*(d.x-l)+(d.y-m)*(d.y-m)));h+=q[(u-2)/2]}l=y;m=x}J.free(d);a=g/f;return 0>a?0:1<a?1:a}return 0};
function We(a){if(null===a.zk){var b=a.zk=[],c=a.Rm=[],d=[],e=[];if(a.type===te)d.push(a.startX),d.push(a.startY),d.push(a.endX),d.push(a.endY),b.push(d),e.push(Math.sqrt((a.startX-a.endX)*(a.startX-a.endX)+(a.startY-a.endY)*(a.startY-a.endY))),c.push(e);else if(a.type===xe)d.push(a.startX),d.push(a.startY),d.push(a.endX),d.push(a.startY),d.push(a.endX),d.push(a.endY),d.push(a.startX),d.push(a.endY),d.push(a.startX),d.push(a.startY),b.push(d),e.push(Math.abs(a.startX-a.endX)),e.push(Math.abs(a.startY-
a.endY)),e.push(Math.abs(a.startX-a.endX)),e.push(Math.abs(a.startY-a.endY)),c.push(e);else if(a.type===ye){var f=new Xe;f.startX=a.endX;f.startY=(a.startY+a.endY)/2;var g=new Ye(Qe);g.startAngle=0;g.sweepAngle=360;g.centerX=(a.startX+a.endX)/2;g.centerY=(a.startY+a.endY)/2;g.radiusX=Math.abs(a.startX-a.endX)/2;g.radiusY=Math.abs(a.startY-a.endY)/2;f.add(g);a=Se(g,f);e=a.length;if(0===e)d.push(g.centerX),d.push(g.centerY);else{g=f.startX;f=f.startY;for(var h=0;h<e;h++){var k=a[h];K.Be(g,f,k[2],k[3],
k[4],k[5],k[6],k[7],.5,d);g=k[6];f=k[7]}}b.push(d);c.push(jf(d))}else for(a=a.figures.iterator;a.next();){e=a.value;d=[];d.push(e.startX);d.push(e.startY);g=e.startX;f=e.startY;h=g;k=f;for(var l=e.segments.j,m=l.length,n=0;n<m;n++){var p=l[n];switch(p.type){case Ne:4<=d.length&&(b.push(d),c.push(jf(d)));d=[];d.push(p.endX);d.push(p.endY);g=p.endX;f=p.endY;h=g;k=f;break;case ve:d.push(p.endX);d.push(p.endY);g=p.endX;f=p.endY;break;case Oe:K.Be(g,f,p.point1X,p.point1Y,p.point2X,p.point2Y,p.endX,p.endY,
.5,d);g=p.endX;f=p.endY;break;case Pe:K.oq(g,f,p.point1X,p.point1Y,p.endX,p.endY,.5,d);g=p.endX;f=p.endY;break;case Qe:var q=Se(p,e),r=q.length;if(0===r){d.push(p.centerX);d.push(p.centerY);g=p.centerX;f=p.centerY;break}for(var u=0;u<r;u++){var y=q[u];K.Be(g,f,y[2],y[3],y[4],y[5],y[6],y[7],.5,d);g=y[6];f=y[7]}break;case Re:q=Te(p,e,g,f);r=q.length;if(0===r){d.push(p.centerX);d.push(p.centerY);g=p.centerX;f=p.centerY;break}for(u=0;u<r;u++)y=q[u],K.Be(g,f,y[2],y[3],y[4],y[5],y[6],y[7],.5,d),g=y[6],
f=y[7];break;default:v("Segment not of valid type: "+p.type)}p.isClosed&&(d.push(h),d.push(k))}4<=d.length&&(b.push(d),c.push(jf(d)))}}}function jf(a){for(var b=[],c=0,d=0,e=a.length,f=0;f<e;f+=2){var g=a[f],h=a[f+1];0!==f&&(c=Math.sqrt(dc(c,d,g,h)),b.push(c));c=g;d=h}return b}t.add=function(a){this.ij.add(a);return this};t.Cm=function(a,b,c,d,e,f,g,h){this.u&&ya(this);this.ef=(new M(a,b,e,f)).freeze();this.ff=(new M(c,d,g,h)).freeze();return this};
na.Object.defineProperties(me.prototype,{flattenedSegments:{configurable:!0,get:function(){We(this);return this.zk}},flattenedLengths:{configurable:!0,get:function(){We(this);return this.Rm}},flattenedTotalLength:{configurable:!0,get:function(){var a=this.Sm;if(isNaN(a)){if(this.type===te){a=Math.abs(this.endX-this.startX);var b=Math.abs(this.endY-this.startY);a=Math.sqrt(a*a+b*b)}else if(this.type===xe)a=2*Math.abs(this.endX-this.startX)+2*Math.abs(this.endY-
this.startY);else{b=this.flattenedLengths;for(var c=b.length,d=a=0;d<c;d++)for(var e=b[d],f=e.length,g=0;g<f;g++)a+=e[g]}this.Sm=a}return a}},type:{configurable:!0,get:function(){return this.wa},set:function(a){this.wa!==a&&(E&&tb(a,me,me,"type"),this.u&&ya(this,a),this.wa=a,this.ta=!0)}},startX:{configurable:!0,get:function(){return this.cd},set:function(a){this.cd!==a&&(E&&B(a,me,"startX"),this.u&&ya(this,a),this.cd=a,this.ta=!0)}},startY:{configurable:!0,
get:function(){return this.dd},set:function(a){this.dd!==a&&(E&&B(a,me,"startY"),this.u&&ya(this,a),this.dd=a,this.ta=!0)}},endX:{configurable:!0,get:function(){return this.oc},set:function(a){this.oc!==a&&(E&&B(a,me,"endX"),this.u&&ya(this,a),this.oc=a,this.ta=!0)}},endY:{configurable:!0,get:function(){return this.Dc},set:function(a){this.Dc!==a&&(E&&B(a,me,"endY"),this.u&&ya(this,a),this.Dc=a,this.ta=!0)}},figures:{configurable:!0,get:function(){return this.ij},
set:function(a){this.ij!==a&&(E&&w(a,G,me,"figures"),this.u&&ya(this,a),this.ij=a,this.ta=!0)}},spot1:{configurable:!0,get:function(){return this.ef},set:function(a){E&&w(a,M,me,"spot1");this.u&&ya(this,a);this.ef=a.J()}},spot2:{configurable:!0,get:function(){return this.ff},set:function(a){E&&w(a,M,me,"spot2");this.u&&ya(this,a);this.ff=a.J()}},defaultStretch:{configurable:!0,get:function(){return this.Gf},set:function(a){E&&tb(a,N,me,"stretch");this.u&&
ya(this,a);this.Gf=a}},bounds:{configurable:!0,get:function(){this.pv()&&this.computeBounds();return this.Vq}}});me.prototype.setSpots=me.prototype.Cm;me.prototype.add=me.prototype.add;me.prototype.getFractionForPoint=me.prototype.qx;me.prototype.getPointAlongPath=me.prototype.hv;me.prototype.transform=me.prototype.transform;me.prototype.rotate=me.prototype.rotate;me.prototype.scale=me.prototype.scale;me.prototype.offset=me.prototype.offset;me.prototype.normalize=me.prototype.normalize;
me.prototype.computeBoundsWithoutOrigin=me.prototype.gx;me.prototype.equalsApprox=me.prototype.Sa;var te=new D(me,"Line",0),xe=new D(me,"Rectangle",1),ye=new D(me,"Ellipse",2),ne=new D(me,"Path",3);me.className="Geometry";me.stringify=we;me.fillPath=function(a){"string"!==typeof a&&Ba(a,"string",me,"fillPath:str");a=a.split(/[Xx]/);for(var b=a.length,c="",d=0;d<b;d++){var e=a[d];c=null!==e.match(/[Ff]/)?0===d?c+e:c+("X"+(" "===e[0]?"":" ")+e):c+((0===d?"":"X ")+"F"+(" "===e[0]?"":" ")+e)}return c};
me.parse=ze;me.Line=te;me.Rectangle=xe;me.Ellipse=ye;me.Path=ne;function Xe(a,b,c,d){qb(this);this.u=!1;void 0===c&&(c=!0);this.Dr=c;void 0===d&&(d=!0);this.Gr=d;void 0!==a?(E&&B(a,Xe,"sx"),this.cd=a):this.cd=0;void 0!==b?(E&&B(b,Xe,"sy"),this.dd=b):this.dd=0;this.El=new G;this.us=this.El.s;this.ta=!0}
Xe.prototype.copy=function(){var a=new Xe;a.Dr=this.Dr;a.Gr=this.Gr;a.cd=this.cd;a.dd=this.dd;for(var b=this.El.j,c=b.length,d=a.El,e=0;e<c;e++){var f=b[e].copy();d.add(f)}a.us=this.us;a.ta=this.ta;return a};t=Xe.prototype;t.Sa=function(a){if(!(a instanceof Xe&&K.B(this.startX,a.startX)&&K.B(this.startY,a.startY)))return!1;var b=this.segments.j;a=a.segments.j;var c=b.length;if(c!==a.length)return!1;for(var d=0;d<c;d++)if(!b[d].Sa(a[d]))return!1;return!0};
t.toString=function(a){void 0===a&&(a=-1);var b=0>a?"M"+this.startX.toString()+" "+this.startY.toString():"M"+this.startX.toFixed(a)+" "+this.startY.toFixed(a);for(var c=this.segments.j,d=c.length,e=0;e<d;e++)b+=" "+c[e].toString(a);return b};t.freeze=function(){this.u=!0;var a=this.segments;a.freeze();var b=a.j;a=a.length;for(var c=0;c<a;c++)b[c].freeze();return this};t.ja=function(){this.u=!1;var a=this.segments;a.ja();a=a.j;for(var b=a.length,c=0;c<b;c++)a[c].ja();return this};
t.pv=function(){if(this.ta)return!0;var a=this.segments;if(this.us!==a.s)return!0;a=a.j;for(var b=a.length,c=0;c<b;c++)if(a[c].ta)return!0;return!1};t.add=function(a){this.El.add(a);return this};
t.fa=function(a,b,c){for(var d=this.startX,e=this.startY,f=d,g=e,h=this.segments.j,k=h.length,l=0;l<k;l++){var m=h[l];switch(m.type){case Ne:f=m.endX;g=m.endY;d=m.endX;e=m.endY;break;case ve:if(K.Vb(d,e,m.endX,m.endY,c,a,b))return!0;d=m.endX;e=m.endY;break;case Oe:if(K.Ls(d,e,m.point1X,m.point1Y,m.point2X,m.point2Y,m.endX,m.endY,.5,a,b,c))return!0;d=m.endX;e=m.endY;break;case Pe:if(K.yv(d,e,m.point1X,m.point1Y,m.endX,m.endY,.5,a,b,c))return!0;d=m.endX;e=m.endY;break;case Qe:case Re:var n=m.type===
Qe?Se(m,this):Te(m,this,d,e),p=n.length;if(0===p){if(K.Vb(d,e,m.centerX,m.centerY,c,a,b))return!0;d=m.centerX;e=m.centerY;break}for(var q=null,r=0;r<p;r++)if(q=n[r],0===r&&K.Vb(d,e,q[0],q[1],c,a,b)||K.Ls(q[0],q[1],q[2],q[3],q[4],q[5],q[6],q[7],.5,a,b,c))return!0;null!==q&&(d=q[6],e=q[7]);break;default:v("Unknown Segment type: "+m.type)}if(m.isClosed&&(d!==f||e!==g)&&K.Vb(d,e,f,g,c,a,b))return!0}return!1};
na.Object.defineProperties(Xe.prototype,{isFilled:{configurable:!0,get:function(){return this.Dr},set:function(a){E&&z(a,"boolean",Xe,"isFilled");this.u&&ya(this,a);this.Dr=a}},isShadowed:{configurable:!0,get:function(){return this.Gr},set:function(a){E&&z(a,"boolean",Xe,"isShadowed");this.u&&ya(this,a);this.Gr=a}},startX:{configurable:!0,get:function(){return this.cd},set:function(a){E&&B(a,Xe,"startX");this.u&&ya(this,a);this.cd=a;this.ta=!0}},startY:{configurable:!0,
enumerable:!0,get:function(){return this.dd},set:function(a){E&&B(a,Xe,"startY");this.u&&ya(this,a);this.dd=a;this.ta=!0}},segments:{configurable:!0,get:function(){return this.El},set:function(a){E&&w(a,G,Xe,"segments");this.u&&ya(this,a);this.El=a;this.ta=!0}}});Xe.prototype.add=Xe.prototype.add;Xe.prototype.equalsApprox=Xe.prototype.Sa;Xe.className="PathFigure";
function Ye(a,b,c,d,e,f,g,h){qb(this);this.u=!1;void 0===a?a=ve:E&&tb(a,Ye,Ye,"constructor:type");this.wa=a;void 0!==b?(E&&B(b,Ye,"ex"),this.oc=b):this.oc=0;void 0!==c?(E&&B(c,Ye,"ey"),this.Dc=c):this.Dc=0;void 0===d&&(d=0);void 0===e&&(e=0);void 0===f&&(f=0);void 0===g&&(g=0);a===Re?(a=f%360,0>a&&(a+=360),this.ue=a,this.oi=0,E&&B(d,Ye,"x1"),this.pi=Math.max(d,0),E&&B(e,Ye,"y1"),this.$g=Math.max(e,0),this.ll="boolean"===typeof g?!!g:!1,this.Gk=!!h):(E&&B(d,Ye,"x1"),this.ue=d,E&&B(e,Ye,"y1"),this.oi=
e,E&&B(f,Ye,"x2"),a===Qe&&(f=Math.max(f,0)),this.pi=f,"number"===typeof g?(a===Qe&&(g=Math.max(g,0)),this.$g=g):this.$g=0,this.Gk=this.ll=!1);this.nj=!1;this.ta=!0;this.Le=null}Ye.prototype.copy=function(){var a=new Ye;a.wa=this.wa;a.oc=this.oc;a.Dc=this.Dc;a.ue=this.ue;a.oi=this.oi;a.pi=this.pi;a.$g=this.$g;a.ll=this.ll;a.Gk=this.Gk;a.nj=this.nj;a.ta=this.ta;return a};t=Ye.prototype;
t.Sa=function(a){if(!(a instanceof Ye)||this.type!==a.type||this.isClosed!==a.isClosed)return!1;switch(this.type){case Ne:case ve:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY);case Oe:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.point1X,a.point1X)&&K.B(this.point1Y,a.point1Y)&&K.B(this.point2X,a.point2X)&&K.B(this.point2Y,a.point2Y);case Pe:return K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.point1X,a.point1X)&&K.B(this.point1Y,a.point1Y);case Qe:return K.B(this.startAngle,
a.startAngle)&&K.B(this.sweepAngle,a.sweepAngle)&&K.B(this.centerX,a.centerX)&&K.B(this.centerY,a.centerY)&&K.B(this.radiusX,a.radiusX)&&K.B(this.radiusY,a.radiusY);case Re:return this.isClockwiseArc===a.isClockwiseArc&&this.isLargeArc===a.isLargeArc&&K.B(this.xAxisRotation,a.xAxisRotation)&&K.B(this.endX,a.endX)&&K.B(this.endY,a.endY)&&K.B(this.radiusX,a.radiusX)&&K.B(this.radiusY,a.radiusY);default:return!1}};t.hb=function(a){a.classType===Ye?this.type=a:Fa(this,a)};
t.toString=function(a){void 0===a&&(a=-1);switch(this.type){case Ne:a=0>a?"M"+this.endX.toString()+" "+this.endY.toString():"M"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case ve:a=0>a?"L"+this.endX.toString()+" "+this.endY.toString():"L"+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Oe:a=0>a?"C"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.point2X.toString()+" "+this.point2Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"C"+this.point1X.toFixed(a)+
" "+this.point1Y.toFixed(a)+" "+this.point2X.toFixed(a)+" "+this.point2Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Pe:a=0>a?"Q"+this.point1X.toString()+" "+this.point1Y.toString()+" "+this.endX.toString()+" "+this.endY.toString():"Q"+this.point1X.toFixed(a)+" "+this.point1Y.toFixed(a)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;case Qe:a=0>a?"B"+this.startAngle.toString()+" "+this.sweepAngle.toString()+" "+this.centerX.toString()+" "+this.centerY.toString()+
" "+this.radiusX.toString()+" "+this.radiusY.toString():"B"+this.startAngle.toFixed(a)+" "+this.sweepAngle.toFixed(a)+" "+this.centerX.toFixed(a)+" "+this.centerY.toFixed(a)+" "+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a);break;case Re:a=0>a?"A"+this.radiusX.toString()+" "+this.radiusY.toString()+" "+this.xAxisRotation.toString()+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toString()+" "+this.endY.toString():"A"+this.radiusX.toFixed(a)+" "+this.radiusY.toFixed(a)+
" "+this.xAxisRotation.toFixed(a)+" "+(this.isLargeArc?1:0)+" "+(this.isClockwiseArc?1:0)+" "+this.endX.toFixed(a)+" "+this.endY.toFixed(a);break;default:a=this.type.toString()}return a+(this.nj?"z":"")};t.freeze=function(){this.u=!0;return this};t.ja=function(){this.u=!1;return this};t.close=function(){this.nj=!0;return this};
function Se(a,b){if(null!==a.Le&&!1===b.ta)return a.Le;var c=a.radiusX,d=a.radiusY;void 0===d&&(d=c);if(0===c||0===d)return a.Le=[],a.Le;b=a.ue;var e=a.oi,f=K.hx(0,0,c<d?c:d,a.startAngle,a.startAngle+a.sweepAngle,!1);if(c!==d){var g=$b.alloc();g.reset();c<d?g.scale(1,d/c):g.scale(c/d,1);Le(f,g);$b.free(g)}c=f.length;for(d=0;d<c;d++)g=f[d],g[0]+=b,g[1]+=e,g[2]+=b,g[3]+=e,g[4]+=b,g[5]+=e,g[6]+=b,g[7]+=e;a.Le=f;return a.Le}
function Te(a,b,c,d){function e(a,b,c,d){return(a*d<b*c?-1:1)*Math.acos((a*c+b*d)/(Math.sqrt(a*a+b*b)*Math.sqrt(c*c+d*d)))}if(null!==a.Le&&!1===b.ta)return a.Le;b=a.pi;var f=a.$g;0===b&&(b=1E-4);0===f&&(f=1E-4);var g=Math.PI/180*a.ue,h=a.ll,k=a.Gk,l=a.oc,m=a.Dc,n=Math.cos(g),p=Math.sin(g),q=n*(c-l)/2+p*(d-m)/2;g=-p*(c-l)/2+n*(d-m)/2;var r=q*q/(b*b)+g*g/(f*f);1<r&&(b*=Math.sqrt(r),f*=Math.sqrt(r));r=(h===k?-1:1)*Math.sqrt((b*b*f*f-b*b*g*g-f*f*q*q)/(b*b*g*g+f*f*q*q));isNaN(r)&&(r=0);h=r*b*g/f;r=r*-f*
q/b;isNaN(h)&&(h=0);isNaN(r)&&(r=0);c=(c+l)/2+n*h-p*r;d=(d+m)/2+p*h+n*r;m=e(1,0,(q-h)/b,(g-r)/f);n=(q-h)/b;l=(g-r)/f;q=(-q-h)/b;h=(-g-r)/f;g=e(n,l,q,h);q=(n*q+l*h)/(Math.sqrt(n*n+l*l)*Math.sqrt(q*q+h*h));-1>=q?g=Math.PI:1<=q&&(g=0);!k&&0<g&&(g-=2*Math.PI);k&&0>g&&(g+=2*Math.PI);k=b>f?1:b/f;q=b>f?f/b:1;b=K.hx(0,0,b>f?b:f,m,m+g,!0);f=$b.alloc();f.reset();f.translate(c,d);f.rotate(a.ue,0,0);f.scale(k,q);Le(b,f);$b.free(f);a.Le=b;return a.Le}
na.Object.defineProperties(Ye.prototype,{isClosed:{configurable:!0,get:function(){return this.nj},set:function(a){this.nj!==a&&(this.nj=a,this.ta=!0)}},type:{configurable:!0,get:function(){return this.wa},set:function(a){E&&tb(a,Ye,Ye,"type");this.u&&ya(this,a);this.wa=a;this.ta=!0}},endX:{configurable:!0,get:function(){return this.oc},set:function(a){E&&B(a,Ye,"endX");this.u&&ya(this,a);this.oc=a;this.ta=!0}},endY:{configurable:!0,get:function(){return this.Dc},
set:function(a){E&&B(a,Ye,"endY");this.u&&ya(this,a);this.Dc=a;this.ta=!0}},point1X:{configurable:!0,get:function(){return this.ue},set:function(a){E&&B(a,Ye,"point1X");this.u&&ya(this,a);this.ue=a;this.ta=!0}},point1Y:{configurable:!0,get:function(){return this.oi},set:function(a){E&&B(a,Ye,"point1Y");this.u&&ya(this,a);this.oi=a;this.ta=!0}},point2X:{configurable:!0,get:function(){return this.pi},set:function(a){E&&B(a,Ye,"point2X");this.u&&ya(this,a);this.pi=
a;this.ta=!0}},point2Y:{configurable:!0,get:function(){return this.$g},set:function(a){E&&B(a,Ye,"point2Y");this.u&&ya(this,a);this.$g=a;this.ta=!0}},centerX:{configurable:!0,get:function(){return this.ue},set:function(a){E&&B(a,Ye,"centerX");this.u&&ya(this,a);this.ue=a;this.ta=!0}},centerY:{configurable:!0,get:function(){return this.oi},set:function(a){E&&B(a,Ye,"centerY");this.u&&ya(this,a);this.oi=a;this.ta=!0}},radiusX:{configurable:!0,
get:function(){return this.pi},set:function(a){E&&B(a,Ye,"radiusX");0>a&&Ca(a,">= zero",Ye,"radiusX");this.u&&ya(this,a);this.pi=a;this.ta=!0}},radiusY:{configurable:!0,get:function(){return this.$g},set:function(a){E&&B(a,Ye,"radiusY");0>a&&Ca(a,">= zero",Ye,"radiusY");this.u&&ya(this,a);this.$g=a;this.ta=!0}},startAngle:{configurable:!0,get:function(){return this.oc},set:function(a){this.oc!==a&&(this.u&&ya(this,a),E&&B(a,Ye,"startAngle"),a%=360,0>a&&(a+=360),this.oc=
a,this.ta=!0)}},sweepAngle:{configurable:!0,get:function(){return this.Dc},set:function(a){E&&B(a,Ye,"sweepAngle");this.u&&ya(this,a);360<a&&(a=360);-360>a&&(a=-360);this.Dc=a;this.ta=!0}},isClockwiseArc:{configurable:!0,get:function(){return this.Gk},set:function(a){this.u&&ya(this,a);this.Gk=a;this.ta=!0}},isLargeArc:{configurable:!0,get:function(){return this.ll},set:function(a){this.u&&ya(this,a);this.ll=a;this.ta=!0}},xAxisRotation:{configurable:!0,
get:function(){return this.ue},set:function(a){E&&B(a,Ye,"xAxisRotation");a%=360;0>a&&(a+=360);this.u&&ya(this,a);this.ue=a;this.ta=!0}}});Ye.prototype.equalsApprox=Ye.prototype.Sa;var Ne=new D(Ye,"Move",0),ve=new D(Ye,"Line",1),Oe=new D(Ye,"Bezier",2),Pe=new D(Ye,"QuadraticBezier",3),Qe=new D(Ye,"Arc",4),Re=new D(Ye,"SvgArc",4);Ye.className="PathSegment";Ye.Move=Ne;Ye.Line=ve;Ye.Bezier=Oe;Ye.QuadraticBezier=Pe;Ye.Arc=Qe;Ye.SvgArc=Re;
function kf(){this.G=null;this.Hu=(new J(0,0)).freeze();this.Xt=(new J(0,0)).freeze();this.Oq=this.Vr=0;this.Pq=1;this.Kr="";this.Gs=this.fr=!1;this.er=this.Rq=0;this.Dg=this.sr=this.Er=!1;this.lr=null;this.Es=0;this.Rd=this.Ds=null}kf.prototype.copy=function(){var a=new kf;return this.clone(a)};
kf.prototype.clone=function(a){a.G=this.G;a.Hu.assign(this.viewPoint);a.Xt.assign(this.documentPoint);a.Vr=this.Vr;a.Oq=this.Oq;a.Pq=this.Pq;a.Kr=this.Kr;a.fr=this.fr;a.Gs=this.Gs;a.Rq=this.Rq;a.er=this.er;a.Er=this.Er;a.sr=this.sr;a.Dg=this.Dg;a.lr=this.lr;a.Es=this.Es;a.Ds=this.Ds;a.Rd=this.Rd;return a};
kf.prototype.toString=function(){var a="^";0!==this.modifiers&&(a+="M:"+this.modifiers);0!==this.button&&(a+="B:"+this.button);""!==this.key&&(a+="K:"+this.key);0!==this.clickCount&&(a+="C:"+this.clickCount);0!==this.delta&&(a+="D:"+this.delta);this.handled&&(a+="h");this.bubbles&&(a+="b");null!==this.documentPoint&&(a+="@"+this.documentPoint.toString());return a};kf.prototype.$p=function(a,b){var c=this.diagram;if(null===c)return b;lf(c,this.event,a,b);return b};
kf.prototype.lz=function(a,b){var c=this.diagram;if(null===c)return b;lf(c,this.event,a,b);b.assign(c.Dt(b));return b};
na.Object.defineProperties(kf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},viewPoint:{configurable:!0,get:function(){return this.Hu},set:function(a){w(a,J,kf,"viewPoint");this.Hu.assign(a)}},documentPoint:{configurable:!0,get:function(){return this.Xt},set:function(a){w(a,J,kf,"documentPoint");this.Xt.assign(a)}},modifiers:{configurable:!0,get:function(){return this.Vr},set:function(a){this.Vr=
a}},button:{configurable:!0,get:function(){return this.Oq},set:function(a){this.Oq=a;if(null===this.event)switch(a){case 0:this.buttons=1;break;case 1:this.buttons=4;break;case 2:this.buttons=2}}},buttons:{configurable:!0,get:function(){return this.Pq},set:function(a){this.Pq=a}},key:{configurable:!0,get:function(){return this.Kr},set:function(a){this.Kr=a}},down:{configurable:!0,get:function(){return this.fr},set:function(a){this.fr=a}},up:{configurable:!0,
enumerable:!0,get:function(){return this.Gs},set:function(a){this.Gs=a}},clickCount:{configurable:!0,get:function(){return this.Rq},set:function(a){this.Rq=a}},delta:{configurable:!0,get:function(){return this.er},set:function(a){this.er=a}},isMultiTouch:{configurable:!0,get:function(){return this.Er},set:function(a){this.Er=a}},handled:{configurable:!0,get:function(){return this.sr},set:function(a){this.sr=a}},bubbles:{configurable:!0,
get:function(){return this.Dg},set:function(a){this.Dg=a}},event:{configurable:!0,get:function(){return this.lr},set:function(a){this.lr=a}},isTouchEvent:{configurable:!0,get:function(){var a=qa.TouchEvent,b=this.event;return a&&b instanceof a?!0:(a=qa.PointerEvent)&&b instanceof a&&("touch"===b.pointerType||"pen"===b.pointerType)}},timestamp:{configurable:!0,get:function(){return this.Es},set:function(a){this.Es=a}},targetDiagram:{configurable:!0,
get:function(){return this.Ds},set:function(a){this.Ds=a}},targetObject:{configurable:!0,get:function(){return this.Rd},set:function(a){this.Rd=a}},control:{configurable:!0,get:function(){return 0!==(this.modifiers&1)},set:function(a){this.modifiers=a?this.modifiers|1:this.modifiers&-2}},shift:{configurable:!0,get:function(){return 0!==(this.modifiers&4)},set:function(a){this.modifiers=a?this.modifiers|4:this.modifiers&-5}},alt:{configurable:!0,
get:function(){return 0!==(this.modifiers&2)},set:function(a){this.modifiers=a?this.modifiers|2:this.modifiers&-3}},meta:{configurable:!0,get:function(){return 0!==(this.modifiers&8)},set:function(a){this.modifiers=a?this.modifiers|8:this.modifiers&-9}},left:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&1):0===this.button},set:function(a){this.buttons=
a?this.buttons|1:this.buttons&-2}},right:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&2):2===this.button},set:function(a){this.buttons=a?this.buttons|2:this.buttons&-3}},middle:{configurable:!0,get:function(){var a=this.event;return null===a||"mousedown"!==a.type&&"mouseup"!==a.type&&"pointerdown"!==a.type&&"pointerup"!==a.type?0!==(this.buttons&
4):1===this.button},set:function(a){this.buttons=a?this.buttons|4:this.buttons&-5}}});kf.prototype.getMultiTouchDocumentPoint=kf.prototype.lz;kf.prototype.getMultiTouchViewPoint=kf.prototype.$p;kf.className="InputEvent";function mf(){this.G=null;this.Wa="";this.fs=this.Bs=null}mf.prototype.copy=function(){var a=new mf;a.G=this.G;a.Wa=this.Wa;a.Bs=this.Bs;a.fs=this.fs;return a};
mf.prototype.toString=function(){var a="*"+this.name;null!==this.subject&&(a+=":"+this.subject.toString());null!==this.parameter&&(a+="("+this.parameter.toString()+")");return a};
na.Object.defineProperties(mf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},name:{configurable:!0,get:function(){return this.Wa},set:function(a){this.Wa=a}},subject:{configurable:!0,get:function(){return this.Bs},set:function(a){this.Bs=a}},parameter:{configurable:!0,get:function(){return this.fs},set:function(a){this.fs=a}}});mf.className="DiagramEvent";
function nf(){this.Zm=of;this.Fj=this.Ur="";this.Co=this.Do=this.Io=this.Jo=this.Ho=this.G=this.ac=null}nf.prototype.clear=function(){this.Co=this.Do=this.Io=this.Jo=this.Ho=this.G=this.ac=null};
nf.prototype.copy=function(){var a=new nf;a.Zm=this.Zm;a.Ur=this.Ur;a.Fj=this.Fj;a.ac=this.ac;a.G=this.G;a.Ho=this.Ho;var b=this.Jo;a.Jo=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Io;a.Io=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Do;a.Do=Ia(b)&&"function"===typeof b.J?b.J():b;b=this.Co;a.Co=Ia(b)&&"function"===typeof b.J?b.J():b;return a};nf.prototype.hb=function(a){a.classType===nf?this.change=a:Fa(this,a)};
nf.prototype.toString=function(){var a="";a=this.change===pf?a+"* ":this.change===of?a+(null!==this.model?"!m":"!d"):a+((null!==this.model?"!m":"!d")+this.change);this.propertyName&&"string"===typeof this.propertyName&&(a+=" "+this.propertyName);this.modelChange&&this.modelChange!==this.propertyName&&(a+=" "+this.modelChange);a+=": ";this.change===pf?null!==this.oldValue&&(a+=" "+this.oldValue):(null!==this.object&&(a+=Wa(this.object)),null!==this.oldValue&&(a+="  old: "+Wa(this.oldValue)),null!==
this.oldParam&&(a+=" "+this.oldParam),null!==this.newValue&&(a+="  new: "+Wa(this.newValue)),null!==this.newParam&&(a+=" "+this.newParam));return a};nf.prototype.K=function(a){return a?this.oldValue:this.newValue};nf.prototype.nz=function(a){return a?this.oldParam:this.newParam};nf.prototype.canUndo=function(){return null!==this.model||null!==this.diagram?!0:!1};nf.prototype.undo=function(){this.canUndo()&&(null!==this.model?this.model.Sj(this,!0):null!==this.diagram&&this.diagram.Sj(this,!0))};
nf.prototype.canRedo=function(){return null!==this.model||null!==this.diagram?!0:!1};nf.prototype.redo=function(){this.canRedo()&&(null!==this.model?this.model.Sj(this,!1):null!==this.diagram&&this.diagram.Sj(this,!1))};
na.Object.defineProperties(nf.prototype,{model:{configurable:!0,get:function(){return this.ac},set:function(a){this.ac=a}},diagram:{configurable:!0,get:function(){return this.G},set:function(a){this.G=a}},change:{configurable:!0,get:function(){return this.Zm},set:function(a){E&&tb(a,nf,nf,"change");this.Zm=a}},modelChange:{configurable:!0,get:function(){return this.Ur},set:function(a){E&&z(a,"string",nf,"modelChange");this.Ur=a}},propertyName:{configurable:!0,
enumerable:!0,get:function(){return this.Fj},set:function(a){E&&"string"!==typeof a&&z(a,"function",nf,"propertyName");this.Fj=a}},isTransactionFinished:{configurable:!0,get:function(){return this.Zm===pf&&("CommittedTransaction"===this.Fj||"FinishedUndo"===this.Fj||"FinishedRedo"===this.Fj)}},object:{configurable:!0,get:function(){return this.Ho},set:function(a){this.Ho=a}},oldValue:{configurable:!0,get:function(){return this.Jo},set:function(a){this.Jo=
a}},oldParam:{configurable:!0,get:function(){return this.Io},set:function(a){this.Io=a}},newValue:{configurable:!0,get:function(){return this.Do},set:function(a){this.Do=a}},newParam:{configurable:!0,get:function(){return this.Co},set:function(a){this.Co=a}}});nf.prototype.redo=nf.prototype.redo;nf.prototype.canRedo=nf.prototype.canRedo;nf.prototype.undo=nf.prototype.undo;nf.prototype.canUndo=nf.prototype.canUndo;nf.prototype.getParam=nf.prototype.nz;
nf.prototype.getValue=nf.prototype.K;nf.prototype.clear=nf.prototype.clear;var pf=new D(nf,"Transaction",-1),of=new D(nf,"Property",0),qf=new D(nf,"Insert",1),rf=new D(nf,"Remove",2);nf.className="ChangedEvent";nf.Transaction=pf;nf.Property=of;nf.Insert=qf;nf.Remove=rf;function sf(){this.w=(new G).freeze();this.Wa="";this.l=!1}
sf.prototype.toString=function(a){var b="Transaction: "+this.name+" "+this.changes.count.toString()+(this.isComplete?"":", incomplete");if(void 0!==a&&0<a){a=this.changes.count;for(var c=0;c<a;c++){var d=this.changes.O(c);null!==d&&(b+="\n  "+d.toString())}}return b};sf.prototype.clear=function(){var a=this.changes;a.ja();for(var b=a.count-1;0<=b;b--){var c=a.O(b);null!==c&&c.clear()}a.clear();a.freeze()};sf.prototype.canUndo=function(){return this.isComplete};
sf.prototype.undo=function(){if(this.canUndo())for(var a=this.changes.count-1;0<=a;a--){var b=this.changes.O(a);null!==b&&b.undo()}};sf.prototype.canRedo=function(){return this.isComplete};sf.prototype.redo=function(){if(this.canRedo())for(var a=this.changes.count,b=0;b<a;b++){var c=this.changes.O(b);null!==c&&c.redo()}};
na.Object.defineProperties(sf.prototype,{changes:{configurable:!0,get:function(){return this.w}},name:{configurable:!0,get:function(){return this.Wa},set:function(a){this.Wa=a}},isComplete:{configurable:!0,get:function(){return this.l},set:function(a){this.l=a}}});sf.prototype.redo=sf.prototype.redo;sf.prototype.canRedo=sf.prototype.canRedo;sf.prototype.undo=sf.prototype.undo;sf.prototype.canUndo=sf.prototype.canUndo;sf.prototype.clear=sf.prototype.clear;
sf.className="Transaction";function tf(){this.ou=new I;this.Fc=!1;this.L=(new G).freeze();this.he=-1;this.w=999;this.ke=!1;this.cr=null;this.Ai=0;this.l=!1;E&&(this.l=!0);this.re=(new G).freeze();this.vl=new G;this.du=!0;this.hu=!1}
tf.prototype.toString=function(a){var b="UndoManager "+this.historyIndex+"<"+this.history.count+"<="+this.maxHistoryLength;b+="[";for(var c=this.nestedTransactionNames.count,d=0;d<c;d++)0<d&&(b+=" "),b+=this.nestedTransactionNames.O(d);b+="]";if(void 0!==a&&0<a)for(c=this.history.count,d=0;d<c;d++)b+="\n "+this.history.O(d).toString(a-1);return b};
tf.prototype.clear=function(){var a=this.history;a.ja();for(var b=a.count-1;0<=b;b--){var c=a.O(b);null!==c&&c.clear()}a.clear();this.he=-1;a.freeze();this.ke=!1;this.cr=null;this.Ai=0;this.re.ja();this.re.clear();this.re.freeze();this.vl.clear()};tf.prototype.copyProperties=function(a){this.isEnabled=a.isEnabled;this.maxHistoryLength=a.maxHistoryLength;this.checksTransactionLevel=a.checksTransactionLevel};t=tf.prototype;t.Xw=function(a){this.ou.add(a)};t.Gx=function(a){this.ou.remove(a)};
t.Ca=function(a){void 0===a&&(a="");null===a&&(a="");if(this.isUndoingRedoing)return!1;!0===this.du&&(this.du=!1,this.Ai++,this.zb("StartingFirstTransaction",a,this.currentTransaction),0<this.Ai&&this.Ai--);this.isEnabled&&(this.re.ja(),this.re.add(a),this.re.freeze(),null===this.currentTransaction?this.vl.add(0):this.vl.add(this.currentTransaction.changes.count));this.Ai++;var b=1===this.transactionLevel;b&&this.zb("StartedTransaction",a,this.currentTransaction);return b};
t.ab=function(a){void 0===a&&(a="");return uf(this,!0,a)};t.xf=function(){return uf(this,!1,"")};
function uf(a,b,c){if(a.isUndoingRedoing)return!1;a.checksTransactionLevel&&1>a.transactionLevel&&Ga("Ending transaction without having started a transaction: "+c);var d=1===a.transactionLevel;d&&b&&a.zb("CommittingTransaction",c,a.currentTransaction);var e=0;if(0<a.transactionLevel&&(a.Ai--,a.isEnabled)){var f=a.re.count;0<f&&(""===c&&(c=a.re.O(0)),a.re.ja(),a.re.nb(f-1),a.re.freeze());f=a.vl.count;0<f&&(e=a.vl.O(f-1),a.vl.nb(f-1))}f=a.currentTransaction;if(d){if(b){a.hu=!1;if(a.isEnabled&&null!==
f){b=f;b.isComplete=!0;b.name=c;d=a.history;d.ja();for(e=d.count-1;e>a.historyIndex;e--)f=d.O(e),null!==f&&f.clear(),d.nb(e),a.hu=!0;e=a.maxHistoryLength;0<=e&&(0===e?d.clear():d.count>=e&&(f=d.O(0),null!==f&&f.clear(),d.nb(0),a.he--));0!==e&&(d.add(b),a.he++);d.freeze();f=b}a.zb("CommittedTransaction",c,f)}else{a.ke=!0;try{a.isEnabled&&null!==f&&(f.isComplete=!0,f.undo())}finally{a.zb("RolledBackTransaction",c,f),a.ke=!1}null!==f&&f.clear()}a.cr=null;return!0}if(a.isEnabled&&!b&&null!==f){a=e;c=
f.changes;for(b=c.count-1;b>=a;b--)d=c.O(b),null!==d&&d.undo(),c.ja(),c.nb(b);c.freeze()}return!1}tf.prototype.canUndo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToUndo;return null!==a&&a.canUndo()?!0:!1};tf.prototype.undo=function(){if(this.canUndo()){var a=this.transactionToUndo;try{this.ke=!0,this.zb("StartingUndo","Undo",a),this.he--,a.undo()}catch(b){Ga("undo error: "+b.toString())}finally{this.zb("FinishedUndo","Undo",a),this.ke=!1}}};
tf.prototype.canRedo=function(){if(!this.isEnabled||0<this.transactionLevel)return!1;var a=this.transactionToRedo;return null!==a&&a.canRedo()?!0:!1};tf.prototype.redo=function(){if(this.canRedo()){var a=this.transactionToRedo;try{this.ke=!0,this.zb("StartingRedo","Redo",a),this.he++,a.redo()}catch(b){Ga("redo error: "+b.toString())}finally{this.zb("FinishedRedo","Redo",a),this.ke=!1}}};
tf.prototype.zb=function(a,b,c){void 0===c&&(c=null);var d=new nf;d.change=pf;d.propertyName=a;d.object=c;d.oldValue=b;for(a=this.models;a.next();)b=a.value,d.model=b,b.Ms(d)};
tf.prototype.kv=function(a){if(this.isEnabled&&!this.isUndoingRedoing&&!this.skipsEvent(a)){var b=this.currentTransaction;null===b&&(this.cr=b=new sf);var c=a.copy();b=b.changes;b.ja();b.add(c);b.freeze();this.checksTransactionLevel&&0>=this.transactionLevel&&!this.du&&(a=a.diagram,null!==a&&!1===a.Ri||Ga("Change not within a transaction: "+c.toString()))}};
tf.prototype.skipsEvent=function(a){if(null===a||0>a.change.value)return!0;a=a.object;if(void 0!==a.layer){if(a=a.layer,null!==a&&a.isTemporary)return!0}else if(a.isTemporary)return!0;return!1};
na.Object.defineProperties(tf.prototype,{models:{configurable:!0,get:function(){return this.ou.iterator}},isEnabled:{configurable:!0,get:function(){return this.Fc},set:function(a){this.Fc=a}},transactionToUndo:{configurable:!0,get:function(){return 0<=this.historyIndex&&this.historyIndex<=this.history.count-1?this.history.O(this.historyIndex):null}},transactionToRedo:{configurable:!0,get:function(){return this.historyIndex<this.history.count-
1?this.history.O(this.historyIndex+1):null}},isUndoingRedoing:{configurable:!0,get:function(){return this.ke}},history:{configurable:!0,get:function(){return this.L}},maxHistoryLength:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},historyIndex:{configurable:!0,get:function(){return this.he}},currentTransaction:{configurable:!0,get:function(){return this.cr}},transactionLevel:{configurable:!0,
get:function(){return this.Ai}},isInTransaction:{configurable:!0,get:function(){return 0<this.Ai}},checksTransactionLevel:{configurable:!0,get:function(){return this.l},set:function(a){this.l=a}},nestedTransactionNames:{configurable:!0,get:function(){return this.re}}});tf.prototype.handleChanged=tf.prototype.kv;tf.prototype.redo=tf.prototype.redo;tf.prototype.undo=tf.prototype.undo;tf.prototype.canUndo=tf.prototype.canUndo;
tf.prototype.rollbackTransaction=tf.prototype.xf;tf.prototype.commitTransaction=tf.prototype.ab;tf.prototype.startTransaction=tf.prototype.Ca;tf.prototype.removeModel=tf.prototype.Gx;tf.prototype.addModel=tf.prototype.Xw;tf.prototype.clear=tf.prototype.clear;tf.className="UndoManager";function vf(){0<arguments.length&&Da(vf);qb(this);this.G=yf;this.Wa="";this.Fc=!0;this.Wb=!1;this.iw=null;this.iy=new kf;this.Js=-1}vf.prototype.ib=function(a){this.G=a};
vf.prototype.toString=function(){return""!==this.name?this.name+" Tool":Va(this.constructor)};vf.prototype.updateAdornments=function(){};vf.prototype.canStart=function(){return this.isEnabled};vf.prototype.doStart=function(){};vf.prototype.doActivate=function(){this.isActive=!0};vf.prototype.doDeactivate=function(){this.isActive=!1};vf.prototype.doStop=function(){};vf.prototype.doCancel=function(){this.transactionResult=null;this.stopTool()};
vf.prototype.stopTool=function(){var a=this.diagram;a.currentTool===this&&(a.currentTool=null,a.currentCursor="")};vf.prototype.doMouseDown=function(){!this.isActive&&this.canStart()&&this.doActivate()};vf.prototype.doMouseMove=function(){};vf.prototype.doMouseUp=function(){this.stopTool()};vf.prototype.doMouseWheel=function(){};vf.prototype.canStartMultiTouch=function(){return!0};
vf.prototype.standardPinchZoomStart=function(){var a=this.diagram,b=a.lastInput,c=b.$p(0,J.allocAt(NaN,NaN)),d=b.$p(1,J.allocAt(NaN,NaN));if(c.o()&&d.o()&&(this.doCancel(),a.fm("hasGestureZoom"))){a.Ko=a.scale;var e=d.x-c.x,f=d.y-c.y;a.Nw=Math.sqrt(e*e+f*f);b.bubbles=!1}J.free(c);J.free(d)};
vf.prototype.standardPinchZoomMove=function(){var a=this.diagram,b=a.lastInput,c=b.$p(0,J.allocAt(NaN,NaN)),d=b.$p(1,J.allocAt(NaN,NaN));if(c.o()&&d.o()&&(this.doCancel(),a.fm("hasGestureZoom"))){var e=d.x-c.x,f=d.y-c.y;f=Math.sqrt(e*e+f*f)/a.Nw;e=new J((Math.min(d.x,c.x)+Math.max(d.x,c.x))/2,(Math.min(d.y,c.y)+Math.max(d.y,c.y))/2);f*=a.Ko;var g=a.commandHandler;if(f!==a.scale&&g.canResetZoom(f)){var h=a.zoomPoint;a.zoomPoint=e;g.resetZoom(f);a.zoomPoint=h}b.bubbles=!1}J.free(c);J.free(d)};
vf.prototype.doKeyDown=function(){"Esc"===this.diagram.lastInput.key&&this.doCancel()};vf.prototype.doKeyUp=function(){};vf.prototype.Ca=function(a){void 0===a&&(a=this.name);this.transactionResult=null;return this.diagram.Ca(a)};vf.prototype.yg=function(){var a=this.diagram;return null===this.transactionResult?a.xf():a.ab(this.transactionResult)};
vf.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.lastInput,c=a.dm(b.documentPoint,!1);if(null!==c)if(kb?b.meta:b.control){a.ba("ChangingSelection",a.selection);for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!b.isSelected);a.ba("ChangedSelection",a.selection)}else if(b.shift){if(!c.isSelected){a.ba("ChangingSelection",a.selection);for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&(b.isSelected=!0);a.ba("ChangedSelection",
a.selection)}}else{if(!c.isSelected){for(b=c;null!==b&&!b.canSelect();)b=b.containingGroup;null!==b&&a.select(b)}}else!b.left||(kb?b.meta:b.control)||b.shift||a.Ns()}};vf.prototype.standardMouseClick=function(a,b){void 0===a&&(a=null);void 0===b&&(b=function(a){return!a.layer.isTemporary});var c=this.diagram,d=c.lastInput;a=c.Tb(d.documentPoint,a,b);d.targetObject=a;zf(a,d,c);return d.handled};
function zf(a,b,c){b.handled=!1;if(null===a||a.ug()){var d=0;b.left?d=1===b.clickCount?1:2===b.clickCount?2:1:b.right&&1===b.clickCount&&(d=3);var e="ObjectSingleClicked";if(null!==a){switch(d){case 1:e="ObjectSingleClicked";break;case 2:e="ObjectDoubleClicked";break;case 3:e="ObjectContextClicked"}0!==d&&c.ba(e,a)}else{switch(d){case 1:e="BackgroundSingleClicked";break;case 2:e="BackgroundDoubleClicked";break;case 3:e="BackgroundContextClicked"}0!==d&&c.ba(e)}if(null!==a)for(;null!==a;){c=null;switch(d){case 1:c=
a.click;break;case 2:c=a.doubleClick?a.doubleClick:a.click;break;case 3:c=a.contextClick}if(null!==c&&(c(b,a),b.handled))break;a=a.panel}else{a=null;switch(d){case 1:a=c.click;break;case 2:a=c.doubleClick?c.doubleClick:c.click;break;case 3:a=c.contextClick}null!==a&&a(b)}}}
vf.prototype.standardMouseOver=function(){var a=this.diagram,b=a.lastInput;if(!0!==a.animationManager.sb){var c=a.skipsUndoManager;a.skipsUndoManager=!0;var d=a.je?a.Tb(b.documentPoint,null,null):null;b.targetObject=d;var e=!1;if(d!==a.Lk){var f=a.Lk,g=f;a.Lk=d;this.doCurrentObjectChanged(f,d);for(b.handled=!1;null!==f;){var h=f.mouseLeave;if(null!==h){if(d===f)break;if(null!==d&&d.tg(f))break;h(b,f,d);e=!0;if(b.handled)break}f=f.panel}f=g;for(b.handled=!1;null!==d;){g=d.mouseEnter;if(null!==g){if(f===
d)break;if(null!==f&&f.tg(d))break;g(b,d,f);e=!0;if(b.handled)break}d=d.panel}d=a.Lk}if(null!==d){f=d;for(g="";null!==f;){g=f.cursor;if(""!==g)break;f=f.panel}a.currentCursor=g;b.handled=!1;for(f=d;null!==f;){d=f.mouseOver;if(null!==d&&(d(b,f),e=!0,b.handled))break;f=f.panel}}else a.currentCursor="",d=a.mouseOver,null!==d&&(d(b),e=!0);e&&a.ec();a.skipsUndoManager=c}};vf.prototype.doCurrentObjectChanged=function(){};
vf.prototype.standardMouseWheel=function(){var a=this.diagram,b=a.lastInput,c=b.delta;if(0!==c&&a.documentBounds.o()){var d=a.commandHandler,e=a.toolManager.mouseWheelBehavior;if(null!==d&&(e===Af&&!b.shift||e===Bf&&b.control)&&(0<c?d.canIncreaseZoom():d.canDecreaseZoom()))e=a.zoomPoint,a.zoomPoint=b.viewPoint,0<c?d.increaseZoom():d.decreaseZoom(),a.zoomPoint=e,b.bubbles=!1;else if(e===Af&&b.shift||e===Bf&&!b.control){d=a.position.copy();var f=0<c?c:-c,g=b.event,h=g.deltaMode;e=g.deltaX;g=g.deltaY;
if(gb||ib||jb)h=1,0<e&&(e=3),0>e&&(e=-3),0<g&&(g=3),0>g&&(g=-3);if(void 0===h||void 0===e||void 0===g||0===e&&0===g||b.shift)!b.shift&&a.allowVerticalScroll?(f=3*f*a.scrollVerticalLineChange,0<c?a.scroll("pixel","up",f):a.scroll("pixel","down",f)):b.shift&&a.allowHorizontalScroll&&(f=3*f*a.scrollHorizontalLineChange,0<c?a.scroll("pixel","left",f):a.scroll("pixel","right",f));else{switch(h){case 0:c="pixel";break;case 1:c="line";break;case 2:c="page";break;default:c="pixel"}0!==e&&a.allowHorizontalScroll&&
(0<e?a.scroll(c,"left",-e):a.scroll(c,"right",e));0!==g&&a.allowVerticalScroll&&(0<g?a.scroll(c,"up",-g):a.scroll(c,"down",g))}a.position.A(d)||(b.bubbles=!1)}}};vf.prototype.standardWaitAfter=function(a,b){E&&z(a,"number",vf,"standardWaitAfter:delay");void 0===b&&(b=this.diagram.lastInput);this.cancelWaitAfter();var c=this,d=b.clone(this.iy);this.Js=wa(function(){c.doWaitAfter(d)},a)};vf.prototype.cancelWaitAfter=function(){-1!==this.Js&&qa.clearTimeout(this.Js);this.Js=-1};
vf.prototype.doWaitAfter=function(){};vf.prototype.findToolHandleAt=function(a,b){a=this.diagram.Tb(a,function(a){for(;null!==a&&!(a.panel instanceof Cf);)a=a.panel;return a});return null===a?null:a.part.category===b?a:null};vf.prototype.isBeyondDragSize=function(a,b){var c=this.diagram;void 0===a&&(a=c.firstInput.viewPoint);void 0===b&&(b=c.lastInput.viewPoint);var d=c.toolManager.dragSize,e=d.width;d=d.height;c.firstInput.isTouchEvent&&(e+=6,d+=6);return Math.abs(b.x-a.x)>e||Math.abs(b.y-a.y)>d};
na.Object.defineProperties(vf.prototype,{diagram:{configurable:!0,get:function(){return this.G},set:function(a){a instanceof P&&(this.G=a)}},name:{configurable:!0,get:function(){return this.Wa},set:function(a){z(a,"string",vf,"name");this.Wa=a}},isEnabled:{configurable:!0,get:function(){return this.Fc},set:function(a){z(a,"boolean",vf,"isEnabled");this.Fc=a}},isActive:{configurable:!0,get:function(){return this.Wb},set:function(a){z(a,"boolean",
vf,"isActive");this.Wb=a}},transactionResult:{configurable:!0,get:function(){return this.iw},set:function(a){null!==a&&z(a,"string",vf,"transactionResult");this.iw=a}}});vf.prototype.stopTransaction=vf.prototype.yg;vf.prototype.startTransaction=vf.prototype.Ca;vf.className="Tool";function $a(){vf.call(this);this.name="ToolManager";this.Mc=new G;this.Nc=new G;this.zg=new G;this.ca=this.Ma=850;this.w=(new Zb(2,2)).ia();this.Xb=5E3;this.Na=Bf;this.L=Df;this.br=this.l=null;this.Lj=-1}
ma($a,vf);$a.prototype.initializeStandardTools=function(){};$a.prototype.updateAdornments=function(a){var b=this.currentToolTip;if(b instanceof Cf&&this.br===a){var c=b.adornedObject;(null!==a?c.part===a:null===c)?this.showToolTip(b,c):this.hideToolTip()}};
$a.prototype.doMouseDown=function(){var a=this.diagram,b=a.lastInput;b.isTouchEvent&&this.gestureBehavior===Ef&&(b.bubbles=!1);if(b.isMultiTouch){this.cancelWaitAfter();if(this.gestureBehavior===Ff){b.bubbles=!0;return}if(this.gestureBehavior===Ef)return;if(a.currentTool.canStartMultiTouch()){a.currentTool.standardPinchZoomStart();return}}var c=a.undoManager;E&&c.checksTransactionLevel&&0!==c.transactionLevel&&Ga("WARNING: In ToolManager.doMouseDown: UndoManager.transactionLevel is not zero");c=this.mouseDownTools.length;
for(var d=0;d<c;d++){var e=this.mouseDownTools.O(d);e.ib(this.diagram);if(e.canStart()){a.doFocus();a.currentTool=e;a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseDown());return}}1===a.lastInput.button&&(this.mouseWheelBehavior===Bf?this.mouseWheelBehavior=Af:this.mouseWheelBehavior===Af&&(this.mouseWheelBehavior=Bf));this.doActivate();this.standardWaitAfter(this.holdDelay,b)};
$a.prototype.doMouseMove=function(){var a=this.diagram,b=a.lastInput;if(b.isMultiTouch){if(this.gestureBehavior===Ff){b.bubbles=!0;return}if(this.gestureBehavior===Ef)return;if(a.currentTool.canStartMultiTouch()){a.currentTool.standardPinchZoomMove();return}}if(this.isActive)for(var c=this.mouseMoveTools.length,d=0;d<c;d++){var e=this.mouseMoveTools.O(d);e.ib(this.diagram);if(e.canStart()){a.doFocus();a.currentTool=e;a.currentTool===e&&(e.isActive||e.doActivate(),e.doMouseMove());return}}Gf(this,
a);a=b.event;null===a||"mousemove"!==a.type&&"pointermove"!==a.type&&a.cancelable||(b.bubbles=!0)};function Gf(a,b){a.standardMouseOver();a.isBeyondDragSize()&&a.standardWaitAfter(a.isActive?a.holdDelay:a.hoverDelay,b.lastInput)}$a.prototype.doCurrentObjectChanged=function(a,b){a=this.currentToolTip;null===a||null!==b&&a instanceof Cf&&(b===a||b.tg(a))||this.hideToolTip()};
$a.prototype.doWaitAfter=function(a){var b=this.diagram;b.Ea&&(this.doMouseHover(),this.isActive||this.doToolTip(),a.isTouchEvent&&!b.lastInput.handled&&(a=a.copy(),a.button=2,a.buttons=2,b.lastInput=a,b.Pl=!0,b.doMouseUp()))};
$a.prototype.doMouseHover=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Tb(b.documentPoint,null,null));var c=b.targetObject;if(null!==c)for(b.handled=!1;null!==c;){a=this.isActive?c.mouseHold:c.mouseHover;if(null!==a&&(a(b,c),b.handled))break;c=c.panel}else c=this.isActive?a.mouseHold:a.mouseHover,null!==c&&c(b)};
$a.prototype.doToolTip=function(){var a=this.diagram,b=a.lastInput;null===b.targetObject&&(b.targetObject=a.Tb(b.documentPoint,null,null));b=b.targetObject;if(null!==b){if(a=this.currentToolTip,!(a instanceof Cf)||b!==a&&!b.tg(a)){for(;null!==b;){a=b.toolTip;if(null!==a){this.showToolTip(a,b);return}b=b.panel}this.hideToolTip()}}else b=a.toolTip,null!==b?this.showToolTip(b,null):this.hideToolTip()};
$a.prototype.showToolTip=function(a,b){!E||a instanceof Cf||a instanceof Hf||v("showToolTip:tooltip must be an Adornment or HTMLInfo.");null!==b&&w(b,N,$a,"showToolTip:obj");var c=this.diagram;a!==this.currentToolTip&&this.hideToolTip();if(a instanceof Cf){a.layerName="Tool";a.selectable=!1;a.scale=1/c.scale;a.category="ToolTip";null!==a.placeholder&&(a.placeholder.scale=c.scale);var d=a.diagram;null!==d&&d!==c&&d.remove(a);c.add(a);null!==b?a.adornedObject=b:a.data=c.model;a.cc();this.positionToolTip(a,
b)}else a instanceof Hf&&a!==this.currentToolTip&&a.show(b,c,this);this.currentToolTip=a;-1!==this.Lj&&(qa.clearTimeout(this.Lj),this.Lj=-1);a=this.toolTipDuration;if(0<a&&Infinity!==a){var e=this;this.Lj=wa(function(){e.hideToolTip()},a)}};
$a.prototype.positionToolTip=function(a){if(null===a.placeholder){var b=this.diagram,c=b.lastInput.documentPoint.copy(),d=a.measuredBounds,e=b.viewportBounds;b.lastInput.isTouchEvent&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5/b.scale);c.x<e.x&&(c.x=e.x);c.y=c.y+20/b.scale+d.height>e.bottom?c.y-(d.height+5/b.scale):c.y+20/b.scale;c.y<e.y&&(c.y=e.y);a.position=c}};
$a.prototype.hideToolTip=function(){-1!==this.Lj&&(qa.clearTimeout(this.Lj),this.Lj=-1);var a=this.diagram,b=this.currentToolTip;null!==b&&(b instanceof Cf?(a.remove(b),null!==this.br&&this.br.wf(b.category),b.data=null,b.adornedObject=null):b instanceof Hf&&null!==b.hide&&b.hide(a,this),this.currentToolTip=null)};
$a.prototype.doMouseUp=function(){this.cancelWaitAfter();var a=this.diagram;if(this.isActive)for(var b=this.mouseUpTools.length,c=0;c<b;c++){var d=this.mouseUpTools.O(c);d.ib(this.diagram);if(d.canStart()){a.doFocus();a.currentTool=d;a.currentTool===d&&(d.isActive||d.doActivate(),d.doMouseUp());return}}a.doFocus();this.doDeactivate()};$a.prototype.doMouseWheel=function(){this.standardMouseWheel()};$a.prototype.doKeyDown=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyDown()};
$a.prototype.doKeyUp=function(){var a=this.diagram;null!==a.commandHandler&&a.commandHandler.doKeyUp()};$a.prototype.findTool=function(a){z(a,"string",$a,"findTool:name");for(var b=this.mouseDownTools.length,c=0;c<b;c++){var d=this.mouseDownTools.O(c);if(d.name===a)return d}b=this.mouseMoveTools.length;for(c=0;c<b;c++)if(d=this.mouseMoveTools.O(c),d.name===a)return d;b=this.mouseUpTools.length;for(c=0;c<b;c++)if(d=this.mouseUpTools.O(c),d.name===a)return d;return null};
$a.prototype.replaceTool=function(a,b){z(a,"string",$a,"replaceTool:name");null!==b&&(w(b,vf,$a,"replaceTool:newtool"),b.ib(this.diagram));for(var c=this.mouseDownTools.length,d=0;d<c;d++){var e=this.mouseDownTools.O(d);if(e.name===a)return null!==b?this.mouseDownTools.jd(d,b):this.mouseDownTools.nb(d),e}c=this.mouseMoveTools.length;for(d=0;d<c;d++)if(e=this.mouseMoveTools.O(d),e.name===a)return null!==b?this.mouseMoveTools.jd(d,b):this.mouseMoveTools.nb(d),e;c=this.mouseUpTools.length;for(d=0;d<
c;d++)if(e=this.mouseUpTools.O(d),e.name===a)return null!==b?this.mouseUpTools.jd(d,b):this.mouseUpTools.nb(d),e;return null};function If(a,b,c,d){z(b,"string",$a,"replaceStandardTool:name");w(d,G,$a,"replaceStandardTool:list");null!==c&&(w(c,vf,$a,"replaceStandardTool:newtool"),c.name=b,c.ib(a.diagram));a.findTool(b)?a.replaceTool(b,c):null!==c&&d.add(c)}
na.Object.defineProperties($a.prototype,{mouseWheelBehavior:{configurable:!0,get:function(){return this.Na},set:function(a){tb(a,$a,$a,"mouseWheelBehavior");this.Na=a}},gestureBehavior:{configurable:!0,get:function(){return this.L},set:function(a){tb(a,$a,$a,"gestureBehavior");this.L=a}},currentToolTip:{configurable:!0,get:function(){return this.l},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ToolManager.currentToolTip must be an Adornment or HTMLInfo.");
this.l=a;this.br=null!==a&&a instanceof Cf?a.adornedPart:null}},mouseDownTools:{configurable:!0,get:function(){return this.Mc}},mouseMoveTools:{configurable:!0,get:function(){return this.Nc}},mouseUpTools:{configurable:!0,get:function(){return this.zg}},hoverDelay:{configurable:!0,get:function(){return this.Ma},set:function(a){z(a,"number",$a,"hoverDelay");this.Ma=a}},holdDelay:{configurable:!0,get:function(){return this.ca},set:function(a){z(a,
"number",$a,"holdDelay");this.ca=a}},dragSize:{configurable:!0,get:function(){return this.w},set:function(a){w(a,Zb,$a,"dragSize");this.w=a.J()}},toolTipDuration:{configurable:!0,get:function(){return this.Xb},set:function(a){z(a,"number",$a,"toolTipDuration");this.Xb=a}}});var Bf=new D($a,"WheelScroll",0),Af=new D($a,"WheelZoom",1),Jf=new D($a,"WheelNone",2),Df=new D($a,"GestureZoom",3),Ef=new D($a,"GestureCancel",4),Ff=new D($a,"GestureNone",5);$a.className="ToolManager";
$a.WheelScroll=Bf;$a.WheelZoom=Af;$a.WheelNone=Jf;$a.GestureZoom=Df;$a.GestureCancel=Ef;$a.GestureNone=Ff;function Kf(){vf.call(this);0<arguments.length&&Da(Kf);this.name="Dragging";this.L=this.Mc=!0;this.w=this.Na=this.ca=this.eg=null;this.Bn=this.Nc=!1;this.Kl=new J(NaN,NaN);this.zs=new J;this.Xb=!0;this.Sk=100;this.Kg=[];this.zg=(new I).freeze();this.Ma=new Lf}ma(Kf,vf);
Kf.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly&&!a.allowDragOut||!a.allowMove&&!a.allowCopy&&!a.allowDragOut||!a.allowSelect)return!1;var b=a.lastInput;return!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.isTouchEvent&&b.timestamp-a.firstInput.timestamp<this.Sk)?!1:null!==this.findDraggablePart()};
Kf.prototype.findDraggablePart=function(){var a=this.diagram;a=a.dm(a.firstInput.documentPoint,!1);if(null===a)return null;for(;null!==a&&!a.canSelect();)a=a.containingGroup;return null!==a&&(a.canMove()||a.canCopy())?a:null};
Kf.prototype.standardMouseSelect=function(){var a=this.diagram;if(a.allowSelect){var b=a.dm(a.firstInput.documentPoint,!1);if(null!==b){for(;null!==b&&!b.canSelect();)b=b.containingGroup;this.currentPart=b;null===this.currentPart||this.currentPart.isSelected||(a.ba("ChangingSelection",a.selection),b=a.lastInput,(kb?b.meta:b.control)||b.shift||Mf(a),this.currentPart.isSelected=!0,a.ba("ChangedSelection",a.selection))}}};
Kf.prototype.doActivate=function(){var a=this.diagram;null===this.currentPart&&this.standardMouseSelect();var b=this.currentPart;null!==b&&(b.canMove()||b.canCopy())&&(Nf=null,this.isActive=!0,this.Kl.set(a.position),Of(this,a.selection),this.Kg.length=0,this.draggedParts=this.computeEffectiveCollection(a.selection,this.dragOptions),a.Wi=!0,!0===a.Fe("temporaryPixelRatio")&&30<a.iu&&(a.xe=1),Yf(a,this.draggedParts),this.Ca("Drag"),this.startPoint=a.firstInput.documentPoint,a.isMouseCaptured=!0,a.allowDragOut&&
(this.isDragOutStarted=!0,this.Bn=!1,Nf=this,Zf=this.diagram,this.doSimulatedDragOut()))};function Of(a,b){if(a.dragsLink){var c=a.diagram;c.allowRelink&&(c.model.ek()&&1===b.count&&b.first()instanceof Q?(a.draggedLink=b.first(),a.draggedLink.canRelinkFrom()&&a.draggedLink.canRelinkTo()&&a.draggedLink.Tj(),a.eg=c.toolManager.findTool("Relinking"),null===a.eg&&(a.eg=new $f,a.eg.ib(c))):(a.draggedLink=null,a.eg=null))}}
Kf.prototype.computeEffectiveCollection=function(a,b){return this.diagram.commandHandler.computeEffectiveCollection(a,b)};Kf.prototype.rd=function(a){return void 0===a?new ag(gc):this.isGridSnapEnabled?new ag(new J(Math.round(a.x),Math.round(a.y))):new ag(a.copy())};
Kf.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.yf();bg(this);cg(a,this.draggedParts);this.draggedParts=this.currentPart=null;this.Bn=this.isDragOutStarted=!1;if(0<dg.count){for(var b=dg,c=b.length,d=0;d<c;d++){var e=b.O(d);eg(e);fg(e);bg(e);e.diagram.yf()}b.clear()}eg(this);this.Kl.h(NaN,NaN);Nf=Zf=null;fg(this);a.isMouseCaptured=!1;a.currentCursor="";a.Wi=!1;this.yg();gg(a,!0)};
function bg(a){var b=a.diagram,c=b.skipsUndoManager;b.skipsUndoManager=!0;hg(a,b.lastInput,null);b.skipsUndoManager=c;a.Kg.length=0}function ig(){var a=Nf;fg(a);jg(a);var b=a.diagram;a.Kl.o()&&(b.position=a.Kl);b.yf()}Kf.prototype.doCancel=function(){fg(this);jg(this);var a=this.diagram;this.Kl.o()&&(a.position=this.Kl);this.stopTool()};Kf.prototype.doKeyDown=function(){this.isActive&&("Esc"===this.diagram.lastInput.key?this.doCancel():this.doMouseMove())};
Kf.prototype.doKeyUp=function(){this.isActive&&this.doMouseMove()};function kg(a,b){var c=Infinity,d=Infinity,e=-Infinity,f=-Infinity;for(a=a.iterator;a.next();){var g=a.value;if(g.Ob()&&g.isVisible()){var h=g.location;g=h.x;h=h.y;isNaN(g)||isNaN(h)||(g<c&&(c=g),h<d&&(d=h),g>e&&(e=g),h>f&&(f=h))}}Infinity===c?b.h(0,0,0,0):b.h(c,d,e-c,f-d)}
function lg(a,b){if(null===a.copiedParts){var c=a.diagram;if((!b||!c.isReadOnly&&!c.isModelReadOnly)&&null!==a.draggedParts){var d=c.undoManager;d.isEnabled&&d.isInTransaction?null!==d.currentTransaction&&0<d.currentTransaction.changes.count&&(c.undoManager.xf(),c.Ca("Drag")):jg(a);c.skipsUndoManager=!b;c.partManager.addsToTemporaryLayer=!b;a.startPoint=c.firstInput.documentPoint;b=a.copiesEffectiveCollection?a.draggedParts.Zd():c.selection;c=c.Yj(b,c,!0);for(b=c.iterator;b.next();)b.value.location=
b.key.location;b=L.alloc();kg(c,b);L.free(b);b=new Ub;for(d=a.draggedParts.iterator;d.next();){var e=d.key;e.Ob()&&e.canCopy()&&(e=c.K(e),null!==e&&(e.cc(),b.add(e,a.rd(e.location))))}for(c=c.iterator;c.next();)d=c.value,d instanceof Q&&d.canCopy()&&b.add(d,a.rd());a.copiedParts=b;Of(a,b.Zd());null!==a.draggedLink&&(c=a.draggedLink,b=c.routeBounds,mg(c,a.startPoint.x-(b.x+b.width/2),a.startPoint.y-(b.y+b.height/2)))}}}
function fg(a){var b=a.diagram;if(null!==a.copiedParts&&(b.vt(a.copiedParts.Zd(),!1),a.copiedParts=null,null!==a.draggedParts))for(var c=a.draggedParts.iterator;c.next();)c.key instanceof Q&&(c.value.point=new J(0,0));b.skipsUndoManager=!1;b.partManager.addsToTemporaryLayer=!1;a.startPoint=b.firstInput.documentPoint}
function eg(a){if(null!==a.draggedLink){if(a.dragsLink&&null!==a.eg){var b=a.eg;b.diagram.remove(b.temporaryFromNode);b.diagram.remove(b.temporaryToNode)}a.draggedLink=null;a.eg=null}}function ng(a,b,c){var d=a.diagram,e=a.startPoint,f=J.alloc();f.assign(d.lastInput.documentPoint);a.moveParts(b,f.Yd(e),c);J.free(f);!0===d.Fe("temporaryPixelRatio")&&null===d.xe&&30<d.iu&&(d.xe=1,d.st())}Kf.prototype.moveParts=function(a,b,c){var d=this.diagram;null!==d&&og(d,a,b,this.dragOptions,c)};
function jg(a){if(null!==a.draggedParts){for(var b=a.diagram,c=a.draggedParts.iterator;c.next();){var d=c.key;d.Ob()&&(d.location=c.value.point)}for(c=a.draggedParts.iterator;c.next();)if(d=c.key,d instanceof Q&&d.suspendsRouting){var e=c.value.point;a.draggedParts.add(d,a.rd());mg(d,-e.x,-e.y)}b.hd()}}function pg(a,b){if(null===b)return!0;b=b.part;return null===b||b instanceof Cf||b.layer.isTemporary||a.draggedParts&&a.draggedParts.contains(b)||a.copiedParts&&a.copiedParts.contains(b)?!0:!1}
function sg(a,b){var c=a.diagram;a.dragsLink&&(null!==a.draggedLink&&(a.draggedLink.fromNode=null,a.draggedLink.toNode=null),tg(a,!1));var d=ug(c,b,null,function(b){return!pg(a,b)}),e=c.lastInput;e.targetObject=d;var f=c.skipsUndoManager,g=!1;try{c.skipsUndoManager=!0;g=hg(a,e,d);if(!a.isActive&&null===Nf)return;if(null===d||c.handlesDragDropForTopLevelParts){var h=c.mouseDragOver;null!==h&&(h(e),g=!0)}if(!a.isActive&&null===Nf)return;a.doDragOver(b,d);if(!a.isActive&&null===Nf)return}finally{c.skipsUndoManager=
f,g&&c.hd()}(c.allowHorizontalScroll||c.allowVerticalScroll)&&c.Rs(e.viewPoint)}function hg(a,b,c){var d=!1,e=a.Kg.length,f=0<e?a.Kg[0]:null;if(c===f)return!1;b.handled=!1;for(var g=0;g<e;g++){var h=a.Kg[g],k=h.mouseDragLeave;if(null!==k&&(k(b,h,c),d=!0,b.handled))break}a.Kg.length=0;if(!a.isActive&&null===Nf||null===c)return d;b.handled=!1;for(e=c;null!==e;)a.Kg.push(e),e=vg(e);e=a.Kg.length;for(c=0;c<e&&(g=a.Kg[c],h=g.mouseDragEnter,null===h||(h(b,g,f),d=!0,!b.handled));c++);return d}
function vg(a){var b=a.panel;return null!==b?b:a instanceof R&&!(a instanceof wg)&&(a=a.containingGroup,null!==a&&a.handlesDragDropForMembers)?a:null}function xg(a,b,c){var d=a.eg;if(null===d)return null;var e=a.diagram.qg(b,d.portGravity,function(a){return d.findValidLinkablePort(a,c)});a=J.alloc();var f=Infinity,g=null;for(e=e.iterator;e.next();){var h=e.value;if(null!==h.part){var k=h.oa(qd,a);k=b.De(k);k<f&&(g=h,f=k)}}J.free(a);return g}
function tg(a,b){var c=a.draggedLink;if(null!==c&&!(2>c.pointsCount)){var d=a.diagram;if(!d.isReadOnly){var e=a.eg;if(null!==e){var f=null,g=null;null===c.fromNode&&(f=xg(a,c.i(0),!1),null!==f&&(g=f.part));var h=null,k=null;null===c.toNode&&(h=xg(a,c.i(c.pointsCount-1),!0),null!==h&&(k=h.part));e.isValidLink(g,f,k,h)?b?(c.defaultFromPoint=c.i(0),c.defaultToPoint=c.i(c.pointsCount-1),c.suspendsRouting=!1,c.fromNode=g,null!==f&&(c.fromPortId=f.portId),c.toNode=k,null!==h&&(c.toPortId=h.portId),c.fromPort!==
d.Ax&&d.ba("LinkRelinked",c,d.Ax),c.toPort!==d.Bx&&d.ba("LinkRelinked",c,d.Bx)):yg(e,g,f,k,h):yg(e,null,null,null,null)}}}}Kf.prototype.doDragOver=function(){};
function zg(a,b){var c=a.diagram;a.dragsLink&&tg(a,!0);bg(a);var d=ug(c,b,null,function(b){return!pg(a,b)}),e=c.lastInput;e.targetObject=d;if(null!==d){e.handled=!1;for(var f=d;null!==f;){var g=f.mouseDrop;if(null!==g&&(g(e,f),e.handled))break;Ag(a,e,f);f=vg(f)}}else f=c.mouseDrop,null!==f&&f(e);if(a.isActive||null!==Nf){for(e=(a.copiedParts||a.draggedParts).iterator;e.next();)f=e.key,f instanceof V&&f.linksConnected.each(function(a){a.suspendsRouting=!1});a.doDropOnto(b,d);if(a.isActive||null!==
Nf){b=L.alloc();for(d=c.selection.iterator;d.next();)e=d.value,e instanceof V&&Bg(a,c,e,b);L.free(b)}}}function Ag(a,b,c){a=a.diagram;c instanceof R&&null===c.containingGroup&&!(c instanceof wg)&&a.handlesDragDropForTopLevelParts&&(c=a.mouseDrop,null!==c&&c(b))}
function Bg(a,b,c,d){var e=!1;c.getAvoidableRect(d);b.viewportBounds.qf(d)&&(e=!0);b=b.links;for(a=a.copiedParts||a.draggedParts;b.next();){var f=b.value;if(!e||Cg(f))a.contains(f)&&a.contains(c)||!f.Wd(c)&&f.isAvoiding&&Lc(f.actualBounds,d,0)&&f.Ta()}}Kf.prototype.doDropOnto=function(){};
Kf.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;this.simulatedMouseMove(b.event,null,b.targetDiagram||null)||null===this.currentPart||null===this.draggedParts||(this.mayCopy()?(a.currentCursor="copy",lg(this,!1),Yf(a,this.copiedParts),ng(this,this.copiedParts,!1),cg(a,this.copiedParts)):this.mayMove()?(fg(this),ng(this,this.draggedParts,!0)):this.mayDragOut()?(a.currentCursor="no-drop",lg(this,!1),ng(this,this.copiedParts,!1)):fg(this),sg(this,a.lastInput.documentPoint))}};
Kf.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=a.lastInput;if(!this.simulatedMouseUp(b.event,null,b.documentPoint,b.targetDiagram)){var c=!1;(b=this.mayCopy())&&null!==this.copiedParts?(fg(this),lg(this,!0),Yf(a,this.copiedParts),ng(this,this.copiedParts,!1),cg(a,this.copiedParts),null!==this.copiedParts&&a.Kv(this.copiedParts.Zd())):(c=!0,fg(this),this.mayMove()&&(ng(this,this.draggedParts,!0),sg(this,a.lastInput.documentPoint)));this.Bn=!0;zg(this,a.lastInput.documentPoint);
if(this.isActive){var d=b?this.copiedParts.Zd():this.draggedParts.Zd();this.copiedParts=null;if(c&&null!==this.draggedParts)for(c=this.draggedParts.iterator;c.next();){var e=c.key;e instanceof V&&(e=e.containingGroup,null===e||null===e.placeholder||this.draggedParts.contains(e)||e.placeholder.v())}a.Ya();cg(a,this.draggedParts);this.transactionResult=b?"Copy":"Move";a.ba(b?"SelectionCopied":"SelectionMoved",d)}this.stopTool()}}};
Kf.prototype.simulatedMouseMove=function(a,b,c){if(null===Nf)return!1;var d=Nf.diagram;c instanceof P||(c=null);var e=Zf;c!==e&&(null!==e&&e!==d&&(e.yf(),Nf.isDragOutStarted=!1,e=e.toolManager.findTool("Dragging"),null!==e&&e.doSimulatedDragLeave()),Zf=c,null!==c&&c!==d&&(ig(),e=c.toolManager.findTool("Dragging"),null!==e&&(dg.contains(e)||dg.add(e),e.doSimulatedDragEnter())));if(null===c||c===d||!c.allowDrop||c.isReadOnly||!c.allowInsert)return!1;d=c.toolManager.findTool("Dragging");null!==d&&(null!==
a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:0<a.changedTouches.length&&(a=a.changedTouches[0])),b=c.getMouse(a)):null===b&&(b=new J),c.lastInput.documentPoint=b,c.lastInput.viewPoint=c.Ct(b),c.lastInput.down=!1,c.lastInput.up=!1,d.doSimulatedDragOver());return!0};
Kf.prototype.simulatedMouseUp=function(a,b,c,d){if(null===Nf)return!1;null===d&&(d=b);b=Zf;var e=Nf.diagram;if(d!==b){var f=b.toolManager.findTool("Dragging");if(null!==b&&b!==e&&null!==f)return b.yf(),Nf.isDragOutStarted=!1,f.doSimulatedDragLeave(),!1;Zf=d;b=d.toolManager.findTool("Dragging");null!==d&&null!==b&&(ig(),dg.contains(b)||dg.add(b),b.doSimulatedDragEnter())}return null===d?(Nf.doCancel(),!0):d!==this.diagram?(null!==a?(void 0!==a.targetTouches&&(0<a.targetTouches.length?a=a.targetTouches[0]:
0<a.changedTouches.length&&(a=a.changedTouches[0])),c=d.getMouse(a)):null===c&&(c=new J),d.lastInput.documentPoint=c,d.lastInput.viewPoint=d.Ct(c),d.lastInput.down=!1,d.lastInput.up=!0,a=d.toolManager.findTool("Dragging"),null!==a&&a.doSimulatedDrop(),a=Nf,null!==a&&(d=a.mayCopy(),a.transactionResult=d?"Copy":"Move",a.stopTool()),!0):!1};
Kf.prototype.mayCopy=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.allowCopy||(kb?!a.lastInput.alt:!a.lastInput.control))return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Ob()&&b.canCopy())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canCopy()?!0:!1};
Kf.prototype.mayDragOut=function(){if(!this.isCopyEnabled)return!1;var a=this.diagram;if(!a.allowDragOut||!a.allowCopy||a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Ob()&&b.canCopy())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canCopy()?!0:!1};
Kf.prototype.mayMove=function(){var a=this.diagram;if(a.isReadOnly||!a.allowMove)return!1;for(a=a.selection.iterator;a.next();){var b=a.value;if(b.Ob()&&b.canMove())return!0}return null!==this.draggedLink&&this.dragsLink&&this.draggedLink.canMove()?!0:!1};Kf.prototype.computeBorder=function(a,b,c){return this.Bn||null===this.draggedParts||this.draggedParts.contains(a)?null:c.assign(b)};Kf.prototype.iz=function(){return Nf};
Kf.prototype.mayDragIn=function(){var a=this.diagram;if(!a.allowDrop||a.isReadOnly||a.isModelReadOnly||!a.allowInsert)return!1;var b=Nf;return null===b||b.diagram.model.dataFormat!==a.model.dataFormat?!1:!0};Kf.prototype.doSimulatedDragEnter=function(){if(this.mayDragIn()){var a=this.diagram;a.animationManager.xd();Dg(a);a.animationManager.xd();a=Nf;null!==a&&(a.diagram.currentCursor="copy",a.diagram.Wi=!1)}};Kf.prototype.doSimulatedDragLeave=function(){var a=Nf;null!==a&&a.doSimulatedDragOut();this.doCancel()};
Kf.prototype.doSimulatedDragOver=function(){var a=this.diagram,b=Nf;null!==b&&null!==b.draggedParts&&this.mayDragIn()&&(a.currentCursor="copy",Eg(this,b.draggedParts.Zd(),!1,a.firstInput),ng(this,this.copiedParts,!1),sg(this,a.lastInput.documentPoint))};
Kf.prototype.doSimulatedDrop=function(){var a=this.diagram,b=Nf;if(null!==b){var c=b.diagram;b.Bn=!0;fg(this);this.mayDragIn()&&(this.Ca("Drop"),Eg(this,b.draggedParts.Zd(),!0,a.lastInput),ng(this,this.copiedParts,!1),null!==this.copiedParts&&a.Kv(this.copiedParts.Zd()),zg(this,a.lastInput.documentPoint),a.Ya(),b=a.selection,null!==this.copiedParts?this.transactionResult="ExternalCopy":b=new I,this.copiedParts=null,a.doFocus(),a.ba("ExternalObjectsDropped",b,c),this.yg())}};
function Eg(a,b,c,d){if(null===a.copiedParts){var e=a.diagram;if(!e.isReadOnly&&!e.isModelReadOnly){e.skipsUndoManager=!c;e.partManager.addsToTemporaryLayer=!c;a.startPoint=d.documentPoint;c=e.Yj(b,e,!0);var f=L.alloc();kg(b,f);d=f.x+f.width/2;e=f.y+f.height/2;L.free(f);f=a.zs;var g=new Ub,h=J.alloc();for(b=b.iterator;b.next();){var k=b.value,l=c.K(k);k.Ob()&&k.canCopy()?(k=k.location,h.h(f.x-(d-k.x),f.y-(e-k.y)),l.location=h,l.cc(),g.add(l,a.rd(h))):l instanceof Q&&k.canCopy()&&(mg(l,f.x-d,f.y-e),
g.add(l,a.rd()))}J.free(h);a.copiedParts=g;Of(a,g.Zd());null!==a.draggedLink&&(c=a.draggedLink,d=c.routeBounds,mg(c,a.startPoint.x-(d.x+d.width/2),a.startPoint.y-(d.y+d.height/2)))}}}Kf.prototype.doSimulatedDragOut=function(){var a=this.diagram;a.Wi=!1;this.mayCopy()||this.mayMove()?a.currentCursor="":a.currentCursor="no-drop"};Kf.prototype.computeMove=function(a,b,c,d){c=this.diagram;return null!==c?c.computeMove(a,b,this.dragOptions,d):new J};
na.Object.defineProperties(Kf.prototype,{isCopyEnabled:{configurable:!0,get:function(){return this.Mc},set:function(a){z(a,"boolean",Kf,"isCopyEnabled");this.Mc=a}},copiesEffectiveCollection:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"boolean",Kf,"copiesEffectiveCollection");this.L=a}},dragOptions:{configurable:!0,get:function(){return this.Ma},set:function(a){w(a,Lf,Kf,"dragOptions");this.Ma=a}},isGridSnapEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.dragOptions.isGridSnapEnabled},set:function(a){z(a,"boolean",Kf,"isGridSnapEnabled");this.dragOptions.isGridSnapEnabled=a}},isComplexRoutingRealtime:{configurable:!0,get:function(){return this.Xb},set:function(a){z(a,"boolean",Kf,"isComplexRoutingRealtime");this.Xb=a}},isGridSnapRealtime:{configurable:!0,get:function(){return this.dragOptions.isGridSnapRealtime},set:function(a){z(a,"boolean",Kf,"isGridSnapRealtime");this.dragOptions.isGridSnapRealtime=
a}},gridSnapCellSize:{configurable:!0,get:function(){return this.dragOptions.gridSnapCellSize},set:function(a){w(a,Zb,Kf,"gridSnapCellSize");null===this.diagram||this.dragOptions.gridSnapCellSize.A(a)||(a=a.J(),this.dragOptions.gridSnapCellSize=a)}},gridSnapCellSpot:{configurable:!0,get:function(){return this.dragOptions.gridSnapCellSpot},set:function(a){w(a,M,Kf,"gridSnapCellSpot");this.dragOptions.gridSnapCellSpot.A(a)||(a=a.J(),this.dragOptions.gridSnapCellSpot=a)}},
gridSnapOrigin:{configurable:!0,get:function(){return this.dragOptions.gridSnapOrigin},set:function(a){w(a,J,Kf,"gridSnapOrigin");this.dragOptions.gridSnapOrigin.A(a)||(a=a.J(),this.dragOptions.gridSnapOrigin=a)}},dragsLink:{configurable:!0,get:function(){return this.dragOptions.dragsLink},set:function(a){z(a,"boolean",Kf,"dragsLink");this.dragOptions.dragsLink=a}},dragsTree:{configurable:!0,get:function(){return this.dragOptions.dragsTree},set:function(a){z(a,
"boolean",Kf,"dragsTree");this.dragOptions.dragsTree=a}},currentPart:{configurable:!0,get:function(){return this.ca},set:function(a){null!==a&&w(a,R,Kf,"currentPart");this.ca=a}},copiedParts:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},draggedParts:{configurable:!0,get:function(){return this.Na},set:function(a){this.Na=a}},draggingParts:{configurable:!0,get:function(){return null!==this.copiedParts?this.copiedParts.Zd():
null!==this.draggedParts?this.draggedParts.Zd():this.zg}},draggedLink:{configurable:!0,get:function(){return this.diagram.draggedLink},set:function(a){null!==a&&w(a,Q,Kf,"draggedLink");this.diagram.draggedLink=a}},isDragOutStarted:{configurable:!0,get:function(){return this.Nc},set:function(a){this.Nc=a}},startPoint:{configurable:!0,get:function(){return this.zs},set:function(a){w(a,J,Kf,"startPoint");this.zs.A(a)||this.zs.assign(a)}},delay:{configurable:!0,
enumerable:!0,get:function(){return this.Sk},set:function(a){z(a,"number",Kf,"delay");this.Sk=a}}});Kf.prototype.getDraggingSource=Kf.prototype.iz;var dg=null,Nf=null,Zf=null;Kf.className="DraggingTool";dg=new G;Za("draggingTool",function(){return this.findTool("Dragging")},function(a){If(this,"Dragging",a,this.mouseMoveTools)});$a.prototype.doCancel=function(){null!==Nf&&Nf.doCancel();vf.prototype.doCancel.call(this)};
function Fg(){0<arguments.length&&Da(Fg);vf.call(this);this.zg=100;this.ca=!1;var a=new Q,b=new Gg;b.isPanelMain=!0;b.stroke="blue";a.add(b);b=new Gg;b.toArrow="Standard";b.fill="blue";b.stroke="blue";a.add(b);a.layerName="Tool";this.Km=a;a=new V;b=new Gg;b.portId="";b.figure="Rectangle";b.fill=null;b.stroke="magenta";b.strokeWidth=2;b.desiredSize=sc;a.add(b);a.selectable=!1;a.layerName="Tool";this.Im=a;this.Jm=b;a=new V;b=new Gg;b.portId="";b.figure="Rectangle";b.fill=null;b.stroke="magenta";b.strokeWidth=
2;b.desiredSize=sc;a.add(b);a.selectable=!1;a.layerName="Tool";this.Bq=a;this.hw=b;this.Nc=this.Mc=this.Na=this.Ma=this.Xb=null;this.L=!0;this.Vx=new Ub;this.Gm=this.ki=this.Hm=null}ma(Fg,vf);Fg.prototype.doStop=function(){this.diagram.yf();this.originalToPort=this.originalToNode=this.originalFromPort=this.originalFromNode=this.originalLink=null;this.validPortsCache.clear();this.targetPort=null};
Fg.prototype.copyPortProperties=function(a,b,c,d,e){if(null!==a&&null!==b&&null!==c&&null!==d){var f=b.Ee(),g=Zb.alloc();g.width=b.naturalBounds.width*f;g.height=b.naturalBounds.height*f;d.desiredSize=g;Zb.free(g);e?(d.toSpot=b.toSpot,d.toEndSegmentLength=b.toEndSegmentLength):(d.fromSpot=b.fromSpot,d.fromEndSegmentLength=b.fromEndSegmentLength);c.locationSpot=qd;f=J.alloc();c.location=b.oa(qd,f);J.free(f);d.angle=b.Li();null!==this.portTargeted&&this.portTargeted(a,b,c,d,e)}};
Fg.prototype.setNoTargetPortProperties=function(a,b,c){null!==b&&(b.desiredSize=sc,b.fromSpot=ed,b.toSpot=ed);null!==a&&(a.location=this.diagram.lastInput.documentPoint);null!==this.portTargeted&&this.portTargeted(null,null,a,b,c)};Fg.prototype.doMouseDown=function(){this.isActive&&this.doMouseMove()};
Fg.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram;this.targetPort=this.findTargetPort(this.isForwards);if(null!==this.targetPort&&this.targetPort.part instanceof V){var b=this.targetPort.part;this.isForwards?this.copyPortProperties(b,this.targetPort,this.temporaryToNode,this.temporaryToPort,!0):this.copyPortProperties(b,this.targetPort,this.temporaryFromNode,this.temporaryFromPort,!1)}else this.isForwards?this.setNoTargetPortProperties(this.temporaryToNode,this.temporaryToPort,
!0):this.setNoTargetPortProperties(this.temporaryFromNode,this.temporaryFromPort,!1);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Rs(a.lastInput.viewPoint)}};Fg.prototype.findValidLinkablePort=function(a,b){if(null===a)return null;var c=a.part;if(!(c instanceof V))return null;for(;null!==a;){var d=b?a.toLinkable:a.fromLinkable;if(!0===d&&(null!==a.portId||a instanceof V)&&(b?this.isValidTo(c,a):this.isValidFrom(c,a)))return a;if(!1===d)break;a=a.panel}return null};
Fg.prototype.findTargetPort=function(a){var b=this.diagram,c=b.lastInput.documentPoint,d=this.portGravity;0>=d&&(d=.1);var e=this,f=b.qg(c,d,function(b){return e.findValidLinkablePort(b,a)},null,!0);d=Infinity;b=null;for(f=f.iterator;f.next();){var g=f.value,h=g.part;if(h instanceof V){var k=g.oa(qd,J.alloc()),l=c.x-k.x,m=c.y-k.y;J.free(k);k=l*l+m*m;k<d&&(l=this.validPortsCache.K(g),null!==l?l&&(b=g,d=k):a&&this.isValidLink(this.originalFromNode,this.originalFromPort,h,g)||!a&&this.isValidLink(h,
g,this.originalToNode,this.originalToPort)?(this.validPortsCache.add(g,!0),b=g,d=k):this.validPortsCache.add(g,!1))}}return null!==b&&(c=b.part,c instanceof V&&(null===c.layer||c.layer.allowLink))?b:null};
Fg.prototype.isValidFrom=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.fromLinkable))return!1;var c=b.fromMaxLinks;if(Infinity>c){if(null!==this.originalLink&&a===this.originalFromNode&&b===this.originalFromPort)return!0;b=b.portId;null===b&&(b="");if(a.Wp(b).count>=c)return!1}return!0};
Fg.prototype.isValidTo=function(a,b){if(null===a||null===b)return this.isUnconnectedLinkValid;if(this.diagram.currentTool===this&&(null!==a.layer&&!a.layer.allowLink||!0!==b.toLinkable))return!1;var c=b.toMaxLinks;if(Infinity>c){if(null!==this.originalLink&&a===this.originalToNode&&b===this.originalToPort)return!0;b=b.portId;null===b&&(b="");if(a.ud(b).count>=c)return!1}return!0};
Fg.prototype.isInSameNode=function(a,b){if(null===a||null===b)return!1;if(a===b)return!0;a=a.part;b=b.part;return null!==a&&a===b};Fg.prototype.isLinked=function(a,b){if(null===a||null===b)return!1;var c=a.part;if(!(c instanceof V))return!1;a=a.portId;null===a&&(a="");var d=b.part;if(!(d instanceof V))return!1;b=b.portId;null===b&&(b="");for(b=d.ud(b);b.next();)if(d=b.value,d.fromNode===c&&d.fromPortId===a)return!0;return!1};
Fg.prototype.isValidLink=function(a,b,c,d){if(!this.isValidFrom(a,b)||!this.isValidTo(c,d)||!(null===b||null===d||(b.fromLinkableSelfNode&&d.toLinkableSelfNode||!this.isInSameNode(b,d))&&(b.fromLinkableDuplicates&&d.toLinkableDuplicates||!this.isLinked(b,d)))||null!==this.originalLink&&(null!==a&&this.isLabelDependentOnLink(a,this.originalLink)||null!==c&&this.isLabelDependentOnLink(c,this.originalLink))||null!==a&&null!==c&&(null===a.data&&null!==c.data||null!==a.data&&null===c.data)||!this.isValidCycle(a,
c,this.originalLink))return!1;if(null!==a){var e=a.linkValidation;if(null!==e&&!e(a,b,c,d,this.originalLink))return!1}if(null!==c&&(e=c.linkValidation,null!==e&&!e(a,b,c,d,this.originalLink)))return!1;e=this.linkValidation;return null!==e?e(a,b,c,d,this.originalLink):!0};Fg.prototype.isLabelDependentOnLink=function(a,b){if(null===a)return!1;var c=a.labeledLink;if(null===c)return!1;if(c===b)return!0;var d=new I;d.add(a);return Hg(this,c,b,d)};
function Hg(a,b,c,d){if(b===c)return!0;var e=b.fromNode;if(null!==e&&e.isLinkLabel&&(d.add(e),Hg(a,e.labeledLink,c,d)))return!0;b=b.toNode;return null!==b&&b.isLinkLabel&&(d.add(b),Hg(a,b.labeledLink,c,d))?!0:!1}
Fg.prototype.isValidCycle=function(a,b,c){void 0===c&&(c=null);if(null===a||null===b)return this.isUnconnectedLinkValid;var d=this.diagram.validCycle;if(d!==Ig){if(d===Jg){d=c||this.temporaryLink;if(null!==d&&!d.isTreeLink)return!0;for(d=b.linksConnected;d.next();){var e=d.value;if(e!==c&&e.isTreeLink&&e.toNode===b)return!1}return!Kg(this,a,b,c,!0)}if(d===Lg){d=c||this.temporaryLink;if(null!==d&&!d.isTreeLink)return!0;for(d=a.linksConnected;d.next();)if(e=d.value,e!==c&&e.isTreeLink&&e.fromNode===
a)return!1;return!Kg(this,a,b,c,!0)}if(d===Mg)return a===b?a=!0:(d=new I,d.add(b),a=Ng(this,d,a,b,c)),!a;if(d===Og)return!Kg(this,a,b,c,!1);if(d===Pg)return a===b?a=!0:(d=new I,d.add(b),a=Qg(this,d,a,b,c)),!a}return!0};function Kg(a,b,c,d,e){if(b===c)return!0;if(null===b||null===c)return!1;for(var f=b.linksConnected;f.next();){var g=f.value;if(g!==d&&(!e||g.isTreeLink)&&g.toNode===b&&(g=g.fromNode,g!==b&&Kg(a,g,c,d,e)))return!0}return!1}
function Ng(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.linksConnected;f.next();){var g=f.value;if(g!==e&&g.toNode===c&&(g=g.fromNode,g!==c&&Ng(a,b,g,d,e)))return!0}return!1}function Qg(a,b,c,d,e){if(c===d)return!0;if(null===c||null===d||b.contains(c))return!1;b.add(c);for(var f=c.linksConnected;f.next();){var g=f.value;if(g!==e){var h=g.fromNode;g=g.toNode;h=h===c?g:h;if(h!==c&&Qg(a,b,h,d,e))return!0}}return!1}
na.Object.defineProperties(Fg.prototype,{portGravity:{configurable:!0,get:function(){return this.zg},set:function(a){z(a,"number",Fg,"portGravity");0<=a&&(this.zg=a)}},isUnconnectedLinkValid:{configurable:!0,get:function(){return this.ca},set:function(a){z(a,"boolean",Fg,"isUnconnectedLinkValid");this.ca=a}},temporaryLink:{configurable:!0,get:function(){return this.Km},set:function(a){w(a,Q,Fg,"temporaryLink");this.Km=a}},temporaryFromNode:{configurable:!0,
enumerable:!0,get:function(){return this.Im},set:function(a){w(a,V,Fg,"temporaryFromNode");this.Im=a}},temporaryFromPort:{configurable:!0,get:function(){return this.Jm},set:function(a){w(a,N,Fg,"temporaryFromPort");this.Jm=a}},temporaryToNode:{configurable:!0,get:function(){return this.Bq},set:function(a){w(a,V,Fg,"temporaryToNode");this.Bq=a}},temporaryToPort:{configurable:!0,get:function(){return this.hw},set:function(a){w(a,N,Fg,"temporaryToPort");this.hw=
a}},originalLink:{configurable:!0,get:function(){return this.Xb},set:function(a){null!==a&&w(a,Q,Fg,"originalLink");this.Xb=a}},originalFromNode:{configurable:!0,get:function(){return this.Ma},set:function(a){null!==a&&w(a,V,Fg,"originalFromNode");this.Ma=a}},originalFromPort:{configurable:!0,get:function(){return this.Na},set:function(a){null!==a&&w(a,N,Fg,"originalFromPort");this.Na=a}},originalToNode:{configurable:!0,get:function(){return this.Mc},
set:function(a){null!==a&&w(a,V,Fg,"originalToNode");this.Mc=a}},originalToPort:{configurable:!0,get:function(){return this.Nc},set:function(a){null!==a&&w(a,N,Fg,"originalToPort");this.Nc=a}},isForwards:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"boolean",Fg,"isForwards");this.L=a}},validPortsCache:{configurable:!0,get:function(){return this.Vx}},targetPort:{configurable:!0,get:function(){return this.Hm},set:function(a){null!==
a&&w(a,N,Fg,"targetPort");this.Hm=a}},linkValidation:{configurable:!0,get:function(){return this.ki},set:function(a){null!==a&&z(a,"function",Fg,"linkValidation");this.ki=a}},portTargeted:{configurable:!0,get:function(){return this.Gm},set:function(a){null!==a&&z(a,"function",Fg,"portTargeted");this.Gm=a}}});Fg.className="LinkingBaseTool";function Rg(){0<arguments.length&&Da(Rg);Fg.call(this);this.name="Linking";this.w={};this.l=null;this.M=Sg;this.Eh=null}ma(Rg,Fg);
Rg.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return a.isReadOnly||a.isModelReadOnly||!a.allowLink||!a.model.it()||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize()?!1:null!==this.findLinkablePort()};
Rg.prototype.findLinkablePort=function(){var a=this.diagram,b=this.startObject;null===b&&(b=a.Tb(a.firstInput.documentPoint,null,null));if(null===b||!(b.part instanceof V))return null;a=this.direction;if(a===Sg||a===Tg){var c=this.findValidLinkablePort(b,!1);if(null!==c)return this.isForwards=!0,c}if(a===Sg||a===Ug)if(b=this.findValidLinkablePort(b,!0),null!==b)return this.isForwards=!1,b;return null};
Rg.prototype.doActivate=function(){var a=this.diagram,b=this.findLinkablePort();null!==b&&(this.Ca(this.name),a.isMouseCaptured=!0,a.currentCursor="pointer",this.isForwards?(null===this.temporaryToNode||this.temporaryToNode.location.o()||(this.temporaryToNode.location=a.lastInput.documentPoint),this.originalFromPort=b,b=this.originalFromPort.part,b instanceof V&&(this.originalFromNode=b),this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,
!1)):(null===this.temporaryFromNode||this.temporaryFromNode.location.o()||(this.temporaryFromNode.location=a.lastInput.documentPoint),this.originalToPort=b,b=this.originalToPort.part,b instanceof V&&(this.originalToNode=b),this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0)),a.add(this.temporaryFromNode),a.add(this.temporaryToNode),null!==this.temporaryLink&&(null!==this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),
null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.temporaryLink.isTreeLink=this.isNewTreeLink(),this.temporaryLink.Ta(),a.add(this.temporaryLink)),this.isActive=!0)};Rg.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink);a.remove(this.temporaryFromNode);a.remove(this.temporaryToNode);a.isMouseCaptured=!1;a.currentCursor="";this.yg()};Rg.prototype.doStop=function(){Fg.prototype.doStop.call(this);this.startObject=null};
Rg.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram,b=this.transactionResult=null,c=null,d=null,e=null,f=this.targetPort=this.findTargetPort(this.isForwards);if(null!==f){var g=f.part;g instanceof V&&(this.isForwards?(null!==this.originalFromNode&&(b=this.originalFromNode,c=this.originalFromPort),d=g,e=f):(b=g,c=f,null!==this.originalToNode&&(d=this.originalToNode,e=this.originalToPort)))}else this.isForwards?null!==this.originalFromNode&&this.isUnconnectedLinkValid&&(b=this.originalFromNode,
c=this.originalFromPort):null!==this.originalToNode&&this.isUnconnectedLinkValid&&(d=this.originalToNode,e=this.originalToPort);null!==b||null!==d?(g=this.insertLink(b,c,d,e),null!==g?(null===f&&(this.isForwards?g.defaultToPoint=a.lastInput.documentPoint:g.defaultFromPoint=a.lastInput.documentPoint),a.allowSelect&&a.select(g),this.transactionResult=this.name,a.ba("LinkDrawn",g)):(a.model.Qu(),this.doNoLink(b,c,d,e))):this.isForwards?this.doNoLink(this.originalFromNode,this.originalFromPort,null,null):
this.doNoLink(null,null,this.originalToNode,this.originalToPort)}this.stopTool()};Rg.prototype.isNewTreeLink=function(){var a=this.archetypeLinkData;if(null===a)return!0;if(a instanceof Q)return a.isTreeLink;var b=this.diagram;if(null===b)return!0;a=b.partManager.getLinkCategoryForData(a);b=b.partManager.findLinkTemplateForCategory(a);return null!==b?b.isTreeLink:!0};Rg.prototype.insertLink=function(a,b,c,d){return this.diagram.partManager.insertLink(a,b,c,d)};Rg.prototype.doNoLink=function(){};
na.Object.defineProperties(Rg.prototype,{archetypeLinkData:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&z(a,"object",Rg,"archetypeLinkData");a instanceof N&&w(a,Q,Rg,"archetypeLinkData");this.w=a}},archetypeLabelNodeData:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&z(a,"object",Rg,"archetypeLabelNodeData");a instanceof N&&w(a,V,Rg,"archetypeLabelNodeData");this.l=a}},direction:{configurable:!0,get:function(){return this.M},
set:function(a){tb(a,Rg,Rg,"direction");this.M=a}},startObject:{configurable:!0,get:function(){return this.Eh},set:function(a){null!==a&&w(a,N,Rg,"startObject");this.Eh=a}}});var Sg=new D(Rg,"Either",0),Tg=new D(Rg,"ForwardsOnly",0),Ug=new D(Rg,"BackwardsOnly",0);Rg.className="LinkingTool";Rg.Either=Sg;Rg.ForwardsOnly=Tg;Rg.BackwardsOnly=Ug;
function $f(){0<arguments.length&&Da($f);Fg.call(this);this.name="Relinking";var a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.segmentIndex=0;this.w=a;a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="pointer";a.segmentIndex=-1;this.Eh=a;this.l=null;this.Mw=new L}ma($f,Fg);
$f.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Q){var b="RelinkFrom",c=null;if(a.isSelected&&!this.diagram.isReadOnly){var d=a.selectionObject;null!==d&&a.canRelinkFrom()&&a.actualBounds.o()&&a.isVisible()&&d.actualBounds.o()&&d.vf()&&(c=a.ak(b),null===c&&(c=this.makeAdornment(d,!1),a.qh(b,c)))}null===c&&a.wf(b);b="RelinkTo";c=null;a.isSelected&&!this.diagram.isReadOnly&&(d=a.selectionObject,null!==d&&a.canRelinkTo()&&a.actualBounds.o()&&a.isVisible()&&d.actualBounds.o()&&d.vf()&&
(c=a.ak(b),null===c?(c=this.makeAdornment(d,!0),a.qh(b,c)):c.v()));null===c&&a.wf(b)}};$f.prototype.makeAdornment=function(a,b){var c=new Cf;c.type=W.Link;b=b?this.toHandleArchetype:this.fromHandleArchetype;null!==b&&c.add(b.copy());c.adornedObject=a;return c};
$f.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowRelink||!a.model.it()||!a.lastInput.left)return!1;var b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom");null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo"));return null!==b};
$f.prototype.doActivate=function(){var a=this.diagram;if(null===this.originalLink){var b=this.handle;null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkFrom"),null===b&&(b=this.findToolHandleAt(a.firstInput.documentPoint,"RelinkTo")));if(null===b)return;var c=b.part;if(!(c instanceof Cf&&c.adornedPart instanceof Q))return;this.handle=b;this.isForwards=null===c||"RelinkTo"===c.category;this.originalLink=c.adornedPart}this.Ca(this.name);a.isMouseCaptured=!0;a.currentCursor="pointer";
this.originalFromPort=this.originalLink.fromPort;this.originalFromNode=this.originalLink.fromNode;this.originalToPort=this.originalLink.toPort;this.originalToNode=this.originalLink.toNode;this.Mw.set(this.originalLink.actualBounds);null!==this.originalLink&&0<this.originalLink.pointsCount&&(null===this.originalLink.fromNode&&(null!==this.temporaryFromPort&&(this.temporaryFromPort.desiredSize=rc),null!==this.temporaryFromNode&&(this.temporaryFromNode.location=this.originalLink.i(0))),null===this.originalLink.toNode&&
(null!==this.temporaryToPort&&(this.temporaryToPort.desiredSize=rc),null!==this.temporaryToNode&&(this.temporaryToNode.location=this.originalLink.i(this.originalLink.pointsCount-1))));this.copyPortProperties(this.originalFromNode,this.originalFromPort,this.temporaryFromNode,this.temporaryFromPort,!1);this.copyPortProperties(this.originalToNode,this.originalToPort,this.temporaryToNode,this.temporaryToPort,!0);a.add(this.temporaryFromNode);a.add(this.temporaryToNode);null!==this.temporaryLink&&(null!==
this.temporaryFromNode&&(this.temporaryLink.fromNode=this.temporaryFromNode),null!==this.temporaryToNode&&(this.temporaryLink.toNode=this.temporaryToNode),this.copyLinkProperties(this.originalLink,this.temporaryLink),this.temporaryLink.Ta(),a.add(this.temporaryLink));this.isActive=!0};
$f.prototype.copyLinkProperties=function(a,b){if(null!==a&&null!==b){b.adjusting=a.adjusting;b.corner=a.corner;var c=a.curve;if(c===$g||c===ah)c=bh;b.curve=c;b.curviness=a.curviness;b.isTreeLink=a.isTreeLink;b.points=a.points;b.routing=a.routing;b.smoothness=a.smoothness;b.fromSpot=a.fromSpot;b.fromEndSegmentLength=a.fromEndSegmentLength;b.fromShortLength=a.fromShortLength;b.toSpot=a.toSpot;b.toEndSegmentLength=a.toEndSegmentLength;b.toShortLength=a.toShortLength}};
$f.prototype.doDeactivate=function(){this.isActive=!1;var a=this.diagram;a.remove(this.temporaryLink);a.remove(this.temporaryFromNode);a.remove(this.temporaryToNode);a.isMouseCaptured=!1;a.currentCursor="";this.yg()};$f.prototype.doStop=function(){Fg.prototype.doStop.call(this);this.handle=null};
$f.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;this.transactionResult=null;var b=this.originalFromNode,c=this.originalFromPort,d=this.originalToNode,e=this.originalToPort,f=this.originalLink;this.targetPort=this.findTargetPort(this.isForwards);if(null!==this.targetPort){var g=this.targetPort.part;g instanceof V&&(this.isForwards?(d=g,e=this.targetPort):(b=g,c=this.targetPort))}else this.isUnconnectedLinkValid?this.isForwards?e=d=null:c=b=null:f=null;null!==f?(this.reconnectLink(f,
this.isForwards?d:b,this.isForwards?e:c,this.isForwards),null===this.targetPort&&(this.isForwards?f.defaultToPoint=a.lastInput.documentPoint:f.defaultFromPoint=a.lastInput.documentPoint,f.Ta()),a.allowSelect&&(f.isSelected=!0),this.transactionResult=this.name,a.ba("LinkRelinked",f,this.isForwards?this.originalToPort:this.originalFromPort)):this.doNoRelink(this.originalLink,this.isForwards);this.originalLink.eq(this.Mw)}this.stopTool()};
$f.prototype.reconnectLink=function(a,b,c,d){c=null!==c&&null!==c.portId?c.portId:"";d?(a.toNode=b,a.toPortId=c):(a.fromNode=b,a.fromPortId=c);return!0};$f.prototype.doNoRelink=function(){};
function yg(a,b,c,d,e){null!==b?(a.copyPortProperties(b,c,a.temporaryFromNode,a.temporaryFromPort,!1),a.diagram.add(a.temporaryFromNode)):a.diagram.remove(a.temporaryFromNode);null!==d?(a.copyPortProperties(d,e,a.temporaryToNode,a.temporaryToPort,!0),a.diagram.add(a.temporaryToNode)):a.diagram.remove(a.temporaryToNode)}
na.Object.defineProperties($f.prototype,{fromHandleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,$f,"fromHandleArchetype");this.w=a}},toHandleArchetype:{configurable:!0,get:function(){return this.Eh},set:function(a){null!==a&&w(a,N,$f,"toHandleArchetype");this.Eh=a}},handle:{configurable:!0,get:function(){return this.l},set:function(a){if(null!==a&&(w(a,N,$f,"handle"),!(a.part instanceof Cf)))throw Error("new handle is not in an Adornment: "+
a);this.l=a}}});$f.className="RelinkingTool";Za("linkingTool",function(){return this.findTool("Linking")},function(a){If(this,"Linking",a,this.mouseMoveTools)});Za("relinkingTool",function(){return this.findTool("Relinking")},function(a){If(this,"Relinking",a,this.mouseDownTools)});
function ch(){0<arguments.length&&Da(ch);vf.call(this);this.name="LinkReshaping";var a=new Gg;a.figure="Rectangle";a.desiredSize=tc;a.fill="lightblue";a.stroke="dodgerblue";this.w=a;a=new Gg;a.figure="Diamond";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.cursor="move";this.L=a;this.ca=3;this.Lt=this.l=null;this.xl=new J;this.es=new G}ma(ch,vf);ch.prototype.iv=function(a){return a&&a.ks&&0!==a.ks.value?a.ks:dh};
ch.prototype.Bm=function(a,b){w(a,N,ch,"setReshapingBehavior:obj");tb(b,ch,ch,"setReshapingBehavior:behavior");a.ks=b};
ch.prototype.updateAdornments=function(a){if(null!==a&&a instanceof Q){var b=null;if(a.isSelected&&!this.diagram.isReadOnly){var c=a.path;null!==c&&a.canReshape()&&a.actualBounds.o()&&a.isVisible()&&c.actualBounds.o()&&c.vf()&&(b=a.ak(this.name),null===b||b.Jw!==a.pointsCount||b.Uw!==a.resegmentable)&&(b=this.makeAdornment(c),null!==b&&(b.Jw=a.pointsCount,b.Uw=a.resegmentable,a.qh(this.name,b)))}null===b&&a.wf(this.name)}};
ch.prototype.makeAdornment=function(a){var b=a.part,c=b.pointsCount,d=b.isOrthogonal,e=null;if(null!==b.points&&1<c){e=new Cf;e.type=W.Link;c=b.firstPickIndex;var f=b.lastPickIndex,g=d?1:0;if(b.resegmentable&&b.computeCurve()!==eh)for(var h=c+g;h<f-g;h++){var k=this.makeResegmentHandle(a,h);null!==k&&(k.segmentIndex=h,k.segmentFraction=.5,k.fromMaxLinks=999,e.add(k))}for(g=c+1;g<f;g++)if(h=this.makeHandle(a,g),null!==h){h.segmentIndex=g;if(g!==c)if(g===c+1&&d){k=b.i(c);var l=b.i(c+1);K.B(k.x,l.x)&&
K.B(k.y,l.y)&&(l=b.i(c-1));K.B(k.x,l.x)?(this.Bm(h,fh),h.cursor="n-resize"):K.B(k.y,l.y)&&(this.Bm(h,gh),h.cursor="w-resize")}else g===f-1&&d?(k=b.i(f-1),l=b.i(f),K.B(k.x,l.x)&&K.B(k.y,l.y)&&(k=b.i(f+1)),K.B(k.x,l.x)?(this.Bm(h,fh),h.cursor="n-resize"):K.B(k.y,l.y)&&(this.Bm(h,gh),h.cursor="w-resize")):g!==f&&(this.Bm(h,hh),h.cursor="move");e.add(h)}e.adornedObject=a}return e};ch.prototype.makeHandle=function(){var a=this.handleArchetype;return null===a?null:a.copy()};
ch.prototype.makeResegmentHandle=function(){var a=this.midHandleArchetype;return null===a?null:a.copy()};ch.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowReshape&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
ch.prototype.doActivate=function(){var a=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name));if(null!==this.handle){var b=this.handle.part.adornedPart;if(b instanceof Q){this.Lt=b;a.isMouseCaptured=!0;this.Ca(this.name);if(b.resegmentable&&999===this.handle.fromMaxLinks){var c=b.points.copy(),d=this.getResegmentingPoint();c.Lb(this.handle.segmentIndex+1,d);b.isOrthogonal&&c.Lb(this.handle.segmentIndex+1,d);b.points=c;b.Mb();b.updateAdornments();
this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name);if(null===this.handle){this.doDeactivate();return}}this.xl=b.i(this.handle.segmentIndex);this.es=b.points.copy();this.isActive=!0}}};ch.prototype.doDeactivate=function(){this.yg();this.Lt=this.handle=null;this.isActive=this.diagram.isMouseCaptured=!1};ch.prototype.doCancel=function(){var a=this.adornedLink;null!==a&&(a.points=this.es);this.stopTool()};ch.prototype.getResegmentingPoint=function(){return this.handle.oa(qd)};
ch.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeReshape(a.lastInput.documentPoint),this.reshape(a))};
ch.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.computeReshape(a.lastInput.documentPoint);this.reshape(b);b=this.adornedLink;if(null!==b&&b.resegmentable){var c=this.handle.segmentIndex,d=b.i(c-1),e=b.i(c),f=b.i(c+1);if(b.isOrthogonal){if(c>b.firstPickIndex+1&&c<b.lastPickIndex-1){var g=b.i(c-2);if(Math.abs(d.x-e.x)<this.resegmentingDistance&&Math.abs(d.y-e.y)<this.resegmentingDistance&&(ih(this,g,d,e,f,!0)||ih(this,g,d,e,f,!1))){var h=b.points.copy();ih(this,g,d,
e,f,!0)?(h.jd(c-2,new J(g.x,(f.y+g.y)/2)),h.jd(c+1,new J(f.x,(f.y+g.y)/2))):(h.jd(c-2,new J((f.x+g.x)/2,g.y)),h.jd(c+1,new J((f.x+g.x)/2,f.y)));h.nb(c);h.nb(c-1);b.points=h;b.Mb()}else g=b.i(c+2),Math.abs(e.x-f.x)<this.resegmentingDistance&&Math.abs(e.y-f.y)<this.resegmentingDistance&&(ih(this,d,e,f,g,!0)||ih(this,d,e,f,g,!1))&&(h=b.points.copy(),ih(this,d,e,f,g,!0)?(h.jd(c-1,new J(d.x,(d.y+g.y)/2)),h.jd(c+2,new J(g.x,(d.y+g.y)/2))):(h.jd(c-1,new J((d.x+g.x)/2,d.y)),h.jd(c+2,new J((d.x+g.x)/2,g.y))),
h.nb(c+1),h.nb(c),b.points=h,b.Mb())}}else g=J.alloc(),K.Ti(d.x,d.y,f.x,f.y,e.x,e.y,g)&&g.De(e)<this.resegmentingDistance*this.resegmentingDistance&&(d=b.points.copy(),d.nb(c),b.points=d,b.Mb()),J.free(g)}a.Ya();this.transactionResult=this.name;a.ba("LinkReshaped",this.adornedLink,this.es)}this.stopTool()};
function ih(a,b,c,d,e,f){return f?Math.abs(b.y-c.y)<a.resegmentingDistance&&Math.abs(c.y-d.y)<a.resegmentingDistance&&Math.abs(d.y-e.y)<a.resegmentingDistance:Math.abs(b.x-c.x)<a.resegmentingDistance&&Math.abs(c.x-d.x)<a.resegmentingDistance&&Math.abs(d.x-e.x)<a.resegmentingDistance}
ch.prototype.reshape=function(a){var b=this.adornedLink;b.Dh();var c=this.handle.segmentIndex,d=this.iv(this.handle);if(b.isOrthogonal)if(c===b.firstPickIndex+1)c=b.firstPickIndex+1,d===fh?(b.N(c,b.i(c-1).x,a.y),b.N(c+1,b.i(c+2).x,a.y)):d===gh&&(b.N(c,a.x,b.i(c-1).y),b.N(c+1,a.x,b.i(c+2).y));else if(c===b.lastPickIndex-1)c=b.lastPickIndex-1,d===fh?(b.N(c-1,b.i(c-2).x,a.y),b.N(c,b.i(c+1).x,a.y)):d===gh&&(b.N(c-1,a.x,b.i(c-2).y),b.N(c,a.x,b.i(c+1).y));else{d=c;var e=b.i(d),f=b.i(d-1),g=b.i(d+1);K.B(f.x,
e.x)&&K.B(e.y,g.y)?(K.B(f.x,b.i(d-2).x)&&!K.B(f.y,b.i(d-2).y)?(b.m(d,a.x,f.y),c++,d++):b.N(d-1,a.x,f.y),K.B(g.y,b.i(d+2).y)&&!K.B(g.x,b.i(d+2).x)?b.m(d+1,g.x,a.y):b.N(d+1,g.x,a.y)):K.B(f.y,e.y)&&K.B(e.x,g.x)?(K.B(f.y,b.i(d-2).y)&&!K.B(f.x,b.i(d-2).x)?(b.m(d,f.x,a.y),c++,d++):b.N(d-1,f.x,a.y),K.B(g.x,b.i(d+2).x)&&!K.B(g.y,b.i(d+2).y)?b.m(d+1,a.x,g.y):b.N(d+1,a.x,g.y)):K.B(f.x,e.x)&&K.B(e.x,g.x)?(K.B(f.x,b.i(d-2).x)&&!K.B(f.y,b.i(d-2).y)?(b.m(d,a.x,f.y),c++,d++):b.N(d-1,a.x,f.y),K.B(g.x,b.i(d+2).x)&&
!K.B(g.y,b.i(d+2).y)?b.m(d+1,a.x,g.y):b.N(d+1,a.x,g.y)):K.B(f.y,e.y)&&K.B(e.y,g.y)&&(K.B(f.y,b.i(d-2).y)&&!K.B(f.x,b.i(d-2).x)?(b.m(d,f.x,a.y),c++,d++):b.N(d-1,f.x,a.y),K.B(g.y,b.i(d+2).y)&&!K.B(g.x,b.i(d+2).x)?b.m(d+1,g.x,a.y):b.N(d+1,g.x,a.y));b.N(c,a.x,a.y)}else b.N(c,a.x,a.y),d=b.fromNode,e=b.fromPort,null!==d&&(f=d.findVisibleNode(),null!==f&&f!==d&&(d=f,e=d.port)),1===c&&b.computeSpot(!0,e).Nb()&&(f=e.oa(qd,J.alloc()),d=b.getLinkPointFromPoint(d,e,f,a,!0,J.alloc()),b.N(0,d.x,d.y),J.free(f),
J.free(d)),d=b.toNode,e=b.toPort,null!==d&&(f=d.findVisibleNode(),null!==f&&f!==d&&(d=f,e=d.port)),c===b.pointsCount-2&&b.computeSpot(!1,e).Nb()&&(c=e.oa(qd,J.alloc()),a=b.getLinkPointFromPoint(d,e,c,a,!1,J.alloc()),b.N(b.pointsCount-1,a.x,a.y),J.free(c),J.free(a));b.pf()};ch.prototype.computeReshape=function(a){var b=this.adornedLink,c=this.handle.segmentIndex;switch(this.iv(this.handle)){case hh:return a;case fh:return new J(b.i(c).x,a.y);case gh:return new J(a.x,b.i(c).y);default:case dh:return b.i(c)}};
na.Object.defineProperties(ch.prototype,{handleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,ch,"handleArchetype");this.w=a}},midHandleArchetype:{configurable:!0,get:function(){return this.L},set:function(a){null!==a&&w(a,N,ch,"midHandleArchetype");this.L=a}},handle:{configurable:!0,get:function(){return this.l},set:function(a){if(null!==a&&(w(a,N,ch,"handle"),!(a.part instanceof Cf)))throw Error("new handle is not in an Adornment: "+
a);this.l=a}},adornedLink:{configurable:!0,get:function(){return this.Lt}},resegmentingDistance:{configurable:!0,get:function(){return this.ca},set:function(a){z(a,"number",ch,"resegmentingDistance");this.ca=a}},originalPoint:{configurable:!0,get:function(){return this.xl}},originalPoints:{configurable:!0,get:function(){return this.es}}});ch.prototype.setReshapingBehavior=ch.prototype.Bm;ch.prototype.getReshapingBehavior=ch.prototype.iv;
var dh=new D(ch,"None",0),gh=new D(ch,"Horizontal",1),fh=new D(ch,"Vertical",2),hh=new D(ch,"All",3);ch.className="LinkReshapingTool";ch.None=dh;ch.Horizontal=gh;ch.Vertical=fh;ch.All=hh;Za("linkReshapingTool",function(){return this.findTool("LinkReshaping")},function(a){If(this,"LinkReshaping",a,this.mouseDownTools)});
function jh(){0<arguments.length&&Da(jh);vf.call(this);this.name="Resizing";this.Tf=(new Zb(1,1)).freeze();this.Sf=(new Zb(9999,9999)).freeze();this.Eg=(new Zb(NaN,NaN)).freeze();this.L=!1;this.be=null;var a=new Gg;a.alignmentFocus=qd;a.figure="Rectangle";a.desiredSize=tc;a.fill="lightblue";a.stroke="dodgerblue";a.strokeWidth=1;a.cursor="pointer";this.w=a;this.l=null;this.xl=new J;this.Lw=new Zb;this.Lo=new J;this.bu=new Zb(0,0);this.au=new Zb(Infinity,Infinity);this.$t=new Zb(1,1);this.Iw=!0}
ma(jh,vf);jh.prototype.updateAdornments=function(a){if(!(null===a||a instanceof Q)){if(a.isSelected&&!this.diagram.isReadOnly){var b=a.resizeObject,c=a.ak(this.name);if(null!==b&&a.canResize()&&a.actualBounds.o()&&a.isVisible()&&b.actualBounds.o()&&b.vf()){if(null===c||c.adornedObject!==b)c=this.makeAdornment(b);if(null!==c){b=b.Li();Cg(a)&&this.updateResizeHandles(c,b);a.qh(this.name,c);return}}}a.wf(this.name)}};
jh.prototype.makeAdornment=function(a){var b=a.part.resizeAdornmentTemplate;if(null===b){b=new Cf;b.type=W.Spot;b.locationSpot=qd;var c=new kh;c.isPanelMain=!0;b.add(c);b.add(this.makeHandle(a,fd));b.add(this.makeHandle(a,hd));b.add(this.makeHandle(a,ud));b.add(this.makeHandle(a,sd));b.add(this.makeHandle(a,Vd));b.add(this.makeHandle(a,Xd));b.add(this.makeHandle(a,de));b.add(this.makeHandle(a,Wd))}else if(lh(b),b=b.copy(),null===b)return null;b.adornedObject=a;return b};
jh.prototype.makeHandle=function(a,b){a=this.handleArchetype;if(null===a)return null;a=a.copy();a.alignment=b;return a};
jh.prototype.updateResizeHandles=function(a,b){if(null!==a)if(!a.alignment.Cb()&&("pointer"===a.cursor||0<a.cursor.indexOf("resize")))a:{var c=a.alignment;c.Nb()&&(c=qd);if(0>=c.x)b=0>=c.y?b+225:1<=c.y?b+135:b+180;else if(1<=c.x)0>=c.y?b+=315:1<=c.y&&(b+=45);else if(0>=c.y)b+=270;else if(1<=c.y)b+=90;else break a;0>b?b+=360:360<=b&&(b-=360);a.cursor=22.5>b?"e-resize":67.5>b?"se-resize":112.5>b?"s-resize":157.5>b?"sw-resize":202.5>b?"w-resize":247.5>b?"nw-resize":292.5>b?"n-resize":337.5>b?"ne-resize":
"e-resize"}else if(a instanceof W)for(a=a.elements;a.next();)this.updateResizeHandles(a.value,b)};jh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowResize&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
jh.prototype.doActivate=function(){var a=this.diagram;null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name));null!==this.handle&&(this.adornedObject=this.handle.part.adornedObject,null!==this.adornedObject&&(this.xl.set(this.adornedObject.oa(this.handle.alignment.vv())),this.Lo.set(this.adornedObject.part.location),this.Lw.set(this.adornedObject.desiredSize),this.$t=this.computeCellSize(),this.bu=this.computeMinSize(),this.au=this.computeMaxSize(),a.isMouseCaptured=
!0,this.Iw=a.animationManager.isEnabled,a.animationManager.isEnabled=!1,this.Ca(this.name),this.isActive=!0))};jh.prototype.doDeactivate=function(){var a=this.diagram;this.yg();this.be=this.handle=null;this.isActive=a.isMouseCaptured=!1;a.animationManager.isEnabled=this.Iw};jh.prototype.doCancel=function(){null!==this.adornedObject&&(this.adornedObject.desiredSize=this.originalDesiredSize,this.adornedObject.part.location=this.originalLocation);this.stopTool()};
jh.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive){var b=this.bu,c=this.au,d=this.$t,e=this.adornedObject.$s(a.lastInput.documentPoint,J.alloc()),f=this.computeReshape();b=this.computeResize(e,this.handle.alignment,b,c,d,f);this.resize(b);a.hd();J.free(e)}};
jh.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){var b=this.bu,c=this.au,d=this.$t,e=this.adornedObject.$s(a.lastInput.documentPoint,J.alloc()),f=this.computeReshape();b=this.computeResize(e,this.handle.alignment,b,c,d,f);this.resize(b);J.free(e);a.Ya();this.transactionResult=this.name;a.ba("PartResized",this.adornedObject,this.originalDesiredSize)}this.stopTool()};
jh.prototype.resize=function(a){var b=this.diagram,c=this.adornedObject,d=c.part;c.desiredSize=a.size;d.cc();a=this.adornedObject.oa(this.handle.alignment.vv());d instanceof wg?(c=new G,c.add(d),b.moveParts(c,this.xl.copy().Yd(a),!0)):d.location=d.location.copy().Yd(a).add(this.xl)};
jh.prototype.computeResize=function(a,b,c,d,e,f){b.Nb()&&(b=qd);var g=this.adornedObject.naturalBounds,h=g.x,k=g.y,l=g.x+g.width,m=g.y+g.height,n=1;if(!f){n=g.width;var p=g.height;0>=n&&(n=1);0>=p&&(p=1);n=p/n}p=J.alloc();K.Xp(a.x,a.y,h,k,e.width,e.height,p);a=g.copy();0>=b.x?0>=b.y?(a.x=Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=Math.max(l-a.x,c.width),a.y=Math.max(p.y,m-d.height),a.y=Math.min(a.y,m-c.height),a.height=Math.max(m-a.y,c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*
a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),a.x=l-a.width,a.y=m-a.height)):1<=b.y?(a.x=Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=Math.max(l-a.x,c.width),a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),a.x=l-a.width)):(a.x=
Math.max(p.x,l-d.width),a.x=Math.min(a.x,l-c.width),a.width=l-a.x,f||(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n,a.y=k+.5*(m-k-a.height))):1<=b.x?0>=b.y?(a.width=Math.max(Math.min(p.x-h,d.width),c.width),a.y=Math.max(p.y,m-d.height),a.y=Math.min(a.y,m-c.height),a.height=Math.max(m-a.y,c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width),
a.y=m-a.height)):1<=b.y?(a.width=Math.max(Math.min(p.x-h,d.width),c.width),a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(1<=a.height/a.width?(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n):(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width))):(a.width=Math.max(Math.min(p.x-h,d.width),c.width),f||(a.height=Math.max(Math.min(n*a.width,d.height),c.height),a.width=a.height/n,a.y=k+.5*(m-k-a.height))):0>=b.y?(a.y=Math.max(p.y,m-d.height),
a.y=Math.min(a.y,m-c.height),a.height=m-a.y,f||(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width,a.x=h+.5*(l-h-a.width))):1<=b.y&&(a.height=Math.max(Math.min(p.y-k,d.height),c.height),f||(a.width=Math.max(Math.min(a.height/n,d.width),c.width),a.height=n*a.width,a.x=h+.5*(l-h-a.width)));J.free(p);return a};jh.prototype.computeReshape=function(){var a=mh;this.adornedObject instanceof Gg&&(a=nh(this.adornedObject));return!(a===oh||this.diagram.lastInput.shift)};
jh.prototype.computeMinSize=function(){var a=this.adornedObject.minSize.copy(),b=this.minSize;!isNaN(b.width)&&b.width>a.width&&(a.width=b.width);!isNaN(b.height)&&b.height>a.height&&(a.height=b.height);return a};jh.prototype.computeMaxSize=function(){var a=this.adornedObject.maxSize.copy(),b=this.maxSize;!isNaN(b.width)&&b.width<a.width&&(a.width=b.width);!isNaN(b.height)&&b.height<a.height&&(a.height=b.height);return a};
jh.prototype.computeCellSize=function(){var a=new Zb(NaN,NaN),b=this.adornedObject.part;null!==b&&(b=b.resizeCellSize,!isNaN(b.width)&&0<b.width&&(a.width=b.width),!isNaN(b.height)&&0<b.height&&(a.height=b.height));b=this.cellSize;isNaN(a.width)&&!isNaN(b.width)&&0<b.width&&(a.width=b.width);isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height);b=this.diagram;(isNaN(a.width)||isNaN(a.height))&&b&&(b=b.grid,null!==b&&b.visible&&this.isGridSnapEnabled&&(b=b.gridCellSize,isNaN(a.width)&&
!isNaN(b.width)&&0<b.width&&(a.width=b.width),isNaN(a.height)&&!isNaN(b.height)&&0<b.height&&(a.height=b.height)));if(isNaN(a.width)||0===a.width||Infinity===a.width)a.width=1;if(isNaN(a.height)||0===a.height||Infinity===a.height)a.height=1;return a};
na.Object.defineProperties(jh.prototype,{handleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,jh,"handleArchetype");this.w=a}},handle:{configurable:!0,get:function(){return this.l},set:function(a){if(null!==a&&(w(a,N,jh,"handle"),!(a.part instanceof Cf)))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{configurable:!0,get:function(){return this.be},set:function(a){if(null!==a&&(w(a,N,
jh,"handle"),a.part instanceof Cf))throw Error("new handle must not be in an Adornment: "+a);this.be=a}},minSize:{configurable:!0,get:function(){return this.Tf},set:function(a){w(a,Zb,jh,"minSize");if(!this.Tf.A(a)){var b=a.width;isNaN(b)&&(b=0);a=a.height;isNaN(a)&&(a=0);this.Tf.h(b,a)}}},maxSize:{configurable:!0,get:function(){return this.Sf},set:function(a){w(a,Zb,jh,"maxSize");if(!this.Sf.A(a)){var b=a.width;isNaN(b)&&(b=Infinity);a=a.height;isNaN(a)&&(a=Infinity);
this.Sf.h(b,a)}}},cellSize:{configurable:!0,get:function(){return this.Eg},set:function(a){w(a,Zb,jh,"cellSize");this.Eg.A(a)||this.Eg.assign(a)}},isGridSnapEnabled:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"boolean",jh,"isGridSnapEnabled");this.L=a}},originalDesiredSize:{configurable:!0,get:function(){return this.Lw}},originalLocation:{configurable:!0,get:function(){return this.Lo}}});jh.className="ResizingTool";
Za("resizingTool",function(){return this.findTool("Resizing")},function(a){If(this,"Resizing",a,this.mouseDownTools)});function ph(){0<arguments.length&&Da(ph);vf.call(this);this.name="Rotating";this.Na=45;this.Ma=2;this.Lo=new J;this.be=null;var a=new Gg;a.figure="Ellipse";a.desiredSize=uc;a.fill="lightblue";a.stroke="dodgerblue";a.strokeWidth=1;a.cursor="pointer";this.w=a;this.l=null;this.Kw=0;this.vu=new J(NaN,NaN);this.L=0;this.ca=50}ma(ph,vf);
ph.prototype.updateAdornments=function(a){if(null!==a){if(a.zh()){var b=a.rotateObject;if(b===a||b===a.path||b.isPanelMain)return}if(a.isSelected&&!this.diagram.isReadOnly&&(b=a.rotateObject,null!==b&&a.canRotate()&&a.actualBounds.o()&&a.isVisible()&&b.actualBounds.o()&&b.vf())){var c=a.ak(this.name);if(null===c||c.adornedObject!==b)c=this.makeAdornment(b);if(null!==c){c.angle=b.Li();null===c.placeholder&&(c.location=this.computeAdornmentLocation(b));a.qh(this.name,c);return}}a.wf(this.name)}};
ph.prototype.makeAdornment=function(a){var b=a.part.rotateAdornmentTemplate;if(null===b){b=new Cf;b.type=W.Position;b.locationSpot=qd;var c=this.handleArchetype;null!==c&&b.add(c.copy())}else if(lh(b),b=b.copy(),null===b)return null;b.adornedObject=a;return b};ph.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.isReadOnly&&a.allowRotate&&a.lastInput.left?null!==this.findToolHandleAt(a.firstInput.documentPoint,this.name):!1};
ph.prototype.doActivate=function(){var a=this.diagram;if(null===this.adornedObject){null===this.handle&&(this.handle=this.findToolHandleAt(a.firstInput.documentPoint,this.name));if(null===this.handle)return;this.adornedObject=this.handle.part.adornedObject}null!==this.adornedObject&&(this.Kw=this.adornedObject.angle,this.vu=this.computeRotationPoint(this.adornedObject),this.Lo=this.adornedObject.part.location.copy(),a.isMouseCaptured=!0,a.delaysLayout=!0,this.Ca(this.name),this.isActive=!0)};
ph.prototype.computeRotationPoint=function(a){var b=a.part,c=b.locationObject;return b.rotationSpot.Za()?a.oa(b.rotationSpot):a===b||a===c?c.oa(b.locationSpot):a.oa(qd)};
ph.prototype.computeAdornmentLocation=function(a){var b=this.rotationPoint;b.o()||(b=this.computeRotationPoint(a));b=a.$s(b);var c=this.handleAngle;0>c?c+=360:360<=c&&(c-=360);c=Math.round(45*Math.round(c/45));var d=this.handleDistance;0===c?b.x=a.naturalBounds.width+d:45===c?(b.x=a.naturalBounds.width+d,b.y=a.naturalBounds.height+d):90===c?b.y=a.naturalBounds.height+d:135===c?(b.x=-d,b.y=a.naturalBounds.height+d):180===c?b.x=-d:225===c?(b.x=-d,b.y=-d):270===c?b.y=-d:315===c&&(b.x=a.naturalBounds.width+
d,b.y=-d);return a.oa(b)};ph.prototype.doDeactivate=function(){var a=this.diagram;this.yg();this.be=this.handle=null;this.vu=new J(NaN,NaN);this.isActive=a.isMouseCaptured=!1};ph.prototype.doCancel=function(){this.diagram.delaysLayout=!1;this.rotate(this.originalAngle);this.stopTool()};ph.prototype.doMouseMove=function(){var a=this.diagram;this.isActive&&(a=this.computeRotate(a.lastInput.documentPoint),this.rotate(a))};
ph.prototype.doMouseUp=function(){var a=this.diagram;if(this.isActive){a.delaysLayout=!1;var b=this.computeRotate(a.lastInput.documentPoint);this.rotate(b);a.Ya();this.transactionResult=this.name;a.ba("PartRotated",this.adornedObject,this.originalAngle)}this.stopTool()};
ph.prototype.rotate=function(a){E&&B(a,ph,"rotate:newangle");var b=this.adornedObject;if(null!==b){b.angle=a;b=b.part;b.cc();var c=b.locationObject,d=b.rotateObject;if(c===d||c.tg(d))c=this.Lo.copy(),b.location=c.Yd(this.rotationPoint).rotate(a-this.originalAngle).add(this.rotationPoint)}};
ph.prototype.computeRotate=function(a){a=this.rotationPoint.Xa(a)-this.handleAngle;var b=this.adornedObject.panel;null!==b&&(a-=b.Li());360<=a?a-=360:0>a&&(a+=360);b=Math.min(Math.abs(this.snapAngleMultiple),180);var c=Math.min(Math.abs(this.snapAngleEpsilon),b/2);!this.diagram.lastInput.shift&&0<b&&0<c&&(a%b<c?a=Math.floor(a/b)*b:a%b>b-c&&(a=(Math.floor(a/b)+1)*b));360<=a?a-=360:0>a&&(a+=360);return a};
na.Object.defineProperties(ph.prototype,{handleArchetype:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,ph,"handleArchetype");this.w=a}},handle:{configurable:!0,get:function(){return this.l},set:function(a){if(null!==a&&(w(a,N,ph,"handle"),!(a.part instanceof Cf)))throw Error("new handle is not in an Adornment: "+a);this.l=a}},adornedObject:{configurable:!0,get:function(){return this.be},set:function(a){if(null!==a&&(w(a,N,
ph,"handle"),a.part instanceof Cf))throw Error("new handle must not be in an Adornment: "+a);this.be=a}},snapAngleMultiple:{configurable:!0,get:function(){return this.Na},set:function(a){z(a,"number",ph,"snapAngleMultiple");this.Na=a}},snapAngleEpsilon:{configurable:!0,get:function(){return this.Ma},set:function(a){z(a,"number",ph,"snapAngleEpsilon");this.Ma=a}},originalAngle:{configurable:!0,get:function(){return this.Kw}},rotationPoint:{configurable:!0,
enumerable:!0,get:function(){return this.vu}},handleAngle:{configurable:!0,get:function(){return this.L},set:function(a){z(a,"number",ph,"handleAngle");this.L=a}},handleDistance:{configurable:!0,get:function(){return this.ca},set:function(a){z(a,"number",ph,"handleDistance");this.ca=a}}});ph.className="RotatingTool";Za("rotatingTool",function(){return this.findTool("Rotating")},function(a){If(this,"Rotating",a,this.mouseDownTools)});
function qh(){vf.call(this);0<arguments.length&&Da(qh);this.name="ClickSelecting"}ma(qh,vf);qh.prototype.canStart=function(){return!this.isEnabled||this.isBeyondDragSize()?!1:!0};qh.prototype.doMouseUp=function(){this.isActive&&(this.standardMouseSelect(),!this.standardMouseClick()&&this.diagram.lastInput.isTouchEvent&&this.diagram.toolManager.doToolTip());this.stopTool()};qh.className="ClickSelectingTool";function rh(){vf.call(this);0<arguments.length&&Da(rh);this.name="Action";this.wk=null}
ma(rh,vf);rh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram,b=a.lastInput,c=a.Tb(b.documentPoint,function(a){for(;null!==a.panel&&!a.isActionable;)a=a.panel;return a});if(null!==c){if(!c.isActionable)return!1;this.wk=c;a.Lk=a.Tb(b.documentPoint,null,null);return!0}return!1};rh.prototype.doMouseDown=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.wk;null!==b&&(a.targetObject=b,null!==b.actionDown&&b.actionDown(a,b))}else this.canStart()&&this.doActivate()};
rh.prototype.doMouseMove=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.wk;null!==b&&(a.targetObject=b,null!==b.actionMove&&b.actionMove(a,b))}};rh.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram.lastInput,b=this.wk;if(null===b)return;a.targetObject=b;null!==b.actionUp&&b.actionUp(a,b);this.standardMouseClick(function(a){for(;null!==a.panel&&(!a.isActionable||a!==b);)a=a.panel;return a},function(a){return a===b})}this.stopTool()};
rh.prototype.doCancel=function(){var a=this.diagram.lastInput,b=this.wk;null!==b&&(a.targetObject=b,null!==b.actionCancel&&b.actionCancel(a,b),this.stopTool())};rh.prototype.doStop=function(){this.wk=null};rh.className="ActionTool";function sh(){vf.call(this);0<arguments.length&&Da(sh);this.name="ClickCreating";this.bj=null;this.w=!0;this.l=!1;this.Cw=new J(0,0)}ma(sh,vf);
sh.prototype.canStart=function(){if(!this.isEnabled||null===this.archetypeNodeData)return!1;var a=this.diagram;if(a.isReadOnly||a.isModelReadOnly||!a.allowInsert||!a.lastInput.left||this.isBeyondDragSize())return!1;if(this.isDoubleClick){if(1===a.lastInput.clickCount&&(this.Cw=a.lastInput.viewPoint.copy()),2!==a.lastInput.clickCount||this.isBeyondDragSize(this.Cw))return!1}else if(1!==a.lastInput.clickCount)return!1;return a.currentTool!==this&&null!==a.dm(a.lastInput.documentPoint,!0)?!1:!0};
sh.prototype.doMouseUp=function(){var a=this.diagram;this.isActive&&this.insertPart(a.lastInput.documentPoint);this.stopTool()};
sh.prototype.insertPart=function(a){var b=this.diagram,c=this.archetypeNodeData;if(null===c)return null;this.Ca(this.name);var d=null;c instanceof R?c.Ob()&&(lh(c),d=c.copy(),null!==d&&b.add(d)):null!==c&&(c=b.model.copyNodeData(c),Ia(c)&&(b.model.lf(c),d=b.xc(c)));null!==d&&(c=J.allocAt(a.x,a.y),this.isGridSnapEnabled&&th(this.diagram,d,a,c),d.location=c,b.allowSelect&&b.select(d),J.free(c));b.Ya();this.transactionResult=this.name;b.ba("PartCreated",d);this.yg();return d};
na.Object.defineProperties(sh.prototype,{archetypeNodeData:{configurable:!0,get:function(){return this.bj},set:function(a){null!==a&&z(a,"object",sh,"archetypeNodeData");this.bj=a}},isDoubleClick:{configurable:!0,get:function(){return this.w},set:function(a){z(a,"boolean",sh,"isDoubleClick");this.w=a}},isGridSnapEnabled:{configurable:!0,get:function(){return this.l},set:function(a){z(a,"boolean",sh,"isGridSnapEnabled");this.l=a}}});sh.className="ClickCreatingTool";
function uh(){vf.call(this);0<arguments.length&&Da(uh);this.name="DragSelecting";this.Sk=175;this.w=!1;var a=new R;a.layerName="Tool";a.selectable=!1;var b=new Gg;b.name="SHAPE";b.figure="Rectangle";b.fill=null;b.stroke="magenta";a.add(b);this.l=a}ma(uh,vf);
uh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(!a.allowSelect)return!1;var b=a.lastInput;return!b.left||a.currentTool!==this&&(!this.isBeyondDragSize()||b.timestamp-a.firstInput.timestamp<this.delay||null!==a.dm(b.documentPoint,!0))?!1:!0};uh.prototype.doActivate=function(){var a=this.diagram;this.isActive=!0;a.isMouseCaptured=!0;a.skipsUndoManager=!0;a.add(this.box);this.doMouseMove()};
uh.prototype.doDeactivate=function(){var a=this.diagram;a.yf();a.remove(this.box);a.skipsUndoManager=!1;this.isActive=a.isMouseCaptured=!1};uh.prototype.doMouseMove=function(){var a=this.diagram;if(this.isActive&&null!==this.box){var b=this.computeBoxBounds(),c=this.box.bb("SHAPE");null===c&&(c=this.box.Bb());var d=Zb.alloc().h(b.width,b.height);b=J.alloc().h(b.x,b.y);c.desiredSize=d;this.box.position=b;Zb.free(d);J.free(b);(a.allowHorizontalScroll||a.allowVerticalScroll)&&a.Rs(a.lastInput.viewPoint)}};
uh.prototype.doMouseUp=function(){if(this.isActive){var a=this.diagram;a.remove(this.box);try{a.currentCursor="wait",a.ba("ChangingSelection",a.selection),this.selectInRect(this.computeBoxBounds()),a.ba("ChangedSelection",a.selection)}finally{a.currentCursor=""}}this.stopTool()};uh.prototype.computeBoxBounds=function(){var a=this.diagram;return new L(a.firstInput.documentPoint,a.lastInput.documentPoint)};
uh.prototype.selectInRect=function(a){var b=this.diagram,c=b.lastInput;a=b.ox(a,this.isPartialInclusion);if(kb?c.meta:c.control)if(c.shift)for(a=a.iterator;a.next();)b=a.value,b.isSelected&&(b.isSelected=!1);else for(a=a.iterator;a.next();)b=a.value,b.isSelected=!b.isSelected;else if(c.shift)for(a=a.iterator;a.next();)b=a.value,b.isSelected||(b.isSelected=!0);else{c=new G;for(b=b.selection.iterator;b.next();){var d=b.value;a.contains(d)||c.add(d)}for(b=c.iterator;b.next();)b.value.isSelected=!1;for(a=
a.iterator;a.next();)b=a.value,b.isSelected||(b.isSelected=!0)}};na.Object.defineProperties(uh.prototype,{delay:{configurable:!0,get:function(){return this.Sk},set:function(a){z(a,"number",uh,"delay");this.Sk=a}},isPartialInclusion:{configurable:!0,get:function(){return this.w},set:function(a){z(a,"boolean",uh,"isPartialInclusion");this.w=a}},box:{configurable:!0,get:function(){return this.l},set:function(a){null!==a&&w(a,R,uh,"box");this.l=a}}});
uh.className="DragSelectingTool";function vh(){vf.call(this);0<arguments.length&&Da(vh);this.name="Panning";this.qu=new J;this.hy=new J;this.Dg=!1;var a=this;this.Ow=function(){qa.document.removeEventListener("scroll",a.Ow,!1);a.stopTool()}}ma(vh,vf);vh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return!a.allowHorizontalScroll&&!a.allowVerticalScroll||!a.lastInput.left||a.currentTool!==this&&!this.isBeyondDragSize()?!1:!0};
vh.prototype.doActivate=function(){var a=this.diagram;this.Dg?(a.lastInput.bubbles=!0,qa.document.addEventListener("scroll",this.Ow,!1)):(a.currentCursor="move",a.isMouseCaptured=!0,this.qu.assign(a.position));this.isActive=!0};vh.prototype.doDeactivate=function(){var a=this.diagram;a.currentCursor="";this.isActive=a.isMouseCaptured=!1};vh.prototype.doCancel=function(){var a=this.diagram;a.position=this.qu;a.isMouseCaptured=!1;this.stopTool()};vh.prototype.doMouseMove=function(){this.move()};
vh.prototype.doMouseUp=function(){this.move();this.stopTool()};vh.prototype.move=function(){var a=this.diagram;if(this.isActive&&a)if(this.Dg)a.lastInput.bubbles=!0;else{var b=a.position,c=a.firstInput.documentPoint,d=a.lastInput.documentPoint,e=b.x+c.x-d.x;c=b.y+c.y-d.y;a.allowHorizontalScroll||(e=b.x);a.allowVerticalScroll||(c=b.y);a.position=this.hy.h(e,c)}};
na.Object.defineProperties(vh.prototype,{bubbles:{configurable:!0,get:function(){return this.Dg},set:function(a){z(a,"boolean",vh,"bubbles");this.Dg=a}},originalPosition:{configurable:!0,get:function(){return this.qu}}});vh.className="PanningTool";Za("clickCreatingTool",function(){return this.findTool("ClickCreating")},function(a){If(this,"ClickCreating",a,this.mouseUpTools)});
Za("clickSelectingTool",function(){return this.findTool("ClickSelecting")},function(a){If(this,"ClickSelecting",a,this.mouseUpTools)});Za("panningTool",function(){return this.findTool("Panning")},function(a){If(this,"Panning",a,this.mouseMoveTools)});Za("dragSelectingTool",function(){return this.findTool("DragSelecting")},function(a){If(this,"DragSelecting",a,this.mouseMoveTools)});Za("actionTool",function(){return this.findTool("Action")},function(a){If(this,"Action",a,this.mouseDownTools)});
function Hf(){this.ca=this.L=this.l=this.w=null}
na.Object.defineProperties(Hf.prototype,{mainElement:{configurable:!0,get:function(){return this.L},set:function(a){null!==a&&w(a,HTMLElement,Hf,"mainElement");this.L=a}},show:{configurable:!0,get:function(){return this.w},set:function(a){this.w!==a&&(null!==a&&z(a,"function",Hf,"show"),this.w=a)}},hide:{configurable:!0,get:function(){return this.l},set:function(a){this.l!==a&&(null!==a&&z(a,"function",Hf,"hide"),this.l=a)}},valueFunction:{configurable:!0,
enumerable:!0,get:function(){return this.ca},set:function(a){this.ca=a}}});Hf.className="HTMLInfo";function wh(a,b,c){this.text=a;this.ex=b;this.visible=c}wh.className="ContextMenuButtonInfo";function xh(){vf.call(this);0<arguments.length&&Da(xh);this.name="ContextMenu";this.w=this.Rt=this.l=null;this.Hw=new J;this.St=null;var a=this;this.Fu=function(){a.stopTool()}}ma(xh,vf);
function yh(a){var b=new Hf;b.show=function(a,b,c){c.showDefaultContextMenu()};b.hide=function(a,b){b.hideDefaultContextMenu()};zh=b;a.Fu=function(){a.stopTool()};b=xa("div");var c=xa("div");b.style.cssText="top: 0px;z-index:10002;position: fixed;display: none;text-align: center;left: 25%;width: 50%;background-color: #F5F5F5;padding: 16px;border: 16px solid #444;border-radius: 10px;margin-top: 10px";c.style.cssText="z-index:10001;position: fixed;display: none;top: 0;left: 0;width: 100%;height: 100%;background-color: black;opacity: 0.8;";
var d=xa("style");qa.document.getElementsByTagName("head")[0].appendChild(d);d.sheet.insertRule(".goCXul { list-style: none; }",0);d.sheet.insertRule(".goCXli {font:700 1.5em Helvetica, Arial, sans-serif;position: relative;min-width: 60px; }",0);d.sheet.insertRule(".goCXa {color: #444;display: inline-block;padding: 4px;text-decoration: none;margin: 2px;border: 1px solid gray;border-radius: 10px; }",0);b.addEventListener("contextmenu",Ah,!1);b.addEventListener("selectstart",Ah,!1);c.addEventListener("contextmenu",
Ah,!1);b.className="goCXforeground";c.className="goCXbackground";qa.document.body&&(qa.document.body.appendChild(b),qa.document.body.appendChild(c));Bh=b;Ch=c;Dh=!0}function Ah(a){a.preventDefault();return!1}xh.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;return this.isBeyondDragSize()||!a.lastInput.right?!1:a.lastInput.isTouchEvent&&null!==this.defaultTouchContextMenu||null!==this.findObjectWithContextMenu()?!0:!1};xh.prototype.doStart=function(){this.Hw.set(this.diagram.firstInput.documentPoint)};
xh.prototype.doStop=function(){this.hideContextMenu();this.currentObject=null};xh.prototype.findObjectWithContextMenu=function(a){void 0===a&&(a=null);var b=this.diagram,c=b.lastInput,d=null;a instanceof P||(a instanceof N?d=a:d=b.Tb(c.documentPoint,null,function(a){return!a.layer.isTemporary}));if(null!==d){for(a=d;null!==a;){if(null!==a.contextMenu)return a;a=a.panel}if(b.lastInput.isTouchEvent&&this.defaultTouchContextMenu)return d.part}else if(null!==b.contextMenu)return b;return null};
xh.prototype.doActivate=function(){};xh.prototype.doMouseDown=function(){vf.prototype.doMouseDown.call(this);if(this.isActive&&this.currentContextMenu instanceof Cf){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doMouseDown(),a.doDeactivate())}this.diagram.toolManager.mouseDownTools.contains(this)&&Eh(this)};
xh.prototype.doMouseUp=function(){if(this.isActive&&this.currentContextMenu instanceof Cf){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.canStart()&&(a.doActivate(),a.doCancel(),a.doDeactivate())}Eh(this)};
function Eh(a){var b=a.diagram;if(a.isActive){var c=a.currentContextMenu;if(null!==c){if(!(c instanceof Hf)){var d=b.Tb(b.lastInput.documentPoint,null,null);null!==d&&d.tg(c)&&a.standardMouseClick(null,null)}a.stopTool();a.canStart()&&(b.currentTool=a,a.doMouseUp())}}else a.canStart()&&(Fh(a,!0),a.isActive||a.stopTool())}
function Fh(a,b,c){void 0===c&&(c=null);b&&a.standardMouseSelect();if(!a.standardMouseClick())if(a.isActive=!0,b=zh,null===c&&(c=a.findObjectWithContextMenu()),null!==c){var d=c.contextMenu;null!==d?(a.currentObject=c instanceof N?c:null,a.showContextMenu(d,a.currentObject)):null!==b&&a.showContextMenu(b,a.currentObject)}else null!==b&&a.showContextMenu(b,null)}xh.prototype.doMouseMove=function(){var a=this.diagram.toolManager.findTool("Action");null!==a&&a.doMouseMove();this.isActive&&this.diagram.toolManager.doMouseMove()};
xh.prototype.showContextMenu=function(a,b){!E||a instanceof Cf||a instanceof Hf||v("showContextMenu:contextMenu must be an Adornment or HTMLInfo.");null!==b&&w(b,N,xh,"showContextMenu:obj");var c=this.diagram;a!==this.currentContextMenu&&this.hideContextMenu();if(a instanceof Cf){a.layerName="Tool";a.selectable=!1;a.scale=1/c.scale;a.category=this.name;null!==a.placeholder&&(a.placeholder.scale=c.scale);var d=a.diagram;null!==d&&d!==c&&d.remove(a);c.add(a);null!==b?a.adornedObject=b:a.data=c.model;
a.cc();this.positionContextMenu(a,b)}else a instanceof Hf&&a.show(b,c,this);this.currentContextMenu=a};xh.prototype.positionContextMenu=function(a){if(null===a.placeholder){var b=this.diagram,c=b.lastInput.documentPoint.copy(),d=a.measuredBounds,e=b.viewportBounds;b.lastInput.isTouchEvent&&(c.x-=d.width);c.x+d.width>e.right&&(c.x-=d.width+5/b.scale);c.x<e.x&&(c.x=e.x);c.y+d.height>e.bottom&&(c.y-=d.height+5/b.scale);c.y<e.y&&(c.y=e.y);a.position=c}};
xh.prototype.hideContextMenu=function(){var a=this.diagram,b=this.currentContextMenu;null!==b&&(b instanceof Cf?(a.remove(b),null!==this.Rt&&this.Rt.wf(b.category),b.data=null,b.adornedObject=null):b instanceof Hf&&(null!==b.hide?b.hide(a,this):null!==b.mainElement&&(b.mainElement.style.display="none")),this.currentContextMenu=null,this.standardMouseOver())};
function Gh(){var a=new G;a.add(new wh("Copy",function(a){a.commandHandler.copySelection()},function(a){return a.commandHandler.canCopySelection()}));a.add(new wh("Cut",function(a){a.commandHandler.cutSelection()},function(a){return a.commandHandler.canCutSelection()}));a.add(new wh("Delete",function(a){a.commandHandler.deleteSelection()},function(a){return a.commandHandler.canDeleteSelection()}));a.add(new wh("Paste",function(a){a.commandHandler.pasteSelection(a.lastInput.documentPoint)},function(a){return a.commandHandler.canPasteSelection()}));
a.add(new wh("Select All",function(a){a.commandHandler.selectAll()},function(a){return a.commandHandler.canSelectAll()}));a.add(new wh("Undo",function(a){a.commandHandler.undo()},function(a){return a.commandHandler.canUndo()}));a.add(new wh("Redo",function(a){a.commandHandler.redo()},function(a){return a.commandHandler.canRedo()}));a.add(new wh("Scroll To Part",function(a){a.commandHandler.scrollToPart()},function(a){return a.commandHandler.canScrollToPart()}));a.add(new wh("Zoom To Fit",function(a){a.commandHandler.zoomToFit()},
function(a){return a.commandHandler.canZoomToFit()}));a.add(new wh("Reset Zoom",function(a){a.commandHandler.resetZoom()},function(a){return a.commandHandler.canResetZoom()}));a.add(new wh("Group Selection",function(a){a.commandHandler.groupSelection()},function(a){return a.commandHandler.canGroupSelection()}));a.add(new wh("Ungroup Selection",function(a){a.commandHandler.ungroupSelection()},function(a){return a.commandHandler.canUngroupSelection()}));a.add(new wh("Edit Text",function(a){a.commandHandler.editTextBlock()},
function(a){return a.commandHandler.canEditTextBlock()}));return a}
xh.prototype.showDefaultContextMenu=function(){var a=this.diagram;null===this.St&&(this.St=Gh());Bh.innerHTML="";Ch.addEventListener("click",this.Fu,!1);var b=this,c=xa("ul");c.className="goCXul";Bh.appendChild(c);c.innerHTML="";for(var d=this.St.iterator;d.next();){var e=d.value,f=e.visible;if("function"===typeof e.ex&&("function"!==typeof f||f(a))){f=xa("li");f.className="goCXli";var g=xa("a");g.className="goCXa";g.href="#";g.Xx=e.ex;g.addEventListener("click",function(c){this.Xx(a);b.stopTool();
c.preventDefault();return!1},!1);g.textContent=e.text;f.appendChild(g);c.appendChild(f)}}Bh.style.display="block";Ch.style.display="block"};xh.prototype.hideDefaultContextMenu=function(){null!==this.currentContextMenu&&this.currentContextMenu===zh&&(Bh.style.display="none",Ch.style.display="none",Ch.removeEventListener("click",this.Fu,!1),this.currentContextMenu=null)};
na.Object.defineProperties(xh.prototype,{currentContextMenu:{configurable:!0,get:function(){return this.l},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ContextMenuTool.currentContextMenu must be an Adornment or HTMLInfo.");this.l=a;this.Rt=a instanceof Cf?a.adornedPart:null}},defaultTouchContextMenu:{configurable:!0,get:function(){!1===Dh&&null===zh&&Hh&&yh(this);return zh},set:function(a){!E||null===a||a instanceof Cf||a instanceof Hf||v("ContextMenuTool.defaultTouchContextMenu must be an Adornment or HTMLInfo.");
null===a&&(Dh=!0);zh=a}},currentObject:{configurable:!0,get:function(){return this.w},set:function(a){null!==a&&w(a,N,xh,"currentObject");this.w=a}},mouseDownPoint:{configurable:!0,get:function(){return this.Hw}}});var zh=null,Dh=!1,Ch=null,Bh=null;xh.className="ContextMenuTool";Za("contextMenuTool",function(){return this.findTool("ContextMenu")},function(a){If(this,"ContextMenu",a,this.mouseUpTools)});
function Ih(){0<arguments.length&&Da(Ih);vf.call(this);this.name="TextEditing";this.kh=new Jh;this.Na=null;this.Ma=Kh;this.xi=null;this.na=Lh;this.L=1;this.ca=!0;this.w=null;this.l=new Hf;this.Tt=null;Mh(this,this.l)}ma(Ih,vf);
function Mh(a,b){if(Hh){var c=xa("textarea");a.Tt=c;c.addEventListener("input",function(){if(null!==a.textBlock){var b=a.zx(this.value);this.style.width=20+b.measuredBounds.width*this.cA+"px";this.rows=b.lineCount}},!1);c.addEventListener("keydown",function(b){if(null!==a.textBlock){var c=b.which;13===c?(!1===a.textBlock.isMultiline&&b.preventDefault(),a.acceptText(Nh)):9===c?(a.acceptText(Oh),b.preventDefault()):27===c&&(a.doCancel(),null!==a.diagram&&a.diagram.doFocus())}},!1);c.addEventListener("focus",
function(){if(null!==a.currentTextEditor&&a.state!==Lh){var b=a.Tt;a.na===Ph&&(a.na=Qh);"function"===typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}},!1);c.addEventListener("blur",function(){if(null!==a.currentTextEditor&&a.state!==Lh){var b=a.Tt;"function"===typeof b.focus&&b.focus();"function"===typeof b.select&&a.selectsTextOnActivate&&(b.select(),b.setSelectionRange(0,9999))}},!1);b.valueFunction=function(){return c.value};b.mainElement=c;b.show=function(a,
b,f){if(a instanceof Jh&&f instanceof Ih)if(f.state===Rh)c.style.border="3px solid red",c.focus();else{var d=a.oa(qd),e=b.position,k=b.scale,l=a.Ee()*k;l<f.minimumEditorScale&&(l=f.minimumEditorScale);var m=a.naturalBounds.width*l+6,n=a.naturalBounds.height*l+2,p=(d.x-e.x)*k;d=(d.y-e.y)*k;c.value=a.text;b.div.style.font=a.font;c.style.position="absolute";c.style.zIndex="100";c.style.font="inherit";c.style.fontSize=100*l+"%";c.style.lineHeight="normal";c.style.width=m+"px";c.style.left=(p-m/2|0)-1+
"px";c.style.top=(d-n/2|0)-1+"px";c.style.textAlign=a.textAlign;c.style.margin="0";c.style.padding="1px";c.style.border="0";c.style.outline="none";c.style.whiteSpace="pre-wrap";c.style.overflow="hidden";c.rows=a.lineCount;c.cA=l;c.className="goTXarea";b.div.appendChild(c);c.focus();f.selectsTextOnActivate&&(c.select(),c.setSelectionRange(0,9999))}};b.hide=function(a){a.div.removeChild(c)}}}
Ih.prototype.canStart=function(){if(!this.isEnabled)return!1;var a=this.diagram;if(null===a||a.isReadOnly||!a.lastInput.left||this.isBeyondDragSize())return!1;var b=a.Tb(a.lastInput.documentPoint);if(!(null!==b&&b instanceof Jh&&b.editable&&b.part.canEdit()))return!1;b=b.part;return null===b||this.starting===Kh&&!b.isSelected||this.starting===Sh&&2>a.lastInput.clickCount?!1:!0};Ih.prototype.doStart=function(){this.isActive||null===this.textBlock||this.doActivate()};
Ih.prototype.doActivate=function(){if(!this.isActive){var a=this.diagram;if(null!==a){var b=this.textBlock;null===b&&(b=a.Tb(a.lastInput.documentPoint));if(null!==b&&b instanceof Jh&&(this.textBlock=b,null!==b.part)){this.isActive=!0;this.na=Ph;var c=this.defaultTextEditor;null!==b.textEditor&&(c=b.textEditor);this.kh=this.textBlock.copy();var d=new L(this.textBlock.oa(fd),this.textBlock.oa(ud));a.Jv(d);c.show(b,a,this);this.currentTextEditor=c}}}};Ih.prototype.doCancel=function(){this.stopTool()};
Ih.prototype.doMouseUp=function(){!this.isActive&&this.canStart()&&this.doActivate()};Ih.prototype.doMouseDown=function(){this.isActive&&this.acceptText(Th)};
Ih.prototype.acceptText=function(a){switch(a){case Th:if(this.na===Uh)this.currentTextEditor instanceof HTMLElement&&this.currentTextEditor.focus();else if(this.na===Ph||this.na===Rh||this.na===Qh)this.na=Vh,Wh(this);break;case Xh:case Nh:case Oh:if(Nh!==a||!0!==this.textBlock.isMultiline)if(this.na===Ph||this.na===Rh||this.na===Qh)this.na=Vh,Wh(this)}};
function Wh(a){var b=a.textBlock,c=a.diagram,d=a.currentTextEditor;if(null!==b&&null!==d){var e=b.text,f="";null!==d.valueFunction&&(f=d.valueFunction());a.isValidText(b,e,f)?(a.Ca(a.name),a.na=Uh,a.transactionResult=a.name,b.text=f,null!==b.textEdited&&b.textEdited(b,e,f),null!==c&&c.ba("TextEdited",b,e),a.yg(),a.stopTool(),null!==c&&c.doFocus()):(a.na=Rh,null!==b.errorFunction&&b.errorFunction(a,e,f),d.show(b,c,a))}}
Ih.prototype.doDeactivate=function(){var a=this.diagram;null!==a&&(this.na=Lh,this.textBlock=null,null!==this.currentTextEditor&&this.currentTextEditor.hide(a,this),this.isActive=!1)};Ih.prototype.isValidText=function(a,b,c){w(a,Jh,Ih,"isValidText:textblock");var d=this.textValidation;if(null!==d&&!d(a,b,c))return!1;d=a.textValidation;return null===d||d(a,b,c)?!0:!1};Ih.prototype.zx=function(a){var b=this.kh;b.text=a;b.measure(this.textBlock.ml,Infinity);return b};
na.Object.defineProperties(Ih.prototype,{textBlock:{configurable:!0,get:function(){return this.Na},set:function(a){null!==a&&w(a,Jh,Ih,"textBlock");this.Na=a}},currentTextEditor:{configurable:!0,get:function(){return this.w},set:function(a){this.w=a}},defaultTextEditor:{configurable:!0,get:function(){return this.l},set:function(a){!E||a instanceof Hf||v("TextEditingTool.defaultTextEditor must be an HTMLInfo.");this.l=a}},starting:{configurable:!0,
get:function(){return this.Ma},set:function(a){tb(a,Ih,Ih,"starting");this.Ma=a}},textValidation:{configurable:!0,get:function(){return this.xi},set:function(a){null!==a&&z(a,"function",Ih,"textValidation");this.xi=a}},minimumEditorScale:{configurable:!0,get:function(){return this.L},set:function(a){null!==a&&z(a,"number",Ih,"minimumEditorScale");this.L=a}},selectsTextOnActivate:{configurable:!0,get:function(){return this.ca},set:function(a){null!==a&&z(a,
"boolean",Ih,"selectsTextOnActivate");this.ca=a}},state:{configurable:!0,get:function(){return this.na},set:function(a){this.na!==a&&(tb(a,Ih,Ih,"starting"),this.na=a)}}});Ih.prototype.measureTemporaryTextBlock=Ih.prototype.zx;
var Xh=new D(Ih,"LostFocus",0),Th=new D(Ih,"MouseDown",1),Oh=new D(Ih,"Tab",2),Nh=new D(Ih,"Enter",3),Yh=new D(Ih,"SingleClick",0),Kh=new D(Ih,"SingleClickSelected",1),Sh=new D(Ih,"DoubleClick",2),Lh=new D(Ih,"StateNone",0),Ph=new D(Ih,"StateActive",1),Qh=new D(Ih,"StateEditing",2),Vh=new D(Ih,"StateValidating",3),Rh=new D(Ih,"StateInvalid",4),Uh=new D(Ih,"StateValidated",5);Ih.className="TextEditingTool";Ih.LostFocus=Xh;Ih.MouseDown=Th;Ih.Tab=Oh;Ih.Enter=Nh;Ih.SingleClick=Yh;
Ih.SingleClickSelected=Kh;Ih.DoubleClick=Sh;Ih.StateNone=Lh;Ih.StateActive=Ph;Ih.StateEditing=Qh;Ih.StateValidating=Vh;Ih.StateInvalid=Rh;Ih.StateValidated=Uh;Za("textEditingTool",function(){return this.findTool("TextEditing")},function(a){If(this,"TextEditing",a,this.mouseUpTools)});
function ai(){this.uw=bi;this.G=yf;this.un=this.vn=null;this.aj=this.wn=this.xn=0;this.Ck=this.Ye=this.sb=this.Hr=this.Nf=!1;this.Sg=this.Fc=!0;this.Zq=this.Yq=this.tw=null;this.sw=0;this.ar=new Ub;this.Zt=600;this.Zx=new J(0,0);this.qw=this.pw=this.Rw=!1;this.Bk=new I;this.zj=new Ub;this.Wk=new Ub;this.bs=new I;this.$q=null}ai.prototype.ib=function(a){this.G=a};function bi(a,b,c,d){a/=d/2;return 1>a?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b}
function ci(a,b,c,d){return a===d?b+c:c*(-Math.pow(2,-10*a/d)+1)+b}ai.prototype.canStart=function(){return!0};t=ai.prototype;t.Bh=function(a,b){this.Fc&&(void 0!==b&&(this.$q=b),this.Sg||this.G.Ri)&&(this.Bk.add(a),this.canStart(a)&&(this.Nf&&this.xd(),this.Ye=this.sb=!0))};t.Pz=function(a,b){this.Fc&&(void 0!==b&&(this.$q=b),this.Sg||this.G.Ri)&&(this.Bk.add(a),this.canStart(a)&&(this.Nf&&this.xd(),this.sb=!0))};
function di(a){if(a.Fc&&(a.Bk.clear(),a.sb))if(!a.Ck)a.sb=!1,a.Ye=!1;else if(0===a.aj){var b=+new Date;a.aj=b;qa.requestAnimationFrame(function(){if(!1!==a.sb&&!a.Nf&&a.aj===b){var c=a.G;c.Fe("temporaryPixelRatio")&&(c.xe=1);ei(c);a.sb=!1;a.Ye=!1;c.ba("AnimationStarting");fi(a,b)}})}}
t.nf=function(a,b,c,d,e,f){if(!(!this.sb||(E&&w(a,N,ai,"addToAnimation:obj"),"position"===b&&c.A(d))||a instanceof R&&!a.isAnimated)){if(this.Bk.contains("Remove")&&a instanceof R&&a.Ob()){var g=this.G,h=a.key;this.Wk.contains(h)?a=this.Wk.get(h):(a=a.copy(),a.data=null,g.add(a),this.Wk.add(h,a))}g=this.zj;if(g.contains(a)){h=g.K(a);g=h.start;var k=h.end;void 0===g[b]&&(g[b]=gi(c));h.Ps&&void 0!==k[b]?h.Ts[b]=gi(d):(e||(h.Ts[b]=gi(d)),k[b]=gi(d))}else h={},k={},h[b]=gi(c),k[b]=gi(d),c=h.position,
c instanceof J&&!c.o()&&this.Bk.contains("Expand SubGraph")&&c.assign(k.position),h=new hi(h,k,e),g.add(a,h);e&&0===b.indexOf("position:")&&a instanceof R&&(h.Ts.location=gi(a.location));f&&(h.tt=!0);this.Ck=!0}};function gi(a){return a instanceof J?a.copy():a instanceof Zb?a.copy():a}function ii(a,b){if(!a.Nf)return!1;a=a.zj.K(b);return null!==a&&a.tt}
function fi(a,b){function c(){if(!1!==e.Nf&&e.aj===b){var a=+new Date,f=a>r?l:a-q;ji(e);ki(e,d,p,g,f,l);e.Yq&&e.Yq();Dg(d);li(e);a>r?mi(e):qa.requestAnimationFrame(c)}}var d=a.G;if(null!==d){var e=a,f=a.$q||{},g=f.Oy||a.uw,h=f.qA||null,k=f.rA||null,l=f.duration||a.Zt,m=a.Zx;for(f=a.zj.iterator;f.next();){var n=f.value.start.position;n instanceof J&&(n.o()||n.assign(m))}a.tw=g;a.Yq=h;a.Zq=k;a.sw=l;a.ar=a.zj;var p=a.ar;for(f=p.iterator;f.next();)h=f.value.end,h["position:placeholder"]&&(k=f.key.findVisibleNode(),
k instanceof wg&&null!==k.placeholder&&(m=k.placeholder,k=m.oa(fd),m=m.padding,k.x+=m.left,k.y+=m.top,h["position:placeholder"]=k));a.Nf=!0;ji(a);ki(a,d,p,g,0,l);Dg(a.G,!0);li(a);var q=+new Date,r=q+l;e.aj===b&&qa.requestAnimationFrame(function(){c()})}}function ji(a){if(!a.Hr){var b=a.G;a.Rw=b.skipsUndoManager;a.pw=b.skipsModelSourceBindings;a.qw=b.Wi;b.skipsUndoManager=!0;b.skipsModelSourceBindings=!0;b.Wi=!0;a.Hr=!0}}
function li(a){var b=a.G;b.skipsUndoManager=a.Rw;b.skipsModelSourceBindings=a.pw;b.Wi=a.qw;a.Hr=!1}function ki(a,b,c,d,e,f){for(c=c.iterator;c.next();){var g=c.key,h=c.value,k=h.start;h=h.end;for(var l in h)if(("position"!==l||!h["position:placeholder"]&&!h["position:node"])&&void 0!==ni[l])ni[l](g,k[l],h[l],d,e,f)}d=b.ov;b.ov=!0;l=a.uw;0!==a.xn&&0!==a.wn&&(c=a.xn,b.Da=l(e,c,a.wn-c,f));null!==a.vn&&null!==a.un&&(c=a.vn,a=a.un,b.ua=new J(l(e,c.x,a.x-c.x,f),l(e,c.y,a.y-c.y,f)));b.ov=d}
t.xd=function(){!0===this.sb&&(this.Ye=this.sb=!1,this.aj=0,this.Ck&&this.G.ec());this.Nf&&this.Fc&&mi(this)};
function mi(a){a.Nf=!1;a.Ck=!1;ji(a);for(var b=a.G,c=a.tw,d=a.sw,e=a.ar,f=a.Wk.iterator;f.next();)b.remove(f.value);for(f=a.bs.iterator;f.next();)f.value.v();for(e=e.iterator;e.next();){f=e.key;var g=e.value,h=g.start,k=g.end,l=g.Ts,m;for(m in k)if(void 0!==ni[m]){var n=m;!g.Ps||"position:node"!==n&&"position:placeholder"!==n||(n="position");ni[n](f,h[m],void 0!==l[m]?l[m]:g.Ps?h[m]:k[m],c,d,d)}g.Ps&&void 0!==l.location&&f instanceof R&&(f.location=l.location);g.tt&&f instanceof R&&f.Pb(!1)}for(c=
a.G.links;c.next();)d=c.value,null!==d.dh&&(d.points=d.dh,d.dh=null);b.kt.clear();gg(b,!1);b.Ya();b.S();b.hd();oi(b);li(a);a.Zq&&a.Zq();a.aj=0;a.ar.clear();a.Zq=null;a.Yq=null;a.vn=null;a.un=null;a.xn=0;a.wn=0;a.zj.clear();0<a.Wk.count&&a.Wk.clear();0<a.bs.count&&a.bs.clear();a.$q=null;b.ba("AnimationFinished");b.ec()}
t.Np=function(a,b){if(this.Ye){var c=a.actualBounds,d=b.actualBounds,e=null;b instanceof wg&&(e=b.placeholder);null!==e?(c=e.oa(fd),e=e.padding,c.x+=e.left,c.y+=e.top,this.nf(a,"position",c,a.position,!1)):this.nf(a,"position",new J(d.x+d.width/2-c.width/2,d.y+d.height/2-c.height/2),a.position,!1);this.nf(a,"scale",.01,a.scale,!1);if(a instanceof wg)for(a=a.memberParts;a.next();)e=a.value,e instanceof V&&this.Np(e,b)}};
t.Mp=function(a,b){if(a.isVisible()&&this.Ye){var c=null;b instanceof wg&&(c=b.placeholder);null!==c?this.nf(a,"position:placeholder",a.position,c,!0):this.nf(a,"position:node",a.position,b,!0);this.nf(a,"scale",a.scale,.01,!0);this.sb&&(c=this.zj,c.contains(a)&&(c.K(a).tt=!0));if(a instanceof wg)for(a=a.memberParts;a.next();)c=a.value,c instanceof V&&this.Mp(c,b)}};function pi(a,b,c){a.Ye&&!b.A(c)&&(null===a.vn&&b.o()&&null===a.un&&(a.vn=b.copy()),a.un=c.copy(),a.Ck=!0)}
function qi(a,b,c){a.Ye&&a.G.Ri&&(0===a.xn&&0===a.wn&&(a.xn=b),a.wn=c,a.Ck=!0)}
na.Object.defineProperties(ai.prototype,{animationReasons:{configurable:!0,get:function(){return this.Bk}},isEnabled:{configurable:!0,get:function(){return this.Fc},set:function(a){z(a,"boolean",ai,"isEnabled");this.Fc=a}},duration:{configurable:!0,get:function(){return this.Zt},set:function(a){z(a,"number",ai,"duration");1>a&&Ca(a,">= 1",ai,"duration");this.Zt=a}},isAnimating:{configurable:!0,get:function(){return this.Nf}},isTicking:{configurable:!0,
enumerable:!0,get:function(){return this.Hr}},isInitial:{configurable:!0,get:function(){return this.Sg},set:function(a){z(a,"boolean",ai,"isInitial");this.Sg=a}}});ai.prototype.stopAnimation=ai.prototype.xd;ai.prototype.addToAnimation=ai.prototype.nf;ai.prototype.prepareAnimation=ai.prototype.Pz;ai.prototype.prepareAutomaticAnimation=ai.prototype.Bh;ai.className="AnimationManager";function hi(a,b,c){this.start=a;this.end=b;this.Ts={};this.Ps=c;this.tt=!1}hi.className="AnimationStates";
var ni={position:function(a,b,c,d,e,f){e!==f?a.Bt(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f)):a.position=new J(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f))},"position:placeholder":function(a,b,c,d,e,f){e!==f?a.Bt(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f)):a.position=new J(d(e,b.x,c.x-b.x,f),d(e,b.y,c.y-b.y,f))},"position:node":function(a,b,c,d,e,f){var g=a.actualBounds,h=c.actualBounds;c=h.x+h.width/2-g.width/2;g=h.y+h.height/2-g.height/2;e!==f?a.Bt(d(e,b.x,c-b.x,f),d(e,b.y,g-b.y,f)):a.position=new J(d(e,b.x,c-
b.x,f),d(e,b.y,g-b.y,f))},opacity:function(a,b,c,d,e,f){a.opacity=d(e,b,c-b,f)},scale:function(a,b,c,d,e,f){a.scale=d(e,b,c-b,f)},angle:function(a,b,c,d,e,f){a.angle=d(e,b,c-b,f)},visible:function(a,b,c,d,e,f){a.visible=e!==f?b:c}};function ri(){0<arguments.length&&Da(ri);qb(this);this.G=null;this.Ga=new G;this.Wa="";this.mb=1;this.w=!1;this.Dj=this.L=this.Ph=this.Oh=this.Nh=this.Mh=this.Kh=this.Lh=this.Jh=this.Rh=this.Ih=this.Qh=this.Hh=this.Gh=!0;this.l=!1;this.Mo=[]}t=ri.prototype;
t.ib=function(a){this.G=a};
t.toString=function(a){void 0===a&&(a=0);var b='Layer "'+this.name+'"';if(0>=a)return b;for(var c=0,d=0,e=0,f=0,g=0,h=this.Ga.iterator;h.next();){var k=h.value;k instanceof wg?e++:k instanceof V?d++:k instanceof Q?f++:k instanceof Cf?g++:c++}h="";0<c&&(h+=c+" Parts ");0<d&&(h+=d+" Nodes ");0<e&&(h+=e+" Groups ");0<f&&(h+=f+" Links ");0<g&&(h+=g+" Adornments ");if(1<a)for(a=this.Ga.iterator;a.next();)c=a.value,h+="\n    "+c.toString(),d=c.data,null!==d&&Jb(d)&&(h+=" #"+Jb(d)),c instanceof V?h+=" "+
Wa(d):c instanceof Q&&(h+=" "+Wa(c.fromNode)+" "+Wa(c.toNode));return b+" "+this.Ga.count+": "+h};
t.Tb=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);if(!1===this.Dj)return null;E&&!a.o()&&v("findObjectAt: Point must have a real value, not: "+a.toString());var d=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(d=!0);for(var e=J.alloc(),f=this.Ga.j,g=f.length;g--;){var h=f[g];if((!0!==d||!1!==Cg(h))&&h.isVisible()&&(e.assign(a),ac(e,h.td),h=h.Tb(e,b,c),null!==h&&(null!==b&&(h=b(h)),null!==h&&(null===c||c(h)))))return J.free(e),h}J.free(e);return null};
t.Hi=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof I||(d=new I);if(!1===this.Dj)return d;E&&!a.o()&&v("findObjectsAt: Point must have a real value, not: "+a.toString());var e=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(e=!0);for(var f=J.alloc(),g=this.Ga.j,h=g.length;h--;){var k=g[h];if((!0!==e||!1!==Cg(k))&&k.isVisible()){f.assign(a);ac(f,k.td);var l=k;k.Hi(f,b,c,d)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||d.add(l))}}J.free(f);return d};
t.pg=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof I||(e=new I);if(!1===this.Dj)return e;E&&!a.o()&&v("findObjectsIn: Rect must have a real value, not: "+a.toString());var f=!1;null!==this.diagram&&this.diagram.viewportBounds.qf(a)&&(f=!0);for(var g=this.Ga.j,h=g.length;h--;){var k=g[h];if((!0!==f||!1!==Cg(k))&&k.isVisible()){var l=k;k.pg(a,b,c,d,e)&&(null!==b&&(l=b(l)),null===l||null!==c&&!c(l)||e.add(l))}}return e};
t.qg=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof I)f=e;e=!0}f instanceof G||f instanceof I||(f=new I);if(!1===this.Dj)return f;E&&!a.o()&&v("findObjectsNear: Point must have a real value, not: "+a.toString());var g=!1;null!==this.diagram&&this.diagram.viewportBounds.fa(a)&&(g=!0);for(var h=J.alloc(),k=J.alloc(),l=this.Ga.j,m=l.length;m--;){var n=l[m];if((!0!==g||!1!==Cg(n))&&n.isVisible()){h.assign(a);ac(h,n.td);
k.h(a.x+b,a.y);ac(k,n.td);var p=n;n.qg(h,k,c,d,e,f)&&(null!==c&&(p=c(p)),null===p||null!==d&&!d(p)||f.add(p))}}J.free(h);J.free(k);return f};
t.kd=function(a,b){if(this.visible){var c=void 0===b?a.viewportBounds:b;var d=this.Ga.j,e=d.length;a=Qa();b=Qa();for(var f=0;f<e;f++){var g=d[f];g.Gw=f;g instanceof Q&&!1===g.Lc||g instanceof Cf&&null!==g.adornedPart||(Lc(g.actualBounds,c,10)?(g.kd(!0),a.push(g)):(g.kd(!1),null!==g.adornments&&0<g.adornments.count&&b.push(g)))}for(c=0;c<a.length;c++)for(d=a[c],si(d),d=d.adornments;d.next();)e=d.value,e.measure(Infinity,Infinity),e.arrange(),e.kd(!0);for(c=0;c<b.length;c++)d=b[c],d.updateAdornments(),
ti(d,!0);Ta(a);Ta(b)}};t.kc=function(a,b,c){if(this.visible&&0!==this.mb&&(void 0===c&&(c=!0),c||!this.isTemporary)){c=this.Ga.j;var d=c.length;if(0!==d){1!==this.mb&&(a.globalAlpha=this.mb);var e=this.Mo;e.length=0;for(var f=b.scale,g=0;g<d;g++){var h=c[g];if(Cg(h)){if(h instanceof Q&&(h.isOrthogonal&&e.push(h),!1===h.Lc))continue;var k=h.actualBounds;1<k.width*f||1<k.height*f?h.kc(a,b):ui(a,h)}}a.globalAlpha=1}}};
function ui(a,b){var c=b.actualBounds,d=b.naturalBounds;if(0!==c.width&&0!==c.height&&!isNaN(c.x)&&!isNaN(c.y)&&b.isVisible()){var e=b.transform;null!==b.areaBackground&&(vi(b,a,b.areaBackground,!0,!0,d,c),a.fillRect(c.x,c.y,c.width,c.height));null===b.areaBackground&&null===b.background&&(vi(b,a,"rgba(0,0,0,0.4)",!0,!1,d,c),a.fillRect(c.x,c.y,c.width,c.height));null!==b.background&&(a.transform(e.m11,e.m12,e.m21,e.m22,e.dx,e.dy),vi(b,a,b.background,!0,!1,d,c),a.fillRect(0,0,d.width,d.height),e.ht()||
(b=1/(e.m11*e.m22-e.m12*e.m21),a.transform(e.m22*b,-e.m12*b,-e.m21*b,e.m11*b,b*(e.m21*e.dy-e.m22*e.dx),b*(e.m12*e.dx-e.m11*e.dy))))}}t.g=function(a,b,c,d,e){var f=this.diagram;null!==f&&f.cb(of,a,this,b,c,d,e)};t.Pi=function(a,b,c){var d=this.Ga;b.hi=this;if(a>=d.count)a=d.count;else if(d.O(a)===b)return-1;d.Lb(a,b);b.bq(c);d=this.diagram;null!==d&&(c?d.S():d.Pi(b));wi(this,a,b);return a};
t.zc=function(a,b,c){if(!c&&b.layer!==this&&null!==b.layer)return b.layer.zc(a,b,c);var d=this.Ga;if(0>a||a>=d.length){if(a=d.indexOf(b),0>a)return-1}else if(d.O(a)!==b&&(a=d.indexOf(b),0>a))return-1;b.cq(c);d.nb(a);d=this.diagram;null!==d&&(c?d.S():d.zc(b));b.hi=null;return a};
function wi(a,b,c){b=xi(a,b,c);if(c instanceof wg&&null!==c&&isNaN(c.zOrder)){if(0!==c.memberParts.count){for(var d=-1,e=a.Ga.j,f=e.length,g=0;g<f;g++){var h=e[g];if(h===c&&(b=g,0<=d))break;if(0>d&&h.containingGroup===c&&(d=g,0<=b))break}!(0>d)&&d<b&&(e=a.Ga,e.nb(b),e.Lb(d,c))}c=c.containingGroup;null!==c&&wi(a,-1,c)}}
function xi(a,b,c){var d=c.zOrder;if(isNaN(d))return b;a=a.Ga;var e=a.count;if(1>=e)return b;0>b&&(b=a.indexOf(c));if(0>b)return-1;for(var f=b-1,g=NaN;0<=f;){g=a.O(f).zOrder;if(!isNaN(g))break;f--}for(var h=b+1,k=NaN;h<e;){k=a.O(h).zOrder;if(!isNaN(k))break;h++}if(!isNaN(g)&&g>d)for(;;){if(-1===f||g<=d){f++;if(f===b)break;a.nb(b);a.Lb(f,c);return f}for(g=NaN;0<=--f&&(g=a.O(f).zOrder,isNaN(g)););}else if(!isNaN(k)&&k<d)for(;;){if(h===e||k>=d){h--;if(h===b)break;a.nb(b);a.Lb(h,c);return h}for(k=NaN;++h<
e&&(k=a.O(h).zOrder,isNaN(k)););}return b}t.clear=function(){for(var a=this.Ga.Oa(),b=a.length,c=0;c<b;c++)a[c].kd(!1),this.zc(-1,a[c],!1);this.Mo.length=0};
na.Object.defineProperties(ri.prototype,{parts:{configurable:!0,get:function(){return this.Ga.iterator}},partsBackwards:{configurable:!0,get:function(){return this.Ga.iteratorBackwards}},diagram:{configurable:!0,get:function(){return this.G}},name:{configurable:!0,get:function(){return this.Wa},set:function(a){z(a,"string",ri,"name");var b=this.Wa;if(b!==a){var c=this.diagram;if(null!==c)for(""===b&&v("Cannot rename default Layer to: "+a),c=
c.layers;c.next();)c.value.name===a&&v("Layer.name is already present in this diagram: "+a);this.Wa=a;this.g("name",b,a);for(a=this.Ga.iterator;a.next();)a.value.layerName=this.Wa}}},opacity:{configurable:!0,get:function(){return this.mb},set:function(a){var b=this.mb;b!==a&&(z(a,"number",ri,"opacity"),(0>a||1<a)&&Ca(a,"0 <= value <= 1",ri,"opacity"),this.mb=a,this.g("opacity",b,a),a=this.diagram,null!==a&&a.S())}},isTemporary:{configurable:!0,get:function(){return this.w},
set:function(a){var b=this.w;b!==a&&(z(a,"boolean",ri,"isTemporary"),this.w=a,this.g("isTemporary",b,a))}},visible:{configurable:!0,get:function(){return this.L},set:function(a){var b=this.L;if(b!==a){z(a,"boolean",ri,"visible");this.L=a;this.g("visible",b,a);for(b=this.Ga.iterator;b.next();)b.value.Pb(a);a=this.diagram;null!==a&&a.S()}}},pickable:{configurable:!0,get:function(){return this.Dj},set:function(a){var b=this.Dj;b!==a&&(z(a,"boolean",ri,"pickable"),this.Dj=
a,this.g("pickable",b,a))}},isBoundsIncluded:{configurable:!0,get:function(){return this.l},set:function(a){this.l!==a&&(this.l=a,null!==this.diagram&&this.diagram.Ya())}},allowCopy:{configurable:!0,get:function(){return this.Gh},set:function(a){var b=this.Gh;b!==a&&(z(a,"boolean",ri,"allowCopy"),this.Gh=a,this.g("allowCopy",b,a))}},allowDelete:{configurable:!0,get:function(){return this.Hh},set:function(a){var b=this.Hh;b!==a&&(z(a,"boolean",ri,"allowDelete"),
this.Hh=a,this.g("allowDelete",b,a))}},allowTextEdit:{configurable:!0,get:function(){return this.Qh},set:function(a){var b=this.Qh;b!==a&&(z(a,"boolean",ri,"allowTextEdit"),this.Qh=a,this.g("allowTextEdit",b,a))}},allowGroup:{configurable:!0,get:function(){return this.Ih},set:function(a){var b=this.Ih;b!==a&&(z(a,"boolean",ri,"allowGroup"),this.Ih=a,this.g("allowGroup",b,a))}},allowUngroup:{configurable:!0,get:function(){return this.Rh},set:function(a){var b=
this.Rh;b!==a&&(z(a,"boolean",ri,"allowUngroup"),this.Rh=a,this.g("allowUngroup",b,a))}},allowLink:{configurable:!0,get:function(){return this.Jh},set:function(a){var b=this.Jh;b!==a&&(z(a,"boolean",ri,"allowLink"),this.Jh=a,this.g("allowLink",b,a))}},allowRelink:{configurable:!0,get:function(){return this.Lh},set:function(a){var b=this.Lh;b!==a&&(z(a,"boolean",ri,"allowRelink"),this.Lh=a,this.g("allowRelink",b,a))}},allowMove:{configurable:!0,get:function(){return this.Kh},
set:function(a){var b=this.Kh;b!==a&&(z(a,"boolean",ri,"allowMove"),this.Kh=a,this.g("allowMove",b,a))}},allowReshape:{configurable:!0,get:function(){return this.Mh},set:function(a){var b=this.Mh;b!==a&&(z(a,"boolean",ri,"allowReshape"),this.Mh=a,this.g("allowReshape",b,a))}},allowResize:{configurable:!0,get:function(){return this.Nh},set:function(a){var b=this.Nh;b!==a&&(z(a,"boolean",ri,"allowResize"),this.Nh=a,this.g("allowResize",b,a))}},allowRotate:{configurable:!0,
enumerable:!0,get:function(){return this.Oh},set:function(a){var b=this.Oh;b!==a&&(z(a,"boolean",ri,"allowRotate"),this.Oh=a,this.g("allowRotate",b,a))}},allowSelect:{configurable:!0,get:function(){return this.Ph},set:function(a){var b=this.Ph;b!==a&&(z(a,"boolean",ri,"allowSelect"),this.Ph=a,this.g("allowSelect",b,a))}}});ri.prototype.findObjectsNear=ri.prototype.qg;ri.prototype.findObjectsIn=ri.prototype.pg;ri.prototype.findObjectsAt=ri.prototype.Hi;ri.prototype.findObjectAt=ri.prototype.Tb;
ri.className="Layer";
function P(a){function b(){qa.document.removeEventListener("DOMContentLoaded",b,!1);c.setRTL()}1<arguments.length&&v("Diagram constructor can only take one optional argument, the DIV HTML element or its id.");yi||(zi(),yi=!0);qb(this);yf=this;bb=[];this.pb=!0;this.Ak=new ai;this.Ak.ib(this);this.Jb=17;this.Wn=!1;this.wu="default";this.Ja=null;var c=this;Hh&&(null!==qa.document.body?this.setRTL():qa.document.addEventListener("DOMContentLoaded",b,!1));this.Ra=new G;this.ya=this.Aa=0;this.Ea=null;this.uu=
new Ub;this.ah=this.$c=null;this.Hv();this.gl=null;this.Gv();this.ua=(new J(NaN,NaN)).freeze();this.dr=this.Da=1;this.yr=(new J(NaN,NaN)).freeze();this.zr=NaN;this.Tr=1E-4;this.Rr=100;this.ub=new $b;this.Ks=(new J(NaN,NaN)).freeze();this.nr=(new L(NaN,NaN,NaN,NaN)).freeze();this.ti=(new Jc(0,0,0,0)).freeze();this.qs=Ai;this.ts=!1;this.ns=this.js=null;this.cj=Bi;this.ej=Qd;this.ci=Bi;this.Rn=Qd;this.Ar=this.xr=fd;this.pc=!0;this.Sn=!1;this.Fd=new I;this.Yh=new Ub;this.An=!0;this.Wm=250;this.Dk=-1;
this.Xm=(new Jc(16,16,16,16)).freeze();this.Tk=this.sd=!1;this.$k=!0;this.Zh=new kf;this.Zh.diagram=this;this.$e=new kf;this.$e.diagram=this;this.sj=new kf;this.sj.diagram=this;this.pe=this.Cf=null;this.Pl=!1;this.Vt=this.Wt=null;this.Lq=qa.PointerEvent&&(gb||ib||jb)&&qa.navigator&&!1!==qa.navigator.msPointerEnabled;Ci(this);this.zi=new I;this.Ir=!0;this.Fs=Di;this.Xb=!1;this.Hs=Ig;this.Na=null;Ei.add("Model",Fi);this.ca=this.Ma=this.Wb=null;this.Xq="";this.tn="auto";this.Uf=this.Wr=this.Wf=this.Xf=
this.Zf=this.Ef=this.If=this.Df=null;this.tr=!1;this.Ff=this.jg=this.Yf=this.Vf=null;this.pu=!1;this.su={};this.yl=[null,null];this.L=null;this.Ut=this.Bu=this.Eh=this.fh=!1;this.Nc=!0;this.oj=this.$b=!1;this.ac=null;var d=this;this.zg=function(a){var b=d.partManager;if(a.model===b.diagram.model&&b.diagram.ea){b.diagram.ea=!1;try{var c=a.change;""===a.modelChange&&c===of&&b.updateDataBindings(a.object,a.propertyName)}finally{b.diagram.ea=!0}}};this.Gm=function(a){d.partManager.doModelChanged(a)};
this.Tw=!0;this.he=-2;this.Ej=new Ub;this.ru=new G;this.Of=!1;this.Hh=this.Gh=this.Dq=this.Fc=!0;this.Eq=!1;this.Kq=this.Iq=this.Ph=this.Oh=this.Nh=this.Mh=this.Kh=this.Lh=this.Jh=this.Hq=this.Rh=this.Ih=this.Qh=this.Fq=!0;this.je=this.Mc=!1;this.Jq=this.Gq=this.vr=this.ur=!0;this.ss=this.ps=16;this.yu=this.os=!1;this.ip=this.rs=null;this.zu=this.Au=0;this.gb=(new Jc(5)).freeze();this.vs=(new I).freeze();this.Sr=999999999;this.wr=(new I).freeze();this.di=this.mj=this.Rg=!0;this.ai=this.Qg=!1;this.ic=
null;this.Cg=!0;this.ie=!1;this.Bq=new I;this.Ew=new I;this.Qb=null;this.Ko=1;this.Nw=0;this.ze={scale:1,position:new J,bounds:new L,wx:!1};this.Sw=(new L(NaN,NaN,NaN,NaN)).freeze();this.Hp=(new Zb(NaN,NaN)).freeze();this.yn=(new L(NaN,NaN,NaN,NaN)).freeze();this.Jr=!1;this.hr=null;Gi(this);this.Or=this.rr=this.Zr=this.ww=this.vw=this.xw=this.Vg=this.$h=this.$f=null;Hi(this);this.Hb=null;this.qr=!1;this.Lk=null;this.partManager=new Fi;this.toolManager=new $a;this.toolManager.initializeStandardTools();
this.currentTool=this.defaultTool=this.toolManager;this.gr=null;this.Nk=new Lf;this.ds=this.cs=null;this.yp=!1;this.commandHandler=Ii();this.model=Ji();this.fh=!0;this.layout=new Ki;this.fh=!1;this.zw=this.Yt=null;this.bc=1;this.xe=null;this.iu=9999;this.Ue=1;this.nl=0;this.Lr=new J;this.Gu=500;this.Mq=new J;this.Re=!1;this.preventDefault=this.st=this.om=this.pm=this.nm=this.mm=this.kk=this.mk=this.lk=this.ik=this.jk=this.cw=this.Vv=this.Wv=this.Xv=this.si=this.cp=this.ri=this.bp=null;this.w=!1;this.bi=
new Li;this.Cs=!1;void 0!==a&&Mi(this,a);this.pb=!1}P.prototype.clear=function(){this.model.clear();Ni=null;Oi="";Pi(this,!1);this.yn=(new L(NaN,NaN,NaN,NaN)).freeze();this.S()};
function Pi(a,b){var c=null;null!==a.Hb&&(c=a.Hb.part);a.animationManager.xd();for(var d=[],e=a.Ra.length,f=0;f<e;f++){var g=a.Ra.j[f];if(b)for(var h=g.parts;h.next();){var k=h.value;k!==c&&null===k.data&&d.push(k)}g.clear()}a.partManager.clear();a.Fd.clear();a.Yh.clear();a.zi.clear();a.vs.ja();a.vs.clear();a.vs.freeze();a.wr.ja();a.wr.clear();a.wr.freeze();a.Lk=null;Ra=[];null!==c&&(a.add(c),a.partManager.parts.remove(c));if(b)for(b=0;b<d.length;b++)a.add(d[b])}function Ii(){return null}
P.prototype.reset=function(){this.pb=!0;this.clear();this.Ak=new ai;this.Ak.ib(this);this.Ra=new G;this.Hv();this.Gv();this.ua=(new J(NaN,NaN)).freeze();this.Da=1;this.yr=(new J(NaN,NaN)).freeze();this.zr=NaN;this.Tr=1E-4;this.Rr=100;this.Ks=(new J(NaN,NaN)).freeze();this.nr=(new L(NaN,NaN,NaN,NaN)).freeze();this.ti=(new Jc(0,0,0,0)).freeze();this.qs=Ai;this.ts=!1;this.ns=this.js=null;this.cj=Bi;this.ej=Qd;this.ci=Bi;this.Rn=Qd;this.Ar=this.xr=fd;this.Wm=250;this.Xm=(new Jc(16,16,16,16)).freeze();
this.Ir=!0;this.Fs=Di;this.Hs=Ig;this.tn="auto";this.Uf=this.Wr=this.Wf=this.Xf=this.Zf=this.Ef=this.If=this.Df=null;this.tr=!1;this.Ff=this.jg=this.Yf=this.Vf=null;this.Of=!1;this.Hh=this.Gh=this.Dq=this.Fc=!0;this.Eq=!1;this.Jq=this.Gq=this.vr=this.ur=this.Kq=this.Iq=this.Ph=this.Oh=this.Nh=this.Mh=this.Kh=this.Lh=this.Jh=this.Hq=this.Rh=this.Ih=this.Qh=this.Fq=!0;this.ss=this.ps=16;this.gb=(new Jc(5)).freeze();this.Sr=999999999;this.ic=null;this.Jr=!1;Hi(this);this.Hb=null;this.partManager=new Fi;
this.toolManager=new $a;this.toolManager.initializeStandardTools();this.ds=this.cs=this.gr=null;this.yp=!1;this.Nk.reset();this.uu=new Ub;this.uu.clear();this.currentTool=this.defaultTool=this.toolManager;this.commandHandler=Ii();this.fh=!0;Gi(this);this.layout=new Ki;this.fh=!1;this.model=Ji();this.model.undoManager=new tf;this.ie=!1;this.$k=!0;this.pb=this.sd=!1;this.S();this.pe=this.Cf=null;Ci(this);this.Xq=""};
function Hi(a){a.$f=new Ub;var b=new V,c=new Jh;c.bind(new Qi("text","",Wa));b.add(c);a.xw=b;a.$f.add("",b);b=new V;c=new Jh;c.stroke="brown";c.bind(new Qi("text","",Wa));b.add(c);a.$f.add("Comment",b);b=new V;b.selectable=!1;b.avoidable=!1;c=new Gg;c.figure="Ellipse";c.fill="black";c.stroke=null;c.desiredSize=(new Zb(3,3)).ia();b.add(c);a.$f.add("LinkLabel",b);a.$h=new Ub;b=new wg;b.selectionObjectName="GROUPPANEL";b.type=W.Vertical;c=new Jh;c.font="bold 12pt sans-serif";c.bind(new Qi("text","",
Wa));b.add(c);c=new W(W.Auto);c.name="GROUPPANEL";var d=new Gg;d.figure="Rectangle";d.fill="rgba(128,128,128,0.2)";d.stroke="black";c.add(d);d=new kh;d.padding=(new Jc(5,5,5,5)).ia();c.add(d);b.add(c);a.vw=b;a.$h.add("",b);a.Vg=new Ub;b=new Q;c=new Gg;c.isPanelMain=!0;b.add(c);c=new Gg;c.toArrow="Standard";c.fill="black";c.stroke=null;c.strokeWidth=0;b.add(c);a.ww=b;a.Vg.add("",b);b=new Q;c=new Gg;c.isPanelMain=!0;c.stroke="brown";b.add(c);a.Vg.add("Comment",b);b=new Cf;b.type=W.Auto;c=new Gg;c.fill=
null;c.stroke="dodgerblue";c.strokeWidth=3;b.add(c);c=new kh;c.margin=(new Jc(1.5,1.5,1.5,1.5)).ia();b.add(c);a.Zr=b;a.rr=b;b=new Cf;b.type=W.Link;c=new Gg;c.isPanelMain=!0;c.fill=null;c.stroke="dodgerblue";c.strokeWidth=3;b.add(c);a.Or=b}
P.prototype.setRTL=function(a){a=void 0===a?this.div:a;null===a&&(a=qa.document.body);var b=xa("div");b.dir="rtl";b.style.cssText="font-size: 14px; width: 1px; height: 1px; position: absolute; top: -1000px; overflow: scroll;";b.textContent="A";a.appendChild(b);var c="reverse";0<b.scrollLeft?c="default":(b.scrollLeft=1,0===b.scrollLeft&&(c="negative"));a.removeChild(b);this.wu=c};
P.prototype.setScrollWidth=function(a){a=void 0===a?this.div:a;null===a&&(a=qa.document.body);var b=0;if(Hh){var c=Ri;b=Si;null===c&&(c=Ri=xa("p"),c.style.width="100%",c.style.height="200px",c.style.boxSizing="content-box",b=Si=xa("div"),b.style.position="absolute",b.style.visibility="hidden",b.style.width="200px",b.style.height="150px",b.style.boxSizing="content-box",b.appendChild(c));b.style.overflow="hidden";a.appendChild(b);var d=c.offsetWidth;b.style.overflow="scroll";c=c.offsetWidth;d===c&&
(c=b.clientWidth);a.removeChild(b);b=d-c;0!==b||lb||(b=11)}this.Jb=b};P.prototype.hb=function(a){a.classType===P?this.autoScale=a:Fa(this,a)};P.prototype.toString=function(a){void 0===a&&(a=0);var b="";this.div&&this.div.id&&(b=this.div.id);b='Diagram "'+b+'"';if(0>=a)return b;for(var c=this.Ra.iterator;c.next();)b+="\n  "+c.value.toString(a-1);return b};
function Ti(a){var b=a.Ea.Ha;b instanceof HTMLCanvasElement&&(a.Lq?(b.addEventListener("pointerdown",a.mm,!1),b.addEventListener("pointermove",a.nm,!1),b.addEventListener("pointerup",a.pm,!1),b.addEventListener("pointerout",a.om,!1)):(b.addEventListener("touchstart",a.Xv,!1),b.addEventListener("touchmove",a.Wv,!1),b.addEventListener("touchend",a.Vv,!1),b.addEventListener("mousemove",a.jk,!1),b.addEventListener("mousedown",a.ik,!1),b.addEventListener("mouseup",a.lk,!1),b.addEventListener("mouseout",
a.kk,!1)),b.addEventListener("mouseenter",a.Jy,!1),b.addEventListener("mouseleave",a.Ky,!1),b.addEventListener("wheel",a.mk,!1),b.addEventListener("keydown",a.Dz,!1),b.addEventListener("keyup",a.Ez,!1),b.addEventListener("blur",a.wy,!1),b.addEventListener("focus",a.xy,!1),b.addEventListener("selectstart",function(a){a.preventDefault();return!1},!1),b.addEventListener("contextmenu",function(a){a.preventDefault();return!1},!1),b.addEventListener("gesturestart",function(b){a.toolManager.gestureBehavior!==
Ff&&(a.toolManager.gestureBehavior===Ef?b.preventDefault():a.Re&&a.lastInput.handled||(b.preventDefault(),a.Ko=a.scale,a.currentTool.doCancel()))},!1),b.addEventListener("gesturechange",function(b){if(a.toolManager.gestureBehavior!==Ff)if(a.toolManager.gestureBehavior===Ef)b.preventDefault();else if(!a.Re||!a.lastInput.handled){b.preventDefault();var c=b.scale;if(null!==a.Ko){var e=a.Ea.getBoundingClientRect();b=new J(b.pageX-window.scrollX-a.Aa/e.width*e.left,b.pageY-window.scrollY-a.ya/e.height*
e.top);c=a.Ko*c;e=a.commandHandler;if(c!==a.scale&&e.canResetZoom(c)){var f=a.zoomPoint;a.zoomPoint=b;e.resetZoom(c);a.zoomPoint=f}}}},!1),qa.addEventListener("resize",a.cw,!1))}function gg(a,b){null!==a.xe&&(a.xe=null,b&&a.st())}P.prototype.computePixelRatio=function(){return null!==this.xe?this.xe:qa.devicePixelRatio||1};P.prototype.doMouseMove=function(){this.currentTool.doMouseMove()};P.prototype.doMouseDown=function(){this.currentTool.doMouseDown()};P.prototype.doMouseUp=function(){this.currentTool.doMouseUp()};
P.prototype.doMouseWheel=function(){this.currentTool.doMouseWheel()};P.prototype.doKeyDown=function(){this.currentTool.doKeyDown()};P.prototype.doKeyUp=function(){this.currentTool.doKeyUp()};P.prototype.doFocus=function(){this.focus()};P.prototype.focus=function(){if(this.Ea)if(this.scrollsPageOnFocus)this.Ea.focus();else{var a=qa.scrollX||qa.pageXOffset,b=qa.scrollY||qa.pageYOffset;this.Ea.focus();qa.scrollTo(a,b)}};P.prototype.xy=function(){this.G.ba("GainedFocus")};P.prototype.wy=function(){this.G.ba("LostFocus")};
function ei(a){if(null!==a.Ea){var b=a.Ja;if(0!==b.clientWidth&&0!==b.clientHeight){a.setScrollWidth();var c=a.ai?a.Jb:0,d=a.Qg?a.Jb:0,e=a.bc;a.bc=a.computePixelRatio();a.bc!==e&&(a.Sn=!0,a.ec());if(b.clientWidth!==a.Aa+c||b.clientHeight!==a.ya+d)a.mj=!0,a.pc=!0,b=a.layout,null!==b&&b.isViewportSized&&a.autoScale===Bi&&(a.Tk=!0,b.C()),a.$b||a.ec()}}}
function Gi(a){var b=new ri;b.name="Background";a.Tl(b);b=new ri;b.name="";a.Tl(b);b=new ri;b.name="Foreground";a.Tl(b);b=new ri;b.name="Adornment";b.isTemporary=!0;a.Tl(b);b=new ri;b.name="Tool";b.isTemporary=!0;b.isBoundsIncluded=!0;a.Tl(b);b=new ri;b.name="Grid";b.allowSelect=!1;b.pickable=!1;b.isTemporary=!0;a.Ww(b,a.cm("Background"))}
function Ui(a){a.Hb=new W(W.Grid);a.Hb.name="GRID";var b=new Gg;b.figure="LineH";b.stroke="lightgray";b.strokeWidth=.5;b.interval=1;a.Hb.add(b);b=new Gg;b.figure="LineH";b.stroke="gray";b.strokeWidth=.5;b.interval=5;a.Hb.add(b);b=new Gg;b.figure="LineH";b.stroke="gray";b.strokeWidth=1;b.interval=10;a.Hb.add(b);b=new Gg;b.figure="LineV";b.stroke="lightgray";b.strokeWidth=.5;b.interval=1;a.Hb.add(b);b=new Gg;b.figure="LineV";b.stroke="gray";b.strokeWidth=.5;b.interval=5;a.Hb.add(b);b=new Gg;b.figure=
"LineV";b.stroke="gray";b.strokeWidth=1;b.interval=10;a.Hb.add(b);b=new R;b.add(a.Hb);b.layerName="Grid";b.zOrder=0;b.isInDocumentBounds=!1;b.isAnimated=!1;b.pickable=!1;b.locationObjectName="GRID";a.add(b);a.partManager.parts.remove(b);a.Hb.visible=!1}function Vi(){this.G.yu?this.G.yu=!1:this.G.isEnabled?this.G.ix(this):Wi(this.G)}function Xi(a){this.G.isEnabled?(this.G.Au=a.target.scrollTop,this.G.zu=a.target.scrollLeft):Wi(this.G)}
P.prototype.ix=function(a){if(null!==this.Ea){this.os=!0;var b=this.documentBounds,c=this.viewportBounds,d=this.ti,e=b.x-d.left,f=b.y-d.top,g=b.width+d.left+d.right,h=b.height+d.top+d.bottom,k=b.right+d.right;d=b.bottom+d.bottom;var l=c.x;b=c.y;var m=c.width,n=c.height,p=c.right,q=c.bottom;c=this.scale;var r=a.scrollLeft;if(this.Wn)switch(this.wu){case "negative":r=r+a.scrollWidth-a.clientWidth;break;case "reverse":r=a.scrollWidth-r-a.clientWidth}var u=r;m<g||n<h?(r=J.allocAt(this.position.x,this.position.y),
this.allowHorizontalScroll&&this.zu!==u&&(r.x=u/c+e,this.zu=u),this.allowVerticalScroll&&this.Au!==a.scrollTop&&(r.y=a.scrollTop/c+f,this.Au=a.scrollTop),this.position=r,J.free(r),this.mj=this.os=!1):(r=J.alloc(),a.ay&&this.allowHorizontalScroll&&(e<l&&(this.position=r.h(u+e,this.position.y)),k>p&&(this.position=r.h(-(this.rs.scrollWidth-this.Aa)+u-this.Aa/c+k,this.position.y))),a.by&&this.allowVerticalScroll&&(f<b&&(this.position=r.h(this.position.x,a.scrollTop+f)),d>q&&(this.position=r.h(this.position.x,
-(this.rs.scrollHeight-this.ya)+a.scrollTop-this.ya/c+d))),J.free(r),Yi(this),this.mj=this.os=!1,b=this.documentBounds,c=this.viewportBounds,k=b.right,p=c.right,d=b.bottom,q=c.bottom,e=b.x,l=c.x,f=b.y,b=c.y,m>=g&&e>=l&&k<=p&&(this.ip.style.width="1px"),n>=h&&f>=b&&d<=q&&(this.ip.style.height="1px"))}};P.prototype.computeBounds=function(){0<this.Fd.count&&bj(this);return cj(this)};
function cj(a){if(a.fixedBounds.o()){var b=a.fixedBounds.copy();b.Op(a.gb);return b}for(var c=!0,d=a.Ra.j,e=d.length,f=0;f<e;f++){var g=d[f];if(g.visible&&(!g.isTemporary||g.isBoundsIncluded)){g=g.Ga.j;for(var h=g.length,k=0;k<h;k++){var l=g[k];l.isInDocumentBounds&&l.isVisible()&&(l=l.actualBounds,l.o()&&(c?(c=!1,b=l.copy()):b.Xc(l)))}}}c&&(b=new L(0,0,0,0));b.Op(a.gb);return b}
P.prototype.computePartsBounds=function(a,b){void 0===b&&(b=!1);var c=null;if(Ja(a))for(var d=0;d<a.length;d++){var e=a[d];!b&&e instanceof Q||(e.cc(),null===c?c=e.actualBounds.copy():c.Xc(e.actualBounds))}else for(a=a.iterator;a.next();)d=a.value,!b&&d instanceof Q||(d.cc(),null===c?c=d.actualBounds.copy():c.Xc(d.actualBounds));return null===c?new L(NaN,NaN,0,0):c};
function dj(a,b){if((b||a.ie)&&!a.pb&&null!==a.Ea&&!a.animationManager.isAnimating&&a.documentBounds.o()){a.pb=!0;var c=a.cj;b&&a.ci!==Bi&&(c=a.ci);var d=c!==Bi?ej(a,c):a.scale;c=a.viewportBounds.copy();var e=a.Aa/d,f=a.ya/d,g=null,h=a.animationManager;h.sb&&(g=a.ua.copy());var k=a.ej,l=a.Rn;b&&!k.Za()&&(l.Za()||l.Cb())&&(k=l.Cb()?qd:l);fj(a,a.documentBounds,e,f,k,b);null!==g&&pi(h,g,a.ua);b=a.scale;a.scale=d;a.pb=!1;d=a.viewportBounds;d.Sa(c)||a.nq(c,d,b,!1)}}
function ej(a,b){var c=a.dr;if(null===a.Ea)return c;a.Rg&&gj(a,a.computeBounds());var d=a.documentBounds;if(!d.o())return c;var e=d.width;d=d.height;var f=a.Aa,g=a.ya,h=f/e,k=g/d;return b===hj?(b=Math.min(k,h),b>c&&(b=c),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):b===ij?(b=k>h?(g-a.Jb)/d:(f-a.Jb)/e,b>c&&(b=c),b<a.minScale&&(b=a.minScale),b>a.maxScale&&(b=a.maxScale),b):a.scale}
P.prototype.zoomToFit=function(){this.scale=ej(this,hj);this.scrollMode!==Ai&&fj(this,this.documentBounds,this.Aa/this.Da,this.ya/this.Da,this.ej,!0)};t=P.prototype;
t.hA=function(a,b){void 0===b&&(b=hj);var c=a.width,d=a.height;if(!(0===c||0===d||isNaN(c)&&isNaN(d))){var e=1;if(b===hj||b===ij)if(isNaN(c))e=this.viewportBounds.height*this.scale/d;else if(isNaN(d))e=this.viewportBounds.width*this.scale/c;else{e=this.Aa;var f=this.ya;e=b===ij?f/d>e/c?(f-(this.Qg?this.Jb:0))/d:(e-(this.ai?this.Jb:0))/c:Math.min(f/d,e/c)}this.scale=e;this.position=new J(a.x,a.y)}};
t.py=function(a,b){this.Rg&&gj(this,this.computeBounds());var c=this.documentBounds,d=this.viewportBounds;this.position=new J(c.x+(a.x*c.width+a.offsetX)-(b.x*d.width-b.offsetX),c.y+(a.y*c.height+a.offsetY)-(b.y*d.height-b.offsetY))};
function fj(a,b,c,d,e,f){a.ua.ja();var g=a.ua,h=g.x,k=g.y;if(f||a.scrollMode===Ai)e.Za()&&(c>b.width&&(h=b.x+(e.x*b.width+e.offsetX)-(e.x*c-e.offsetX)),d>b.height&&(k=b.y+(e.y*b.height+e.offsetY)-(e.y*d-e.offsetY))),e=a.ti,f=c-b.width,c<b.width+e.left+e.right?(h=Math.min(h+c/2,b.right+Math.max(f,e.right)-c/2),h=Math.max(h,b.left-Math.max(f,e.left)+c/2),h-=c/2):h>b.left?h=b.left:h<b.right-c&&(h=b.right-c),c=d-b.height,d<b.height+e.top+e.bottom?(k=Math.min(k+d/2,b.bottom+Math.max(c,e.bottom)-d/2),k=
Math.max(k,b.top-Math.max(c,e.top)+d/2),k-=d/2):k>b.top?k=b.top:k<b.bottom-d&&(k=b.bottom-d);g.x=isFinite(h)?h:-a.gb.left;g.y=isFinite(k)?k:-a.gb.top;null!==a.positionComputation&&(b=a.positionComputation(a,g),g.x=b.x,g.y=b.y);a.ua.freeze()}t.dm=function(a,b){void 0===b&&(b=!0);if(b){if(a=ug(this,a,function(a){return a.part},function(a){return a.canSelect()}),a instanceof R)return a}else if(a=ug(this,a,function(a){return a.part}),a instanceof R)return a;return null};
t.Tb=function(a,b,c){void 0===b&&(b=null);void 0===c&&(c=null);bj(this);for(var d=this.Ra.iteratorBackwards;d.next();){var e=d.value;if(e.visible&&(e=e.Tb(a,b,c),null!==e))return e}return null};function ug(a,b,c,d){void 0===c&&(c=null);void 0===d&&(d=null);bj(a);for(a=a.Ra.iteratorBackwards;a.next();){var e=a.value;if(e.visible&&!e.isTemporary&&(e=e.Tb(b,c,d),null!==e))return e}return null}
t.Xy=function(a,b,c){void 0===b&&(b=!0);return jj(this,a,function(a){return a.part},b?function(a){return a instanceof R&&a.canSelect()}:null,c)};function jj(a,b,c,d,e){void 0===c&&(c=null);void 0===d&&(d=null);e instanceof G||e instanceof I||(e=new I);bj(a);for(a=a.Ra.iteratorBackwards;a.next();){var f=a.value;f.visible&&!f.isTemporary&&f.Hi(b,c,d,e)}return e}
t.Hi=function(a,b,c,d){void 0===b&&(b=null);void 0===c&&(c=null);d instanceof G||d instanceof I||(d=new I);bj(this);for(var e=this.Ra.iteratorBackwards;e.next();){var f=e.value;f.visible&&f.Hi(a,b,c,d)}return d};t.ox=function(a,b,c,d){void 0===b&&(b=!1);void 0===c&&(c=!0);return kj(this,a,function(a){return a instanceof R&&(!c||a.canSelect())},b,d)};
t.pg=function(a,b,c,d,e){void 0===b&&(b=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof I||(e=new I);bj(this);for(var f=this.Ra.iteratorBackwards;f.next();){var g=f.value;g.visible&&g.pg(a,b,c,d,e)}return e};function kj(a,b,c,d,e){var f=null;void 0===f&&(f=null);void 0===c&&(c=null);void 0===d&&(d=!1);e instanceof G||e instanceof I||(e=new I);bj(a);for(a=a.Ra.iteratorBackwards;a.next();){var g=a.value;g.visible&&!g.isTemporary&&g.pg(b,f,c,d,e)}return e}
t.Yy=function(a,b,c,d,e){void 0===c&&(c=!0);void 0===d&&(d=!0);return lj(this,a,b,function(a){return a instanceof R&&(!d||a.canSelect())},c,e)};t.qg=function(a,b,c,d,e,f){void 0===c&&(c=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof I)f=e;e=!0}f instanceof G||f instanceof I||(f=new I);bj(this);for(var g=this.Ra.iteratorBackwards;g.next();){var h=g.value;h.visible&&h.qg(a,b,c,d,e,f)}return f};
function lj(a,b,c,d,e,f){var g=null;void 0===g&&(g=null);void 0===d&&(d=null);void 0===e&&(e=!0);if(!1!==e&&!0!==e){if(e instanceof G||e instanceof I)f=e;e=!0}f instanceof G||f instanceof I||(f=new I);bj(a);for(a=a.Ra.iteratorBackwards;a.next();){var h=a.value;h.visible&&!h.isTemporary&&h.qg(b,c,g,d,e,f)}return f}P.prototype.acceptEvent=function(a){return mj(this,a,a instanceof MouseEvent)};
function mj(a,b,c){var d=a.$e;a.$e=a.sj;a.sj=d;d.diagram=a;d.event=b;c?nj(a,b,d):(d.viewPoint=a.$e.viewPoint,d.documentPoint=a.$e.documentPoint);a=0;b.ctrlKey&&(a+=1);b.altKey&&(a+=2);b.shiftKey&&(a+=4);b.metaKey&&(a+=8);d.modifiers=a;d.button=b.button;void 0===b.buttons||fb||(d.buttons=b.buttons);kb&&0===b.button&&b.ctrlKey&&(d.button=2);d.down=!1;d.up=!1;d.clickCount=1;d.delta=0;d.handled=!1;d.bubbles=!1;d.timestamp=b.timeStamp;d.isMultiTouch=!1;d.targetDiagram=oj(b);d.targetObject=null;return d}
function oj(a){var b=a.target.G;if(!b){var c=a.path;c||"function"!==typeof a.composedPath||(c=a.composedPath());c&&c[0]&&(b=c[0].G)}return b?b:null}function pj(a,b,c,d){var e=qj(a,b,!0,!1,!0,d);nj(a,c,e);e.targetDiagram=oj(b);e.targetObject=null;d||e.clone(a.Zh);return e}
function rj(a,b,c,d){var e;d=qj(a,b,!1,!1,!1,d);null!==c?((e=qa.document.elementFromPoint(c.clientX,c.clientY))&&e.G?(b=c,c=e.G):(b=void 0!==b.targetTouches?b.targetTouches[0]:b,c=a),d.targetDiagram=c,nj(a,b,d)):null!==a.$e?(d.documentPoint=a.$e.documentPoint,d.viewPoint=a.$e.viewPoint,d.targetDiagram=a.$e.targetDiagram):null!==a.Zh&&(d.documentPoint=a.Zh.documentPoint,d.viewPoint=a.Zh.viewPoint,d.targetDiagram=a.Zh.targetDiagram);d.targetObject=null;return d}
function qj(a,b,c,d,e,f){var g=a.$e;a.$e=a.sj;a.sj=g;g.diagram=a;g.clickCount=1;var h=g.delta=0;b.ctrlKey&&(h+=1);b.altKey&&(h+=2);b.shiftKey&&(h+=4);b.metaKey&&(h+=8);g.modifiers=h;g.button=0;g.buttons=1;g.event=b;g.timestamp=b.timeStamp;a.Lq&&b instanceof qa.PointerEvent&&"touch"!==b.pointerType&&(g.button=b.button,void 0===b.buttons||fb||(g.buttons=b.buttons),kb&&0===b.button&&b.ctrlKey&&(g.button=2));g.down=c;g.up=d;g.handled=!1;g.bubbles=e;g.isMultiTouch=f;return g}
function sj(a,b,c){if(b.bubbles)return E&&E.tx&&Ga("NOT handled "+c.type+" "+b.toString()),!0;E&&E.tx&&Ga("handled "+c.type+" "+a.currentTool.name+" "+b.toString());void 0!==c.stopPropagation&&c.stopPropagation();c.preventDefault();c.cancelBubble=!0;return!1}
P.prototype.Dz=function(a){var b=this.G;if(!this.G.isEnabled)return!1;var c=mj(b,a,!1);c.key=String.fromCharCode(a.which);c.down=!0;switch(a.which){case 8:c.key="Backspace";break;case 33:c.key="PageUp";break;case 34:c.key="PageDown";break;case 35:c.key="End";break;case 36:c.key="Home";break;case 37:c.key="Left";break;case 38:c.key="Up";break;case 39:c.key="Right";break;case 40:c.key="Down";break;case 45:c.key="Insert";break;case 46:c.key="Del";break;case 48:c.key="0";break;case 187:case 61:case 107:c.key=
"Add";break;case 189:case 173:case 109:c.key="Subtract";break;case 27:c.key="Esc"}b.doKeyDown();return sj(b,c,a)};
P.prototype.Ez=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=mj(b,a,!1);c.key=String.fromCharCode(a.which);c.up=!0;switch(a.which){case 8:c.key="Backspace";break;case 33:c.key="PageUp";break;case 34:c.key="PageDown";break;case 35:c.key="End";break;case 36:c.key="Home";break;case 37:c.key="Left";break;case 38:c.key="Up";break;case 39:c.key="Right";break;case 40:c.key="Down";break;case 45:c.key="Insert";break;case 46:c.key="Del"}b.doKeyUp();return sj(b,c,a)};
P.prototype.Jy=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=mj(b,a,!0);null!==b.mouseEnter&&b.mouseEnter(c);return sj(b,c,a)};P.prototype.Ky=function(a){var b=this.G;if(!b.isEnabled)return!1;var c=mj(b,a,!0);null!==b.mouseLeave&&b.mouseLeave(c);return sj(b,c,a)};
P.prototype.getMouse=function(a){var b=this.Ea;if(null===b)return new J(0,0);var c=b.getBoundingClientRect();b=a.clientX-this.Aa/c.width*c.left;a=a.clientY-this.ya/c.height*c.top;return null!==this.ub?ac(new J(b,a),this.ub):new J(b,a)};
function nj(a,b,c){var d=a.Ea,e=a.Aa,f=a.ya,g=0,h=0;null!==d&&(d=d.getBoundingClientRect(),g=b.clientX-e/d.width*d.left,h=b.clientY-f/d.height*d.top);c.viewPoint.h(g,h);null!==a.ub?(b=J.allocAt(g,h),a.ub.Vd(b),c.documentPoint.assign(b),J.free(b)):c.documentPoint.h(g,h)}
function lf(a,b,c,d){if(void 0!==b.targetTouches){if(2>b.targetTouches.length)return;b=b.targetTouches[c]}else if(null!==a.yl[0])b=a.yl[c];else return;c=a.Ea;null!==c&&(c=c.getBoundingClientRect(),d.h(b.clientX-a.Aa/c.width*c.left,b.clientY-a.ya/c.height*c.top))}t=P.prototype;t.Ya=function(){this.Rg||(this.Rg=!0,this.ec(!0))};function oi(a){a.$b||bj(a);a.Rg&&gj(a,a.computeBounds())}t.Ch=function(){this.pb||this.$b||(this.S(),tj(this),Yi(this),this.Ya(),this.hd())};t.Cz=function(){return this.sd};
t.Ey=function(a){void 0===a&&(a=null);var b=this.animationManager,c=b.isEnabled;b.xd();b.isEnabled=!1;Dg(this);this.ie=!1;b.isEnabled=c;null!==a&&wa(a,1)};t.ec=function(a){void 0===a&&(a=!1);if(!0!==this.sd&&!(this.pb||!1===a&&this.$b)){this.sd=!0;var b=this;qa.requestAnimationFrame(function(){b.sd&&b.hd()})}};t.hd=function(){if(!this.$k||this.sd)this.$k&&(this.$k=!1),Dg(this)};function uj(a,b){a.animationManager.isAnimating||a.pb||!a.mj||Wi(a)||(b&&bj(a),dj(a,!1))}
function Dg(a,b){if(!a.$b&&(a.sd=!1,null!==a.Ja||a.Hp.o())){a.$b=!0;var c=a.animationManager,d=a.ru;if(!c.isTicking&&0!==d.length){for(var e=d.j,f=e.length,g=0;g<f;g++){var h=e[g];vj(h,!1);h.v()}d.clear()}d=a.Ew;0<d.count&&(d.each(function(a){a.bw()}),d.clear());e=d=!1;c.isAnimating&&(e=!0,d=a.skipsUndoManager,a.skipsUndoManager=!0);c.sb||ei(a);uj(a,!1);null!==a.Hb&&(a.Hb.visible&&!a.qr&&(wj(a),a.qr=!0),!a.Hb.visible&&a.qr&&(a.qr=!1));bj(a);f=!1;if(!a.ie||a.Cg)a.ie?xj(a,!a.Tk):(a.Ca("Initial Layout"),
!1===c.isEnabled&&c.xd(),xj(a,!1)),f=!0;a.Tk=!1;bj(a);a.Bu||c.isAnimating||oi(a);uj(a,!0);f&&(a.ie||yj(a),a.ba("LayoutCompleted"));bj(a);f&&!a.ie&&(a.ie=!0,a.ab("Initial Layout"),a.skipsUndoManager||a.undoManager.clear(),wa(function(){a.isModified=!1},1));a.Pu();di(c);b||a.kc(a.$c);e&&(a.skipsUndoManager=d);a.$b=!1}}
function yj(a){var b=a.Ra.j;a.kd(b,b.length,a);a.ci!==Bi?a.scale=ej(a,a.ci):a.cj!==Bi?a.scale=ej(a,a.cj):(b=a.initialScale,isFinite(b)&&0<b&&(a.scale=b));b=a.initialPosition;if(b.o())a.position=b;else{b=J.alloc();b.Vi(a.documentBounds,a.initialDocumentSpot);var c=a.viewportBounds;c=L.allocAt(0,0,c.width,c.height);var d=J.alloc();d.Vi(c,a.initialViewportSpot);d.h(b.x-d.x,b.y-d.y);a.position=d;L.free(c);J.free(d);J.free(b);tj(a);uj(a,!0);dj(a,!0)}a.ba("InitialLayoutCompleted");wj(a)}
function bj(a){if((a.$b||!a.animationManager.isAnimating)&&0!==a.Fd.count){for(var b=0;23>b;b++){var c=a.Fd.iterator;if(null===c||0===a.Fd.count)break;a.Fd=new I;a.bw(c,a.Fd);E&&22===b&&Ga("failure to validate parts")}a.nodes.each(function(a){a instanceof wg&&0!==(a.$&65536)!==!1&&(a.$=a.$^65536)})}}
t.bw=function(a,b){for(a.reset();a.next();){var c=a.value;!c.Ob()||c instanceof wg||(c.Si()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c))}for(a.reset();a.next();)c=a.value,c instanceof wg&&c.isVisible()&&zj(this,c);for(a.reset();a.next();)c=a.value,c instanceof Q&&c.isVisible()&&(c.Si()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c));for(a.reset();a.next();)c=a.value,c instanceof Cf&&c.isVisible()&&(c.Si()?(c.measure(Infinity,Infinity),c.arrange()):b.add(c))};
function zj(a,b){for(var c=Qa(),d=Qa(),e=b.memberParts;e.next();){var f=e.value;f.isVisible()&&(f instanceof wg?(Aj(f)||Bj(f)||Cj(f))&&zj(a,f):f instanceof Q?f.fromNode===b||f.toNode===b?d.push(f):c.push(f):(f.measure(Infinity,Infinity),f.arrange()))}a=c.length;for(e=0;e<a;e++)f=c[e],f.measure(Infinity,Infinity),f.arrange();Ta(c);b.measure(Infinity,Infinity);b.arrange();a=d.length;for(b=0;b<a;b++)c=d[b],c.measure(Infinity,Infinity),c.arrange();Ta(d)}
t.kd=function(a,b,c,d){if(this.di||this.animationManager.isAnimating)for(var e=0;e<b;e++)a[e].kd(c,d)};
t.kc=function(a,b){void 0===b&&(b=null);if(null!==this.Ja){null===this.Ea&&v("No canvas specified");var c=this.animationManager;if(!c.sb){var d=new Date;Dj(this);if("0"!==this.Ja.style.opacity){var e=a!==this.$c,f=this.Ra.j,g=f.length,h=this;this.kd(f,g,h);if(e)a.Tc(!0),Yi(this);else if(!this.pc&&null===b&&!c.isAnimating)return;g=this.ua;var k=this.Da,l=Math.round(g.x*k)/k,m=Math.round(g.y*k)/k;c=this.ub;c.reset();1!==k&&c.scale(k);0===g.x&&0===g.y||c.translate(-l,-m);k=this.bc;a.setTransform(1,0,
0,1,0,0);a.scale(k,k);a.clearRect(0,0,this.Aa,this.ya);a.setTransform(1,0,0,1,0,0);a.scale(k,k);a.transform(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy);E&&E.Di&&E.Xu&&E.Xu(this,a);l=null!==b?function(c){var d=b;if(c.visible&&0!==c.mb){var e=c.Ga.j,f=e.length;if(0!==f){1!==c.mb&&(a.globalAlpha=c.mb);c=c.Mo;c.length=0;for(var g=h.scale,k=0;k<f;k++){var l=e[k];if(Cg(l)&&!d.contains(l)){if(l instanceof Q&&(l.isOrthogonal&&c.push(l),!1===l.Lc))continue;var m=l.actualBounds;1<m.width*g||1<m.height*g?l.kc(a,h):ui(a,
l)}}a.globalAlpha=1}}}:function(b){b.kc(a,h)};Ej(this,a);g=f.length;for(m=0;m<g;m++)a.setTransform(1,0,0,1,0,0),a.scale(k,k),a.transform(c.m11,c.m12,c.m21,c.m22,c.dx,c.dy),l(f[m]);this.bi&&Fj(this.bi,this)&&this.hr();E&&(E.Yu||E.Di)&&E.Tp&&E.Tp(a,this,c);e?(this.$c.Tc(!0),Yi(this)):this.pc=this.di=!1;d=+new Date-+d;null===this.xe&&(this.iu=d)}}}};
function Gj(a,b,c,d,e,f,g,h,k,l){if(null!==a.Ja){null===a.Ea&&v("No canvas specified");void 0===g&&(g=null);void 0===h&&(h=null);void 0===k&&(k=!1);void 0===l&&(l=!1);Dj(a);a.$c.Tc(!0);Yi(a);a.oj=!0;var m=a.Da;a.Da=e;var n=a.Ra.j,p=n.length;try{var q=new L(f.x,f.y,d.width/e,d.height/e),r=q.copy();r.Op(c);wj(a,r);bj(a);a.kd(n,p,a,q);var u=a.bc;b.setTransform(1,0,0,1,0,0);b.scale(u,u);b.clearRect(0,0,d.width,d.height);null!==h&&""!==h&&(b.fillStyle=h,b.fillRect(0,0,d.width,d.height));var y=$b.alloc();
y.reset();y.translate(c.left,c.top);y.scale(e);0===f.x&&0===f.y||y.translate(-f.x,-f.y);b.setTransform(y.m11,y.m12,y.m21,y.m22,y.dx,y.dy);$b.free(y);Ej(a,b);if(null!==g){var x=new I,A=g.iterator;for(A.reset();A.next();){var C=A.value;!1===l&&"Grid"===C.layer.name||null===C||x.add(C)}var F=function(c){var d=k;if(c.visible&&0!==c.mb&&(void 0===d&&(d=!0),d||!c.isTemporary)){d=c.Ga.j;var e=d.length;if(0!==e){1!==c.mb&&(b.globalAlpha=c.mb);c=c.Mo;c.length=0;for(var f=a.scale,g=0;g<e;g++){var h=d[g];if(Cg(h)&&
x.contains(h)){if(h instanceof Q&&(h.isOrthogonal&&c.push(h),!1===h.Lc))continue;var l=h.actualBounds;1<l.width*f||1<l.height*f?h.kc(b,a):ui(b,h)}}b.globalAlpha=1}}}}else if(!k&&l){var H=a.grid.part,O=H.layer;F=function(c){c===O?H.kc(b,a):c.kc(b,a,k)}}else F=function(c){c.kc(b,a,k)};for(c=0;c<p;c++)F(n[c]);a.oj=!1;a.bi&&Fj(a.bi,a)&&a.hr()}finally{a.Da=m,a.$c.Tc(!0),Yi(a),a.kd(n,p,a),wj(a)}}}t.Fe=function(a){return this.ah[a]};t.Mx=function(a,b){this.ah[a]=b;this.Ch()};
t.Hv=function(){this.ah=new xb;this.ah.drawShadows=!0;this.ah.textGreeking=!0;this.ah.viewportOptimizations=lb||gb||ib?!1:!0;this.ah.temporaryPixelRatio=!0;this.ah.pictureRatioOptimization=!0};function Ej(a,b){a=a.ah;null!==a&&(void 0!==a.imageSmoothingEnabled&&b.zt(!!a.imageSmoothingEnabled),a=a.defaultFont,void 0!==a&&null!==a&&(b.font=a))}t.fm=function(a){return this.gl[a]};t.Yz=function(a,b){this.gl[a]=b};
t.Gv=function(){this.gl=new xb;this.gl.extraTouchArea=10;this.gl.extraTouchThreshold=10;this.gl.hasGestureZoom=!0};t.Qv=function(a){Hj(this,a)};
function Hj(a,b){var c=a instanceof W,d=a instanceof P,e;for(e in b){""===e&&v("Setting properties requires non-empty property names");var f=a,g=e;if(c||d){var h=e.indexOf(".");if(0<h){var k=e.substring(0,h);if(c)f=a.bb(k);else if(f=a[k],void 0===f||null===f)f=a.toolManager[k];Ia(f)?g=e.substr(h+1):v("Unable to find object named: "+k+" in "+a.toString()+" when trying to set property: "+e)}}if("_"!==g[0]&&!Ya(f,g))if(d&&"ModelChanged"===g){a.Yw(b[g]);continue}else if(d&&"Changed"===g){a.rh(b[g]);continue}else if(d&&
Ya(a.toolManager,g))f=a.toolManager;else if(d&&Ij(a,g)){a.Oj(g,b[g]);continue}else if(a instanceof X&&"Changed"===g){a.rh(b[g]);continue}else v('Trying to set undefined property "'+g+'" on object: '+f.toString());f[g]=b[e];"_"===g[0]&&f instanceof N&&f.Vw(g)}}t.Pu=function(){if(0===this.undoManager.transactionLevel&&0!==this.Yh.count){for(;0<this.Yh.count;){var a=this.Yh;this.Yh=new Ub;for(a=a.iterator;a.next();){var b=a.key;b.eq(a.value);b.dc()}}this.S()}};
t.S=function(a){void 0===a&&(a=null);if(null===a)this.pc=!0,this.ec();else{var b=this.viewportBounds;null!==a&&a.o()&&b.Kc(a)&&(this.pc=!0,this.ec())}this.ba("InvalidateDraw")};
t.ux=function(a,b){if(!0!==this.pc){this.pc=!0;var c=!0===this.Fe("temporaryPixelRatio");if(!0===this.Fe("viewportOptimizations")&&this.scrollMode!==Jj&&this.ti.Fi(0,0,0,0)&&b.width===a.width&&b.height===a.height){var d=this.scale,e=Math.max(a.x,b.x),f=Math.max(a.y,b.y);d=L.allocAt(e,f,Math.max(0,Math.min(a.x+a.width,b.x+b.width)-e)*d,Math.max(0,Math.min(a.y+a.height,b.y+b.height)-f)*d);if(!this.Cs&&0<d.width&&0<d.height){if(!(this.$b||(this.sd=!1,null===this.Ja||(this.$b=!0,this.Pu(),this.documentBounds.o()||
gj(this,this.computeBounds()),e=this.Ea,null===e||e instanceof Kj)))){var g=this.bc;f=this.Aa*g;var h=this.ya*g,k=this.scale*g,l=Math.round(Math.round(b.x*k)-Math.round(a.x*k));b=Math.round(Math.round(b.y*k)-Math.round(a.y*k));k=this.Yt;a=this.zw;k.width!==f&&(k.width=f);k.height!==h&&(k.height=h);a.clearRect(0,0,f,h);k=190*g;var m=70*g,n=Math.max(l,0),p=Math.max(b,0),q=Math.floor(f-n),r=Math.floor(h-p);a.zt(!1);a.drawImage(e.Ha,n,p,q,r,0,0,q,r);Fj(this.bi,this)&&a.clearRect(0,0,k,m);e=Qa();a=Qa();
r=Math.abs(l);q=Math.abs(b);var u=0===n?0:f-r;n=J.allocAt(u,0);r=J.allocAt(r+u,h);a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));var y=this.ub;y.reset();y.scale(g,g);1!==this.Da&&y.scale(this.Da);g=this.ua;(0!==g.x||0!==g.y)&&isFinite(g.x)&&isFinite(g.y)&&y.translate(-g.x,-g.y);ac(n,y);ac(r,y);e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));u=0===p?0:h-q;n.h(0,u);r.h(f,q+u);a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),
Math.abs(n.x-r.x),Math.abs(n.y-r.y)));ac(n,y);ac(r,y);e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y)));Fj(this.bi,this)&&(f=0<l?0:-l,h=0<b?0:-b,n.h(f,h),r.h(k+f,m+h),a.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y))),ac(n,y),ac(r,y),e.push(new L(Math.min(n.x,r.x),Math.min(n.y,r.y),Math.abs(n.x-r.x),Math.abs(n.y-r.y))));J.free(n);J.free(r);uj(this,!1);null===this.Ja&&v("No div specified");null===this.Ea&&v("No canvas specified");
if(!this.animationManager.sb&&(f=this.$c,this.pc)){Dj(this);h=this.bc;f.setTransform(1,0,0,1,0,0);f.clearRect(0,0,this.Aa*h,this.ya*h);f.zt(!1);f.drawImage(this.Yt.Ha,0<l?0:Math.round(-l),0<b?0:Math.round(-b));b=this.ua;g=this.Da;k=Math.round(b.x*g)/g;m=Math.round(b.y*g)/g;l=this.ub;l.reset();1!==g&&l.scale(g);0===b.x&&0===b.y||l.translate(-k,-m);f.save();f.beginPath();b=a.length;for(g=0;g<b;g++)k=a[g],0!==k.width&&0!==k.height&&f.rect(Math.floor(k.x),Math.floor(k.y),Math.ceil(k.width),Math.ceil(k.height));
f.clip();f.setTransform(1,0,0,1,0,0);f.scale(h,h);f.transform(l.m11,l.m12,l.m21,l.m22,l.dx,l.dy);E&&E.Di&&E.Xu&&E.Xu(this,f);h=this.Ra.j;b=h.length;this.kd(h,b,this);Ej(this,f);for(g=0;g<b;g++)if(n=h[g],k=e,n.visible&&0!==n.mb){1!==n.mb&&(f.globalAlpha=n.mb);m=n.Mo;m.length=0;p=this.scale;n=n.Ga.j;q=n.length;r=k.length;for(y=0;y<q;y++)if(u=n[y],Cg(u)){if(u instanceof Q&&(u.isOrthogonal&&m.push(u),!1===u.Lc))continue;var x=Lj(u,u.actualBounds);a:{var A=x;for(var C=k,F=r,H=2/p,O=4/p,S=0;S<F;S++){var T=
C[S];if(0!==T.width&&0!==T.height&&A.mv(T.x-H,T.y-H,T.width+O,T.height+O)){A=!0;break a}}A=!1}A&&(1<x.width*p||1<x.height*p?u.kc(f,this):ui(f,u))}f.globalAlpha=1}f.restore();f.Tc(!0);E&&(E.Yu||E.Di)&&E.Tp&&E.Tp(f,this,l);this.bi&&Fj(this.bi,this)&&this.hr();this.pc=this.di=!1;this.st()}Ta(e);Ta(a);this.$b=!1}}else this.hd();L.free(d);c&&(this.xe=1,this.hd(),gg(this,!0))}else c?(this.xe=1,this.hd(),gg(this,!0)):this.hd()}};function tj(a){!1===a.mj&&(a.mj=!0)}function Yi(a){!1===a.di&&(a.di=!0)}
function Dj(a){!1!==a.Sn&&(a.Sn=!1,Mj(a,a.Aa,a.ya))}function Mj(a,b,c){var d=a.bc;a.Ea.resize(b*d,c*d,b,c)&&(a.pc=!0,a.$c.Tc(!0))}
function Wi(a){var b=a.Ea;if(null===b)return!0;var c=a.Ja,d=a.Aa,e=a.ya,f=a.Sw.copy();if(!f.o())return!0;var g=!1,h=a.ai?a.Jb:0,k=a.Qg?a.Jb:0,l=c.clientWidth||d+h;c=c.clientHeight||e+k;if(l!==d+h||c!==e+k)a.ai=!1,a.Qg=!1,k=h=0,a.Aa=l,a.ya=c,g=a.Sn=!0;a.mj=!1;var m=a.documentBounds,n=0,p=0,q=0,r=0;l=f.width;c=f.height;var u=a.ti;a.contentAlignment.Za()?(m.width>l&&(n=u.left,p=u.right),m.height>c&&(q=u.top,r=u.bottom)):(n=u.left,p=u.right,q=u.top,r=u.bottom);u=m.width+n+p;var y=m.height+q+r;n=m.x-n;
var x=f.x;p=m.right+p;var A=f.right+h;q=m.y-q;var C=f.y;r=m.bottom+r;var F=f.bottom+k,H="1px",O="1px";m=a.scale;var S=!(u<l+h),T=!(y<c+k);a.scrollMode===Ai&&(S||T)&&(S&&a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(H=1,n+1<x&&(H=Math.max((x-n)*m+a.Aa,H)),p>A+1&&(H=Math.max((p-A)*m+a.Aa,H)),l+h+1<u&&(H=Math.max((u-l+h)*m+a.Aa,H)),H=H.toString()+"px"),T&&a.hasVerticalScrollbar&&a.allowVerticalScroll&&(O=1,q+1<C&&(O=Math.max((C-q)*m+a.ya,O)),r>F+1&&(O=Math.max((r-F)*m+a.ya,O)),c+k+1<y&&(O=Math.max((y-
c+k)*m+a.ya,O)),O=O.toString()+"px"));T="1px"!==H;S="1px"!==O;T&&S||!T&&!S||(S&&(A-=a.Jb),T&&(F-=a.Jb),u<l+h||!a.hasHorizontalScrollbar||!a.allowHorizontalScroll||(h=1,n+1<x&&(h=Math.max((x-n)*m+a.Aa,h)),p>A+1&&(h=Math.max((p-A)*m+a.Aa,h)),l+1<u&&(h=Math.max((u-l)*m+a.Aa,h)),H=h.toString()+"px"),T="1px"!==H,h=a.ya,T!==a.Qg&&(h=T?a.ya-a.Jb:a.ya+a.Jb),y<c+k||!a.hasVerticalScrollbar||!a.allowVerticalScroll||(k=1,q+1<C&&(k=Math.max((C-q)*m+h,k)),r>F+1&&(k=Math.max((r-F)*m+h,k)),c+1<y&&(k=Math.max((y-
c)*m+h,k)),O=k.toString()+"px"),S="1px"!==O);if(a.os&&T===a.Qg&&S===a.ai)return d===a.Aa&&e===a.ya||a.hd(),!1;T!==a.Qg&&("1px"===H?a.ya=a.ya+a.Jb:a.ya=Math.max(a.ya-a.Jb,1),g=!0);a.Qg=T;a.ip.style.width=H;S!==a.ai&&("1px"===O?a.Aa=a.Aa+a.Jb:a.Aa=Math.max(a.Aa-a.Jb,1),g=!0,a.Wn&&(k=J.alloc(),S?(b.style.left=a.Jb+"px",a.position=k.h(a.ua.x+a.Jb/a.scale,a.ua.y)):(b.style.left="0px",a.position=k.h(a.ua.x-a.Jb/a.scale,a.ua.y)),J.free(k)));a.ai=S;a.ip.style.height=O;a.yu=!0;g&&(a.Sn=!0);b=a.rs;k=b.scrollLeft;
a.hasHorizontalScrollbar&&a.allowHorizontalScroll&&(l+1<u?k=(a.position.x-n)*m:n+1<x?k=b.scrollWidth-b.clientWidth:p>A+1&&(k=a.position.x*m));if(a.Wn)switch(a.wu){case "negative":k=-(b.scrollWidth-k-b.clientWidth);break;case "reverse":k=b.scrollWidth-k-b.clientWidth}b.scrollLeft=k;a.hasVerticalScrollbar&&a.allowVerticalScroll&&(c+1<y?b.scrollTop=(a.position.y-q)*m:q+1<C?b.scrollTop=b.scrollHeight-b.clientHeight:r>F+1&&(b.scrollTop=a.position.y*m));l=a.Aa;c=a.ya;b.style.width=l+(a.ai?a.Jb:0)+"px";
b.style.height=c+(a.Qg?a.Jb:0)+"px";return d!==l||e!==c||a.animationManager.sb?(a.nq(f,a.viewportBounds,m,g),!1):!0}
t.add=function(a){w(a,R,P,"add:part");var b=a.diagram;if(b!==this&&(null!==b&&v("Cannot add part "+a.toString()+" to "+this.toString()+". It is already a part of "+b.toString()),b=this.cm(a.layerName),null===b&&(b=this.cm("")),null===b&&v('Cannot add a Part when unable find a Layer named "'+a.layerName+'" and there is no default Layer'),a.layer!==b)){var c=b.Pi(99999999,a,a.diagram===this);0<=c&&this.cb(qf,"parts",b,null,a,null,c);b.isTemporary||this.Ya();a.C(1);c=a.layerChanged;null!==c&&c(a,null,
b)}};t.Pi=function(a){this.partManager.Pi(a);var b=this;Nj(a,function(a){Oj(b,a)});(a instanceof Cf||a instanceof wg&&null!==a.placeholder)&&a.v();null!==a.data&&Nj(a,function(a){Pj(b.partManager,a)});!0!==Bj(a)&&!0!==Cj(a)||this.Fd.add(a);Qj(a,!0,this);Rj(a)?(a.actualBounds.o()&&this.S(Lj(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.o()&&this.S(Lj(a,a.actualBounds));this.ec()};
t.zc=function(a){a.Tj();this.partManager.zc(a);var b=this;Nj(a,function(a){Sj(b,a)});null!==a.data&&Nj(a,function(a){Tj(b.partManager,a)});this.Fd.remove(a);Rj(a)?(a.actualBounds.o()&&this.S(Lj(a,a.actualBounds)),this.Ya()):a.isVisible()&&a.actualBounds.o()&&this.S(Lj(a,a.actualBounds));this.ec()};t.remove=function(a){w(a,R,P,"remove:part");Uj(this,a,!0)};
function Uj(a,b,c){var d=b.layer;if(null!==d&&d.diagram===a){b.isSelected=!1;b.isHighlighted=!1;var e=a.animationManager;e.Ye&&b.Ob()&&e.animationReasons.contains("Remove")&&(e.nf(b,"scale",b.scale,.01,!1),e.nf(b,"angle",b.angle,180,!1));b.C(2);c&&b.Zj();c=d.zc(-1,b,!1);0<=c&&a.cb(rf,"parts",d,b,null,c,null);a=b.layerChanged;null!==a&&a(b,d,null)}}
t.vt=function(a,b){if(Ja(a))for(var c=a.length,d=0;d<c;d++){var e=a[d];b&&!e.canDelete()||this.remove(e)}else for(c=new I,c.addAll(a),a=c.iterator;a.next();)c=a.value,b&&!c.canDelete()||this.remove(c)};t.Yj=function(a,b,c){return this.partManager.Yj(a,b,c)};
P.prototype.moveParts=function(a,b,c,d){void 0===d&&(d=Vj(this));w(b,J,P,"moveParts:offset");if(null!==this.toolManager){var e=new Ub;if(null!==a)if(Ja(a))for(var f=0;f<a.length;f++)Wj(this,e,a[f],c,d);else for(a=a.iterator;a.next();)Wj(this,e,a.value,c,d);else{for(a=this.parts;a.next();)Wj(this,e,a.value,c,d);for(a=this.nodes;a.next();)Wj(this,e,a.value,c,d);for(a=this.links;a.next();)Wj(this,e,a.value,c,d)}og(this,e,b,d,c)}};
function Wj(a,b,c,d,e){void 0===e&&(e=Vj(a));if(!b.contains(c)&&(!d||c.canMove()||c.canCopy()))if(c instanceof V){b.add(c,a.rd(e,c,c.location));if(c instanceof wg)for(var f=c.memberParts;f.next();)Wj(a,b,f.value,d,e);for(f=c.linksConnected;f.next();){var g=f.value;if(!b.contains(g)){var h=g.fromNode,k=g.toNode;null!==h&&b.contains(h)&&null!==k&&b.contains(k)&&Wj(a,b,g,d,e)}}if(e.dragsTree)for(c=c.ev();c.next();)Wj(a,b,c.value,d,e)}else if(c instanceof Q)for(b.add(c,a.rd(e,c)),c=c.labelNodes;c.next();)Wj(a,
b,c.value,d,e);else c instanceof Cf||b.add(c,a.rd(e,c,c.location))}
function og(a,b,c,d,e){if(null!==b&&(w(b,Ub,P,"moveParts:parts"),0!==b.count)){var f=J.alloc(),g=J.alloc();g.assign(c);isNaN(g.x)&&(g.x=0);isNaN(g.y)&&(g.y=0);(c=a.yp)||Yf(a,b);for(var h=Qa(),k=Qa(),l=b.iterator,m=J.alloc();l.next();){var n=l.key,p=l.value;if(n.Ob()){var q=Xj(a,n,b);if(null!==q)h.push(new Yj(n,p,q));else if(!e||n.canMove())q=p.point,f.assign(q),a.computeMove(n,f.add(g),d,m),n.location=m,void 0===p.shifted&&(p.shifted=new J),p.shifted.assign(m.Yd(q))}else l.key instanceof Q&&k.push(l.pa)}J.free(m);
e=h.length;for(l=0;l<e;l++)n=h[l],f.assign(n.info.point),void 0===n.jv.shifted&&(n.jv.shifted=new J),n.node.location=f.add(n.jv.shifted);e=J.alloc();l=J.alloc();n=k.length;for(p=0;p<n;p++){var r=k[p];q=r.key;if(q instanceof Q)if(q.suspendsRouting){q.dh=null;m=q.fromNode;var u=q.toNode;if(null!==a.draggedLink&&d.dragsLink)if(u=r.value.point,null===q.dragComputation)b.add(q,a.rd(d,q,g)),mg(q,g.x-u.x,g.y-u.y);else{r=J.allocAt(0,0);(m=q.i(0))&&m.o()&&r.assign(m);var y=m=J.alloc().assign(r).add(g);d.isGridSnapEnabled&&
(d.isGridSnapRealtime||a.lastInput.up)&&(y=J.alloc(),th(a,q,m,y,d));m.assign(q.dragComputation(q,m,y)).Yd(r);b.add(q,a.rd(d,q,m));mg(q,m.x-u.x,m.y-u.y);J.free(r);J.free(m);y!==m&&J.free(y)}else null!==m&&(e.assign(m.location),y=b.K(m),null!==y&&e.Yd(y.point)),null!==u&&(l.assign(u.location),y=b.K(u),null!==y&&l.Yd(y.point)),null!==m&&null!==u?e.Sa(l)?(m=r.value.point,u=f,u.assign(e),u.Yd(m),b.add(q,a.rd(d,q,e)),mg(q,u.x,u.y)):(q.suspendsRouting=!1,q.Ta()):(r=r.value.point,m=null!==m?e:null!==u?l:
g,b.add(q,a.rd(d,q,m)),mg(q,m.x-r.x,m.y-r.y))}else if(null===q.fromNode||null===q.toNode)m=r.value.point,b.add(q,a.rd(d,q,g)),mg(q,g.x-m.x,g.y-m.y)}J.free(f);J.free(g);J.free(e);J.free(l);Ta(h);Ta(k);c||(bj(a),cg(a,b))}}
P.prototype.computeMove=function(a,b,c,d){void 0===d&&(d=new J);d.assign(b);if(null===a)return d;var e=b,f=c.isGridSnapEnabled;f&&(c.isGridSnapRealtime||this.lastInput.up)&&(e=J.alloc(),th(this,a,b,e,c));c=null!==a.dragComputation?a.dragComputation(a,b,e):e;var g=a.minLocation,h=g.x;isNaN(h)&&(h=f?Math.round(a.location.x):a.location.x);g=g.y;isNaN(g)&&(g=f?Math.round(a.location.y):a.location.y);var k=a.maxLocation,l=k.x;isNaN(l)&&(l=f?Math.round(a.location.x):a.location.x);k=k.y;isNaN(k)&&(k=f?Math.round(a.location.y):
a.location.y);d.h(Math.max(h,Math.min(c.x,l)),Math.max(g,Math.min(c.y,k)));e!==b&&J.free(e);return d};function Vj(a){var b=a.toolManager.findTool("Dragging");return null!==b?b.dragOptions:a.Nk}
function th(a,b,c,d,e){void 0===e&&(e=Vj(a));d.assign(c);if(null!==b){var f=a.grid;b=e.gridSnapCellSize;a=b.width;b=b.height;var g=e.gridSnapOrigin,h=g.x;g=g.y;e=e.gridSnapCellSpot;if(null!==f){var k=f.gridCellSize;isNaN(a)&&(a=k.width);isNaN(b)&&(b=k.height);f=f.gridOrigin;isNaN(h)&&(h=f.x);isNaN(g)&&(g=f.y)}f=J.allocAt(0,0);f.rk(0,0,a,b,e);K.Xp(c.x,c.y,h+f.x,g+f.y,a,b,d);J.free(f)}}function Yf(a,b){if(null!==b)for(a.yp=!0,a=b.iterator;a.next();)b=a.key,b instanceof Q&&(b.suspendsRouting=!0)}
function cg(a,b){if(null!==b){for(b=b.iterator;b.next();){var c=b.key;c instanceof Q&&(c.suspendsRouting=!1,Zj(c)&&c.Ta())}a.yp=!1}}function Xj(a,b,c){b=b.containingGroup;if(null!==b){a=Xj(a,b,c);if(null!==a)return a;a=c.K(b);if(null!==a)return a}return null}t=P.prototype;t.rd=function(a,b,c){if(void 0===c)return new ag(gc);var d=a.isGridSnapEnabled;a.sz||null===b.containingGroup||(d=!1);return d?new ag(new J(Math.round(c.x),Math.round(c.y))):new ag(c.copy())};
function ak(a,b,c){w(b,ri,P,"addLayer:layer");null!==b.diagram&&b.diagram!==a&&v("Cannot share a Layer with another Diagram: "+b+" of "+b.diagram);null===c?null!==b.diagram&&v("Cannot add an existing Layer to this Diagram again: "+b):(w(c,ri,P,"addLayer:existingLayer"),c.diagram!==a&&v("Existing Layer must be in this Diagram: "+c+" not in "+c.diagram),b===c&&v("Cannot move a Layer before or after itself: "+b));if(b.diagram!==a){b=b.name;a=a.Ra;c=a.count;for(var d=0;d<c;d++)a.O(d).name===b&&v("Cannot add Layer with the name '"+
b+"'; a Layer with the same name is already present in this Diagram.")}}t.Tl=function(a){ak(this,a,null);a.ib(this);var b=this.Ra,c=b.count-1;if(!a.isTemporary)for(;0<=c&&b.O(c).isTemporary;)c--;b.Lb(c+1,a);null!==this.ac&&this.cb(qf,"layers",this,null,a,null,c+1);this.S();this.Ya()};
t.Ww=function(a,b){ak(this,a,b);a.ib(this);var c=this.Ra,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.ac&&this.cb(rf,"layers",this,a,null,d,null));var e=c.count,f;for(f=0;f<e;f++)if(c.O(f)===b){c.Lb(f,a);break}null!==this.ac&&this.cb(qf,"layers",this,null,a,null,f);this.S();0>d&&this.Ya()};
t.ky=function(a,b){ak(this,a,b);a.ib(this);var c=this.Ra,d=c.indexOf(a);0<=d&&(c.remove(a),null!==this.ac&&this.cb(rf,"layers",this,a,null,d,null));var e=c.count,f;for(f=0;f<e;f++)if(c.O(f)===b){c.Lb(f+1,a);break}null!==this.ac&&this.cb(qf,"layers",this,null,a,null,f+1);this.S();0>d&&this.Ya()};
t.Sz=function(a){w(a,ri,P,"removeLayer:layer");a.diagram!==this&&v("Cannot remove a Layer from another Diagram: "+a+" of "+a.diagram);if(""!==a.name){var b=this.Ra,c=b.indexOf(a);if(b.remove(a)){for(b=a.Ga.copy().iterator;b.next();){var d=b.value,e=d.layerName;e!==a.name?d.layerName=e:d.layerName=""}null!==this.ac&&this.cb(rf,"layers",this,a,null,c,null);this.S();this.Ya()}}};t.cm=function(a){for(var b=this.layers;b.next();){var c=b.value;if(c.name===a)return c}return null};
t.Yw=function(a){z(a,"function",P,"addModelChangedListener:listener");null===this.pe&&(this.pe=new G);this.pe.add(a);this.model.rh(a)};t.Uz=function(a){z(a,"function",P,"removeModelChangedListener:listener");null!==this.pe&&(this.pe.remove(a),0===this.pe.count&&(this.pe=null));this.model.qk(a)};t.rh=function(a){z(a,"function",P,"addChangedListener:listener");null===this.Cf&&(this.Cf=new G);this.Cf.add(a)};
t.qk=function(a){z(a,"function",P,"removeChangedListener:listener");null!==this.Cf&&(this.Cf.remove(a),0===this.Cf.count&&(this.Cf=null))};t.Ms=function(a){this.skipsUndoManager||this.undoManager.kv(a);a.change!==pf&&(this.isModified=!0);if(null!==this.Cf)for(var b=this.Cf,c=b.length,d=0;d<c;d++)b.O(d)(a)};t.cb=function(a,b,c,d,e,f,g){void 0===f&&(f=null);void 0===g&&(g=null);var h=new nf;h.diagram=this;h.change=a;h.propertyName=b;h.object=c;h.oldValue=d;h.oldParam=f;h.newValue=e;h.newParam=g;this.Ms(h)};
t.g=function(a,b,c,d,e){this.cb(of,a,this,b,c,d,e)};
t.Sj=function(a,b){if(null!==a&&a.diagram===this){var c=this.skipsModelSourceBindings;try{this.skipsModelSourceBindings=!0;var d=a.change;if(d===of){var e=a.object;bk(e,a.propertyName,a.K(b));if(e instanceof N){var f=e.part;null!==f&&f.Mb()}this.isModified=!0}else if(d===qf){var g=a.object,h=a.newParam,k=a.newValue;if(g instanceof W)if("number"===typeof h&&k instanceof N){b?g.zc(h):g.Lb(h,k);var l=g.part;null!==l&&l.Mb()}else{if("number"===typeof h&&k instanceof ck)if(b)k.isRow?g.Ev(h):g.Cv(h);else{var m=
k.isRow?g.getRowDefinition(k.index):g.getColumnDefinition(k.index);m.Zl(k)}}else if(g instanceof ri){var n=!0===a.oldParam;"number"===typeof h&&k instanceof R&&(b?(k.isSelected=!1,k.isHighlighted=!1,k.Mb(),g.zc(n?h:-1,k,n)):g.Pi(h,k,n))}else g instanceof P?"number"===typeof h&&k instanceof ri&&(b?this.Ra.nb(h):(k.ib(this),this.Ra.Lb(h,k))):v("unknown ChangedEvent.Insert object: "+a.toString());this.isModified=!0}else if(d===rf){var p=a.object,q=a.o